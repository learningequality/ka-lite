{% extends "control_panel/base.html" %}
{% load i18n %}

{% block title %}{{ device.name }}{% trans "Device Syncing History" %}{% endblock title %}

{% block buttons %}{{ block.super }}
    {% if not is_central %}
        <!--li>
            <a class="green_button" href="javascript:alert('NYI; sorry!');">{% trans "Sync device now!" %}</a>
        </li-->
    {% endif %}
{% endblock buttons %}

{% block control_panel_content %}
<div id="zone_container">

    {% if is_central %}
    <div class="device_metadata">
        <h2>{% trans "Device Metadata" %}</h2>

        <ul>
        {% if not shown_sessions %}
            <li><b>{% trans "Version" %}:</b> {{ device.version }}</li>
        {% else %}
            <li><b>{% trans "Version" %}:</b> {{ shown_sessions.0.client_version }}</li>
            <li><b>{% trans "OS" %}:</b>  {{ shown_sessions.0.client_os }}</li>
        {% endif %}
        </ul>
    </div>
    {% endif %}

    <div class="sync_sessions">
        <div>
            <h2>{% trans "Sync Sessions" %}</h2>
        </div>

        {% if not shown_sessions %}
            <p>{% trans "This device has never synced with the central server" %}</p>
        {% else %}
            {% with shown_sessions|length as shown_count %}
            <span>{% blocktrans %}(showing {{ shown_count }} of {{ total_sessions }}){% endblocktrans %}</span>
            {% endwith %}
            <table class="simple-table">
                <tr>
                    <th width="250px">{% trans "Sync date" %}</th>
                    <th width="250px">{% trans "Sync address" %}</th>
                    <th width="200px">{% trans "# models uploaded" %}</th>
                    <th width="200px">{% trans "# models downloaded" %}</th>
                    <th width="200px">{% trans "# errors" %}</th>
                </tr>
                {% for sync_session in shown_sessions %}
                    <tr>
                        <td>{{ sync_session.timestamp }}</td>
                        <td>{{ sync_session.ip }}</td>
                        <td>{{ sync_session.models_uploaded }}</td>
                        <td>{{ sync_session.models_downloaded }}</td>
                        <td>{{ sync_session.errors }}</td>
                    </tr>
                {% endfor %}
            </table>
        {% endif %}
    </div>

</div><!-- zone_container -->
{% endblock control_panel_content %}
