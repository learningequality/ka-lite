(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
$.extend(KhanUtil,{commonAngles:[{deg:15,rad:"\\frac{\\pi}{12}"},{deg:30,rad:"\\frac{\\pi}{6}"},{deg:45,rad:"\\frac{\\pi}{4}"},{deg:60,rad:"\\frac{\\pi}{3}"},{deg:90,rad:"\\frac{\\pi}{2}"},{deg:120,rad:"\\frac{2\\pi}{3}"},{deg:135,rad:"\\frac{3\\pi}{4}"},{deg:150,rad:"\\frac{5\\pi}{6}"},{deg:180,rad:"\\pi"},{deg:210,rad:"\\frac{7\\pi}{6}"},{deg:225,rad:"\\frac{5\\pi}{4}"},{deg:240,rad:"\\frac{4\\pi}{3}"},{deg:270,rad:"\\frac{3\\pi}{2}"},{deg:300,rad:"\\frac{5\\pi}{3}"},{deg:315,rad:"\\frac{7\\pi}{4}"},{deg:330,rad:"\\frac{11\\pi}{6}"},{deg:360,rad:"2\\pi"}],toRadians:function(a){return a*Math.PI/180},toDegrees:function(a){return 180*a/Math.PI}});
},{}],2:[function(require,module,exports){
require("./angles.js"),require("./interactive.js"),require("./graphie-helpers.js"),$.extend(KhanUtil,{addCongruency:function(t){var e=$.extend(!0,{x1:0,x2:10,y1:0,y2:3},t);if(e.x1>e.x2){var n=e.x1;e.x1=e.x2,e.x2=n}if(e.y1>e.y2){var n=e.y1;e.y1=e.y2,e.y2=n}var i=KhanUtil.currentGraph;return e.lines={},e.angles={},e.points={},e.getPoint=function(t){return"string"==typeof t?e.points[t]:t},e.addPoint=function(t,n){var i={name:t,pos:n,connected:[],arcs:[]};return i.angleTo=function(t){return t=e.getPoint(t),Math.atan2(t.pos[1]-i.pos[1],t.pos[0]-i.pos[0])},e.points[t]=i,i},e.addLine=function(t){var n=$.extend(!0,{start:[0,0],extend:!1,clickable:!1,state:0,maxState:1,tickDiff:.15,tickLength:.2,highlighted:!1},t);if("string"==typeof n.start&&(n.startPt=e.points[n.start],n.start=n.startPt.pos),"string"==typeof n.end&&(n.endPt=e.points[n.end],n.end=n.endPt.pos),null!=n.end?(n.radAngle=Math.atan2(n.end[1]-n.start[1],n.end[0]-n.start[0]),n.angle=KhanUtil.toDegrees(n.radAngle)):null!=n.angle&&(n.radAngle=KhanUtil.toRadians(n.angle),n.end=[Math.cos(n.radAngle)+n.start[0],Math.sin(n.radAngle)+n.start[1]]),n.slope=(n.end[1]-n.start[1])/(n.end[0]-n.start[0]),n.slope=Math.max(-999999,Math.min(999999,n.slope)),n.func=function(t){return n.start[1]+n.slope*(t-n.start[0])},n.invfunc=function(t){var e=0===n.slope?1e-5:n.slope;return n.start[0]+(t-n.start[1])/e},n.extend){var s,a,r=n.start[0]<n.end[0],h=n.func(e.x1);s=h>=e.y1&&h<=e.y2?[e.x1,h]:h>e.y2?[n.invfunc(e.y2),e.y2]:[n.invfunc(e.y1),e.y1];var o=n.func(e.x2);a=o>=e.y1&&o<=e.y2?[e.x2,o]:o>e.y2?[n.invfunc(e.y2),e.y2]:[n.invfunc(e.y1),e.y1],r?(n.start=s,n.end=a):(n.end=s,n.start=a)}null!=n.placeAtStart&&(n.startPt=e.addPoint(n.placeAtStart,n.start)),null!=n.placeAtEnd&&(n.endPt=e.addPoint(n.placeAtEnd,n.end)),null!=n.startPt&&null!=n.endPt&&(e.lines[n.startPt.name+n.endPt.name]=n,e.lines[n.endPt.name+n.startPt.name]=n),null!=n.startPt&&null!=n.endPt&&(n.startPt.connected.push(n.endPt),n.endPt.connected.push(n.startPt)),n.draw=function(){null!=this.line&&this.line.remove(),this.line=i.raphael.set();for(var t=this.tickDiff*(this.state-1)/2,e=[Math.cos(this.radAngle),Math.sin(this.radAngle)],n=[-e[1]*this.tickLength,e[0]*this.tickLength],s=[(this.start[0]+this.end[0])/2,(this.start[1]+this.end[1])/2],a=[s[0]-t*e[0],s[1]-t*e[1]],r=0;r<this.state;r+=1){var h=[a[0]+r*e[0]*this.tickDiff,a[1]+r*e[1]*this.tickDiff],o=[h[0]+n[0],h[1]+n[1]],l=[h[0]-n[0],h[1]-n[1]];this.line.push(i.line(o,l))}this.line.push(i.line(this.start,this.end)),0===e[1]&&ParallelLineMarkers(this.end[0]-.5,this.end[1]),this.line.attr(this.point.normalStyle),this.point.visibleShape=this.line};var l=[(n.start[0]+n.end[0])/2,(n.start[1]+n.end[1])/2];return n.point=i.addMovablePoint({coord:l}),n.point.onMove=function(t,e){return!1},n.point.mouseTarget.attr({r:.7*i.scale[0]}),n.point.visibleShape.remove(),n.normal={stroke:"black","stroke-width":2},n.hover={stroke:"black","stroke-width":3},n.highlight={},n.setStyles=function(){this.highlighted?(this.point.normalStyle=this.highlight,this.point.highlightStyle=this.highlight):(this.point.normalStyle=this.normal,this.point.highlightStyle=this.hover)},n.setSelectedStyle=function(t){$.extend(!0,this.hover,t),this.draw()},n.setUnselectedStyle=function(t){$.extend(!0,this.normal,t),this.draw()},n.setHighlighted=function(t){$.extend(!0,this.highlight,t),this.highlighted=!0,this.setStyles(),this.draw()},n.unsetHighlighted=function(){this.highlighted=!1,this.setStyles(),this.draw()},n.setStyles(),n.draw(),n.setState=function(t){this.state=t,this.draw()},$(n.point.mouseTarget.getMouseTarget()).bind("vmouseup",function(t){n.setState(n.state===n.maxState?0:n.state+1)}),n.stick=function(){n.point.mouseTarget.remove()},n.clickable||n.stick(),n},e.addAngle=function(t,n){var s=$.extend({radius:.7,state:0,maxState:1,shown:!1,clickable:!0,arcDiff:.15,highlighted:!1},n);for(s.center=t[1],s.left=t[0],s.right=t[2],s.centerPt=e.getPoint(s.center),s.leftPt=e.getPoint(s.left),s.rightPt=e.getPoint(s.right),s.pos=s.centerPt.pos,s.start=KhanUtil.toDegrees(s.centerPt.angleTo(s.leftPt)),s.end=KhanUtil.toDegrees(s.centerPt.angleTo(s.rightPt));s.start>s.end;)s.start-=360;s.angle=s.end-s.start;var a=KhanUtil.toRadians((s.start+s.end)/2),r=s.pos.slice();r[0]+=Math.cos(a)*s.radius,r[1]+=Math.sin(a)*s.radius,s.point=i.addMovablePoint({coord:r}),s.point.onMove=function(t,e){return!1},$(s.point.mouseTarget.getMouseTarget()).css("cursor","pointer");var h=Math.sin(KhanUtil.toRadians(s.angle)/2)*s.radius*i.scale[0];s.point.mouseTarget.attr({r:h}),s.point.visibleShape.remove(),s.unselected={stroke:KhanUtil.GRAY,"stroke-width":2,opacity:.1},s.unselectedHover={stroke:KhanUtil.GRAY,"stroke-width":2,opacity:.4},s.selected={stroke:KhanUtil.BLUE,"stroke-width":3,opacity:.9},s.selectedHover={stroke:KhanUtil.BLUE,"stroke-width":3,opacity:1},s.highlight={},s.draw=function(){null!=this.arc&&this.arc.remove();var t=0===this.state?1:this.state,e=this.radius-this.arcDiff*(t-1)/2;this.arc=i.raphael.set();for(var n=0;t>n;n+=1){var s=e+this.arcDiff*n;this.arc.push(i.arc(this.pos,s,this.start,this.end))}this.point.visibleShape=this.arc,this.arc.attr(this.point.normalStyle)},s.setStyles=function(){this.highlighted?(this.point.normalStyle=this.highlight,this.point.highlightStyle=this.highlight):0===this.state?(this.point.normalStyle=this.unselected,this.point.highlightStyle=this.unselectedHover):(this.point.normalStyle=this.selected,this.point.highlightStyle=this.selectedHover)},s.setState=function(t){this.state=t,this.setStyles(),this.draw()},s.setStyles(),s.draw(),$(s.point.mouseTarget.getMouseTarget()).bind("vmouseup",function(t){s.setState(s.state===s.maxState?0:s.state+1)}),s.stick=function(){$(this.point.mouseTarget.getMouseTarget()).unbind(),this.point.mouseTarget.remove()},s.clickable||s.stick(),s.setUnselectedStyle=function(t){$.extend(!0,this.unselected,t),$.extend(!0,this.unselectedHover,t),this.draw()},s.setSelectedStyle=function(t){$.extend(!0,this.selected,t),$.extend(!0,this.selectedHover,t),this.draw()},s.setHighlighted=function(t){$.extend(!0,this.highlight,t),this.highlighted=!0,this.setStyles(),this.draw()},s.unsetHighlighted=function(){this.highlighted=!1,this.setStyles(),this.draw()};var t=s.left+s.center+s.right;return e.angles[t]=s,t=s.right+s.center+s.left,e.angles[t]=s,s},e.addAngles=function(t,n){for(var i=e.getPoint(t),s=_.sortBy(i.connected,function(t){return i.angleTo(t)}),a=s.length,r=0;a>r;r+=1){var h=s[r],o=s[(r+1)%a],l=i.angleTo(h),d=i.angleTo(o);r+1===a&&(d+=2*Math.PI),d-l>=Math.PI||e.addAngle(h.name+i.name+o.name,n)}},e.intersect=function(t,n,i,s){if(t.slope===n.slope)return!1;var a=null,r=[];r[0]=(t.slope*t.start[0]-n.slope*n.start[0]+n.start[1]-t.start[1])/(t.slope-n.slope),r[1]=t.func(r[0]),a=e.addPoint(i,r),a.connected.push(t.startPt),a.connected.push(t.endPt),a.connected.push(n.startPt),a.connected.push(n.endPt),s&&e.addAngles(a.name)},e.addLabel=function(t,n){var s=e.getPoint(t);i.label(s.pos,t,n)},e.getGuess=function(){var t={};return _.each(e.lines,function(e,n){t[n]=e.state}),_.each(e.angles,function(e,n){t[n]=e.state}),t},e.showGuess=function(t){_.each(t,function(t,n){2===n.length?e.lines[n].setState(t):e.angles[n].setState(t)})},e}});
},{"./angles.js":1,"./graphie-helpers.js":5,"./interactive.js":7}],3:[function(require,module,exports){
var table="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D",crc32=function(B,D){null==D&&(D=0);var A=0,C=0;D=-1^D;for(var E=0,F=B.length;F>E;E++)A=255&(D^B.charCodeAt(E)),C="0x"+table.substr(9*A,8),D=D>>>8^C;return Math.abs(-1^D)};module.exports=crc32;
},{}],4:[function(require,module,exports){
$.extend(KhanUtil,{expr:function(e,r){if("object"==typeof e){var t=e[0],n=e.slice(1),a=r?KhanUtil.computeOperators:KhanUtil.formatOperators;return a[t].apply(this,n)}return r?e:e.toString()},exprType:function(e){return"object"==typeof e?"color"===e[0]?KhanUtil.exprType(e[2]):e[0]:typeof e},exprIsNegated:function(e){switch(KhanUtil.exprType(e)){case"color":return KhanUtil.exprIsNegated(e[2]);case"/":return KhanUtil.exprIsNegated(e[1]);case"+":case"-":return!0;case"number":return 0>e;case"string":return"-"===e.charAt(0);default:return!1}},exprIsShort:function(e){switch(KhanUtil.exprType(e)){case"color":return KhanUtil.exprIsShort(e[2]);case"+":case"-":case"*":case"/":case"frac":return!1;case"^":return"number"!==KhanUtil.exprType(e[1])||e[1]<0;case"number":case"sqrt":return!0;default:return e.length<=1}},exprParenthesize:function(e){return KhanUtil.exprIsShort(e)?KhanUtil.expr(e):"("+KhanUtil.expr(e)+")"},formatOperators:{color:function(e,r){return"\\color{"+e+"}{"+KhanUtil.expr(r)+"}"},"+":function(){var e=[].slice.call(arguments,0),r=$.grep(e,function(e,r){return null!=e});r=_.filter(r,function(e){return""+KhanUtil.expr(e)!="0"}),r=$.map(r,function(e,r){var t;switch(KhanUtil.exprType(e)){case"+":t=!0;break;case"-":t=e.length>2;break;default:t=!1}return e=KhanUtil.expr(e),t&&(e="("+e+")"),("-"!==e.charAt(0)||t)&&(e="+"+e),e});var t=r.join("");return"+"===t.charAt(0)?t.slice(1):t},"-":function(){if(1===arguments.length)return KhanUtil.expr(["*",-1,arguments[0]]);var e=[].slice.call(arguments,0),r=$.map(e,function(e,r){var t,n=KhanUtil.exprIsNegated(e);switch(KhanUtil.exprType(e)){case"+":case"-":t=!0;break;default:t=!1}return e=KhanUtil.expr(e),(n&&r>0||t)&&(e="("+e+")"),e}),t=r.join("-");return t},"*":function(){var e=Array.prototype.slice.call(arguments,1);if(e.unshift("*"),0===arguments[0])return 0;if(1===arguments[0]&&e.length>1)return KhanUtil.expr(e);if(-1===arguments[0]&&e.length>1){var r=KhanUtil.expr(e);return KhanUtil.exprIsNegated(e[1])?"-("+r+")":"-"+r}if(arguments.length>1){var t=[].slice.call(arguments,0),n="number"===KhanUtil.exprType(arguments[0])&&"number"===KhanUtil.exprType(arguments[1]),a=$.map(t,function(e,r){var t;switch(KhanUtil.exprType(e)){case"number":r>0&&(t=!0);break;default:t=!KhanUtil.exprIsShort(e)}return n=n||t,e=KhanUtil.expr(e),n&&(e="("+e+")"),e});return a.join("")}return KhanUtil.expr(arguments[0])},times:function(e,r){var t=!KhanUtil.exprIsShort(e),n=!KhanUtil.exprIsShort(r);return e=KhanUtil.expr(e),r=KhanUtil.expr(r),e=t?"("+e+")":e,r=n?"("+r+")":r,e+" \\times "+r},dot:function(e,r){var t=!KhanUtil.exprIsShort(e),n=!KhanUtil.exprIsShort(r);return e=KhanUtil.expr(e),r=KhanUtil.expr(r),e=t?"("+e+")":e,r=n?"("+r+")":r,e+" \\cdot "+r},"/":function(e,r){var t=!KhanUtil.exprIsShort(e),n=!KhanUtil.exprIsShort(r);return e=KhanUtil.expr(e),r=KhanUtil.expr(r),e=t?"("+e+")":e,r=n?"("+r+")":r,e+"/"+r},frac:function(e,r){return"\\dfrac{"+KhanUtil.expr(e)+"}{"+KhanUtil.expr(r)+"}"},"^":function(e,r){if(0===r)return"";if(1===r)return KhanUtil.expr(e);var t,n;switch(KhanUtil.exprType(e)){case"+":case"-":case"*":case"/":case"^":case"ln":t=!0;break;case"number":t=0>e;break;case"sin":case"cos":case"tan":case"csc":case"sec":case"cot":t=!1,n=!0;break;default:t=!1,n=!1}return e=KhanUtil.expr(e),t&&(e="("+e+")"),r=KhanUtil.expr(r),n?e.replace(/\\(\S+?)\{/,function(e,t){return"\\"+t+"^{"+r+"} {"}):e+"^{"+r+"}"},sqrt:function(e){return"\\sqrt{"+KhanUtil.exprParenthesize(e)+"}"},sin:function(e){return"\\sin{"+KhanUtil.exprParenthesize(e)+"}"},cos:function(e){return"\\cos{"+KhanUtil.exprParenthesize(e)+"}"},tan:function(e){return"\\tan{"+KhanUtil.exprParenthesize(e)+"}"},sec:function(e){return"\\sec{"+KhanUtil.exprParenthesize(e)+"}"},csc:function(e){return"\\sec{"+KhanUtil.exprParenthesize(e)+"}"},cot:function(e){return"\\sec{"+KhanUtil.exprParenthesize(e)+"}"},ln:function(e){return"\\ln{"+KhanUtil.exprParenthesize(e)+"}"},"+-":function(){if(1===arguments.length)return"\\pm "+KhanUtil.exprParenthesize(arguments[0]);var e=[].slice.call(arguments,0);return $.map(e,function(e,r){return KhanUtil.expr(e)}).join(" \\pm ")}},computeOperators:{color:function(e,r){return KhanUtil.expr(r,!0)},"+":function(){var e=[].slice.call(arguments,0),r=0;return $.each(e,function(e,t){r+=KhanUtil.expr(t,!0)}),r},"-":function(){if(1===arguments.length)return-KhanUtil.expr(arguments[0],!0);var e=[].slice.call(arguments,0),r=0;return $.each(e,function(e,t){r+=(0===e?1:-1)*KhanUtil.expr(t,!0)}),r},"*":function(){var e=[].slice.call(arguments,0),r=1;return $.each(e,function(e,t){r*=KhanUtil.expr(t,!0)}),r},"/":function(){var e=[].slice.call(arguments,0),r=1;return $.each(e,function(e,t){var n=KhanUtil.expr(t,!0);r*=0===e?n:1/n}),r},"^":function(e,r){return Math.pow(KhanUtil.expr(e,!0),KhanUtil.expr(r,!0))},sqrt:function(e){return Math.sqrt(KhanUtil.expr(e,!0))},"+-":function(){return NaN}},exprStripColor:function(e){return"object"!=typeof e?e:"color"===e[0]?KhanUtil.exprStripColor(e[2]):$.map(e,function(e,r){return[0===r?e:KhanUtil.exprStripColor(e)]})},exprSimplifyAssociative:function(e){if("object"!=typeof e)return e;var r=$.map(e.slice(1),function(e){return[KhanUtil.exprSimplifyAssociative(e)]}),t=function(r){switch(e[0]){case"+":if("+"===r[0])return r.slice(1);break;case"*":if("*"===r[0])return r.slice(1)}return[r]},n=$.map(r,t);return n.unshift(e[0]),n}}),KhanUtil.computeOperators.frac=KhanUtil.computeOperators["/"];
},{}],5:[function(require,module,exports){
require("./math-format.js"),window.numberLine=function(t,r,e,a,n,i){e=e||1,a=a||0,n=n||0;var o=(e+"").length-(e+"").indexOf(".")-1;(e+"").indexOf(".")<0&&(o=0);var l=KhanUtil.currentGraph,h=l.raphael.set();h.push(l.line([a,n],[a+r-t,n])),h.labels=[];for(var c=0;r-t>=c;c+=e)if(h.push(l.line([a+c,n-.2],[a+c,n+.2])),i){var s=KhanUtil.roundTowardsZero(t+c+.001),u=t+c-s,d=s;Math.abs(Math.round(u*i))!==i&&0!==Math.round(u*i)&&(d=0===s?KhanUtil.fraction(Math.round(u*i),i,!1,!1,!0):s+"\\frac{"+Math.abs(Math.round(u*i))+"}{"+i+"}");var f=l.label([a+c,n-.2],"\\small{"+d+"}","below",{labelDistance:3});h.labels.push(f),h.push(f)}else{var f=l.label([a+c,n-.2],"\\small{"+KhanUtil.localeToFixed(t+c,o)+"}","below",{labelDistance:3});h.labels.push(f),h.push(f)}return h},window.piechart=function(t,r,e,a,n,i){var o=KhanUtil.currentGraph,l=o.raphael.set(),h=a||"none",c=a||"#fff";n=n||0,i=i||0;var s=0;$.each(t,function(t,r){s+=r});var u=0;$.each(t,function(t,a){a===s?l.push(o.ellipse([n,i],[e,e],{stroke:h,fill:r[t]})):l.push(o.arc([n,i],e,360*u/s,360*(u+a)/s,!0,{stroke:h,fill:r[t]})),u+=a});for(var d=0;s>d;d++){var f=o.polar(e,360*d/s);l.push(o.line([n,i],[n+f[0],i+f[1]],{stroke:c}))}return l},window.shadeRect=function(t,r,e,a,n){for(var i=KhanUtil.currentGraph,o=i.raphael.set(),l=i.range[0][0],h=i.range[1][0],c=i.range[1][1],s=l-(c-h)*i.scale[1]/i.scale[0],u=8/i.scale[0],d=(n||0)/i.scale[0],f=(n||0)/i.scale[1];s<i.range[0][1];)o.push(i.line([s,h],[l,c],{clipRect:[[t+d,r+f],[e-2*d,a-2*f]]})),s+=u,l+=u;return o},window.rectchart=function(t,r,e,a,n){var i=KhanUtil.currentGraph,o=i.raphael.set();e=e||0;var l=0;$.each(t,function(t,r){l+=r});var h=i.unscaleVector([1,1]),c=0;return $.each(t,function(t,s){for(var u=r[t],d=a&&a[t]||u,f=0;s>f;f++){var p=c/l,g=1/l;o.push(i.path([[p+2*h[0],e+2*h[1]],[p+g-2*h[0],e+2*h[1]],[p+g-2*h[0],e+1-2*h[1]],[p+2*h[0],e+1-2*h[1]],!0],{stroke:d,fill:u})),n&&n[t]&&i.style({stroke:"#000",strokeWidth:2,strokeOpacity:.5,fillOpacity:0,fill:null},function(){o.push(shadeRect(p+2*h[0],e+2*h[1],g-4*h[0],1-4*h[1],a&&a[t]?1:-1))}),c+=1}}),o},window.Parabola=function(t,r,e){var a=t,n=r,i=e,o=[];this.graphieFunction=function(t){return a*(t-n)*(t-n)+i},this.plot=function(t){var r=KhanUtil.currentGraph;if(o.push(r.plot(this.graphieFunction,[-10,10])),t){var e=this.getFocusX(),a=this.getFocusY(),n=this.getDirectrixK();r.style({fill:"#6495ED"},function(){o.push(r.circle([e,a],.1)),o.push(r.line([-10,n],[10,n]))})}},this.redraw=function(t){$.each(o,function(t,r){r.remove()}),o=[],this.plot(t)},this.update=function(t,r,e){a=t,n=r,i=e},this.delta=function(t,r,e){this.update(a+t,n+r,i+e)},this.deltaFocusDirectrix=function(t,r,e){var a=this.getFocusY()+r,n=this.getDirectrixK()+e;a===n&&(a+=r,n+=e);var i=(a+n)/2,o=1/(2*(a-n));this.update(o,this.getVertexX()+t,i)},this.getVertexX=function(){return n},this.getVertexY=function(){return i},this.getLeadingCoefficient=function(){return a},this.getFocusX=function(){return n},this.getFocusY=function(){return i+1/(4*a)},this.getDirectrixK=function(){return i-1/(4*a)}},window.redrawParabola=function(t){var r=KhanUtil.currentGraph,e=r.graph,a=e.currParabola;a.redraw(t);var n=a.getLeadingCoefficient(),i=a.getVertexX(),o=a.getVertexY();if(t)$("#focus-x-label").html("<code>"+a.getFocusX()+"</code>").runModules(),$("#focus-y-label").html("<code>"+KhanUtil.localeToFixed(a.getFocusY(),2)+"</code>").runModules(),$("#directrix-label").html("<code>y = "+KhanUtil.localeToFixed(a.getDirectrixK(),2)+"</code>").runModules();else{var l="y - "+o+"="+n+"(x - "+i+")^{2}";l=KhanUtil.cleanMath(l),$("#equation-label").html("<code>"+l+"</code>").runModules()}$("#leading-coefficient input").val(n),$("#vertex-x input").val(i),$("#vertex-y input").val(o)},window.updateParabola=function(t,r,e,a){KhanUtil.currentGraph.graph.currParabola.delta(t,r,e),redrawParabola(a)},window.updateFocusDirectrix=function(t,r,e){KhanUtil.currentGraph.graph.currParabola.deltaFocusDirectrix(t,r,e),redrawParabola(!0)},window.ParallelLineMarkers=function(t,r,e){var a=KhanUtil.currentGraph;e=e||0;var n=8/a.scaleVector([1,1])[0],i=t+.75*n*Math.cos(e),o=r+.75*n*Math.sin(e),l=n*Math.cos(e+Math.PI/4),h=n*Math.sin(e+Math.PI/4),c=n*Math.cos(e-Math.PI/4),s=n*Math.sin(e-Math.PI/4);a.path([[t-l,r-h],[t,r],[t-c,r-s]]),a.path([[i-l,o-h],[i,o],[i-c,o-s]])},window.ParallelLines=function(t,r,e,a,n){function i(t,r,e,a,n){var i=KhanUtil.currentGraph,o=e[1]-e[0],l=KhanUtil.toRadians(e[0]+o/2),h=.7;70>o&&(h/=Math.cos(KhanUtil.toRadians(70-o)));var c=h*Math.cos(l),s=h*Math.sin(l),u="center";"boolean"==typeof n&&(n=e[1]-e[0]+"^\\circ"),n.length>10&&Math.abs(c)>.25&&(c*=.6,s*=.8,u=c>0?"right":"left"),f[t]&&f[t].remove(),f[t]=i.label([r[0]+c,r[1]+s],n,u,{color:a})}var o,l,h,c=a/2*Math.cos(n+Math.PI/2),s=a/2*Math.sin(n+Math.PI/2),u=e/2*Math.cos(n),d=e/2*Math.sin(n),f={};this.draw=function(){var e=KhanUtil.currentGraph;e.line([t+c+u,r+s+d],[t+c-u,r+s-d]),e.line([t-c+u,r-s+d],[t-c-u,r-s-d])},this.drawMarkers=function(e){var a=KhanUtil.currentGraph,i=0,o=0,l=120/a.scaleVector([1,1])[0];"right"===e||e>=40&&140>=e?(i+=l*Math.cos(n),o+=l*Math.sin(n)):"left"===e&&(i-=l*Math.cos(n),o-=l*Math.sin(n)),ParallelLineMarkers(t+c+i,r+s+o,n),ParallelLineMarkers(t-c+i,r-s+o,n)},this.drawTransverse=function(i){var c=KhanUtil.currentGraph,s=KhanUtil.toRadians(i),u=Math.cos(n+s),d=Math.sin(n+s),f=.5*e*u,p=.5*e*d;c.line([t+f,r+p],[t-f,r-p]);var g=.5*a/Math.cos(Math.PI/2-s),v=g*u,w=g*d;l=[t+v,r+w],o=[t-v,r-w],h=i},this.drawAngle=function(t,r,e){var a=KhanUtil.currentGraph,c=.4;e=e||KhanUtil.BLUE,t=(t+8)%8;var s=4>t?[o,c]:[l,c],u=[KhanUtil.toDegrees(n),KhanUtil.toDegrees(n)];switch(t%4){case 0:u[1]+=h;break;case 1:u[0]+=h,u[1]+=180;break;case 2:u[0]+=180,u[1]+=180+h;break;case 3:u[0]+=180+h,u[1]+=360}$.merge(s,u),a.style({stroke:e},function(){f[t]||a.arc.apply(a,s),r&&i(t,s[0],u,e,r)})},this.drawVerticalAngle=function(t,r,e){t=(t+8)%8;var a=(t+2)%4;t>=4&&(a+=4),this.drawAngle(a,r,e)},this.drawAdjacentAngles=function(t,r,e){t=(t+8)%8;var a=(t+1)%4,n=(t+3)%4;t>=4&&(a+=4,n+=4),this.drawAngle(a,r,e),this.drawAngle(n,r,e)}},window.drawComplexChart=function(t,r){var e=KhanUtil.currentGraph,a=t*Math.sqrt(2),n="#ddd";e.style({strokeWidth:1});for(var i=1;a>=i;i++)e.circle([0,0],i,{fill:"none",stroke:n});for(var i=0;r>i;i++){var o=2*i*Math.PI/r;r%4===0&&i%(r/4)!==0&&e.line([0,0],[Math.sin(o)*a,Math.cos(o)*a],{stroke:n})}e.label([t,.5],"Re","left"),e.label([.5,t-1],"Im","right")},window.ComplexPolarForm=function(t,r,e){var a,n=t,i=r,o=0,l=1,h=e;this.update=function(t,r){for(o=t;0>o;)o+=n;o%=n,l=Math.max(1,Math.min(r,i)),this.redraw()},this.delta=function(t,r){this.update(o+t,l+r)},this.getAngleNumerator=function(){return o},this.getAngleDenominator=function(){return n},this.getAngle=function(){return 2*o*Math.PI/n},this.getRadius=function(){return l},this.getRealPart=function(){return Math.cos(this.getAngle())*l},this.getImaginaryPart=function(){return Math.sin(this.getAngle())*l},this.getUseEulerForm=function(){return h},this.plot=function(){a=KhanUtil.currentGraph.circle([this.getRealPart(),this.getImaginaryPart()],.25,{fill:KhanUtil.ORANGE,stroke:"none"})},this.redraw=function(){a&&a.remove(),this.plot()}},window.updateComplexPolarForm=function(t,r){KhanUtil.currentGraph.graph.currComplexPolar.delta(t,r),redrawComplexPolarForm()},window.redrawComplexPolarForm=function(t,r){var e=KhanUtil.currentGraph,a=e.graph,n=a.currComplexPolar;n.redraw(),"undefined"==typeof r&&(r=n.getRadius()),"undefined"==typeof t&&(t=n.getAngleNumerator()),t*=2*Math.PI/n.getAngleDenominator();var i=KhanUtil.polarForm(r,t,n.getUseEulerForm());$("#number-label").html("<code>"+i+"</code>").runModules(),$("#current-radius").html("<code>"+r+"</code>").runModules(),$("#current-angle").html("<code>"+KhanUtil.piFraction(t,!0)+"</code>").runModules()},window.labelDirection=function(t){return t%=360,0===t?"right":t>0&&90>t?"above right":90===t?"above":t>90&&180>t?"above left":180===t?"left":t>180&&270>t?"below left":270===t?"below":t>270&&360>t?"below right":void 0},window.curvyArrow=function(t,r,e,a,n){n=n||{};var i,o=KhanUtil.currentGraph,l=o.raphael.set();"left"===e?i=[90,270]:"right"===e?i=[270,90]:"top"===e?i=[0,180]:"bottom"===e&&(i=[180,0]),i.push(n);var h=[t,r].concat(i);l.push(o.arc.apply(o,h));var c=o.unscaleVector([1,1]),s=_.clone(t),u=_.clone(t);if("left"===e||"right"===e){var d="left"===e;s[1]=u[1]=u[1]+r*(a===d?1:-1),u[0]=s[0]+c[0]*(d?1:-1)}else{var f="bottom"===e;s[0]=u[0]=u[0]+r*(a===f?1:-1),u[1]=s[1]+c[1]*(f?1:-1)}return l.push(o.line(s,u,_.extend({arrows:"->"},n))),l},window.curlyBrace=function(t,r){var e=KhanUtil.currentGraph,a=e.scalePoint(t),n=e.scalePoint(r),i=KhanUtil.findAngle(n,a),o=KhanUtil.getDistance(n,a),l=_.map(a,function(t,r){return(t+n[r])/2}),h=58;if(h>o)throw new Error("Curly brace length is too short.");var c=(o-h)/2,s=o/2,u="c 1 -3 6 -5 10 -6c 0 0 3 -1 6 -1",d="c 3 1 6 1 6 1c 4 1 9 3 10 6",f="l "+c+" 0",p="c 5 0 10 -3 10 -3l 3 -4",g="l 3 4c 0 0 5 3 10 3",v=["M -"+s+" 0",u,f,p,g,f,d].join(""),w=e.raphael.path(v);return w.rotate(i),w.translate(l[0],l[1]),w};
},{"./math-format.js":12}],6:[function(require,module,exports){
function cartToPolar(t,r){var e=Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)),a=Math.atan2(t[1],t[0]);return 0>a&&(a+=2*Math.PI),r||(a=180*a/Math.PI),[e,a]}function polar(t,r){return"number"==typeof t&&(t=[t,t]),r=r*Math.PI/180,[t[0]*Math.cos(r),t[1]*Math.sin(r)]}function cleanupIntervals(){_.each(intervalIDs,function(t){window.clearInterval(t)}),intervalIDs.length=0}var kpoint=require("./kpoint.js"),kvector=require("./kvector.js");require("./tex.js"),require("./tmpl.js");var Graphie=KhanUtil.Graphie=function(){},intervalIDs=[];$.extend(KhanUtil,{unscaledSvgPath:function(t){return t[0]===!0?"":$.map(t,function(t,r){return t===!0?"z":(0===r?"M":"L")+t[0]+" "+t[1]}).join("")},getDistance:function(t,r){return kpoint.distanceToPoint(t,r)},coordDiff:function(t,r){return _.map(r,function(e,a){return r[a]-t[a]})},snapCoord:function(t,r){return _.map(t,function(t,e){return KhanUtil.roundToNearest(r[e],t)})},findAngle:function(t,r,e){if(void 0===e){var a=t[0]-r[0],n=t[1]-r[1];return a||n?(180+180*Math.atan2(-n,-a)/Math.PI+360)%360:0}return KhanUtil.findAngle(t,e)-KhanUtil.findAngle(r,e)},graphs:{}}),_.extend(Graphie.prototype,{cartToPolar:cartToPolar,polar:polar});var labelDirections={center:[-.5,-.5],above:[-.5,-1],"above right":[0,-1],right:[0,-.5],"below right":[0,0],below:[-.5,0],"below left":[-1,0],left:[-1,-.5],"above left":[-1,-1]};KhanUtil.createGraphie=function(t){var r,e,a=40,n=40;$(t).css("position","relative");var i=Raphael(t);$(t).children("div").css("position","absolute");var o={"stroke-width":2,fill:"none"},s=function(t){if("number"==typeof t)return s([t,t]);var r=t[0],e=t[1];return[r*a,e*n]},l=function y(t){if("number"==typeof t)return y([t,t]);var i=t[0],o=t[1];return[(i-r[0])*a,(e[1]-o)*n]},u=function(t){if("number"==typeof t)return u([t,t]);var i=t[0],o=t[1];return[i/a+r[0],e[1]-o/n]},h=function(t){return"number"==typeof t?h([t,t]):[t[0]/a,t[1]/n]},p=function(t,r){var e=$(t),a=e.data("labelDirection");if(e.css("visibility",""),"number"==typeof a){var n=Math.cos(a),i=Math.sin(a),o=Math.min(r[0]/2/Math.abs(n),r[1]/2/Math.abs(i));e.css({marginLeft:-r[0]/2+n*o,marginTop:-r[1]/2-i*o})}else{var s=labelDirections[a||"center"];e.css({marginLeft:Math.round(r[0]*s[0]),marginTop:Math.round(r[1]*s[1])})}},c=function(t,r){return $.map(t,function(t,e){if(t===!0)return"z";var a=r?t:l(t);return(0===e?"M":"L")+KhanUtil.bound(a[0])+" "+KhanUtil.bound(a[1])}).join("")},f=function(t,e,a){var n=function(r){return(t*r+e)*r+a};if(0===t){var i=_.map(r,function(t){return[t,n(t)]});return c(i)}var o=-e/(2*t),s=Math.max(Math.abs(o-r[0]),Math.abs(o-r[1])),u=o+s,h=[o,n(o)],p=[u,n(u)],f=[h[0],h[1]-(p[1]-h[1])],v=Math.abs(h[0]-p[0]),d=[h[0]-v,p[1]],g=[h[0]+v,p[1]],i=_.map([d,f,g],l),b=_.map(_.flatten(i),KhanUtil.bound);return"M"+b[0]+","+b[1]+" Q"+b[2]+","+b[3]+" "+b[4]+","+b[5]},v=function(t,e,a,n){var i=Math.abs(Math.PI/(2*e)),o=function(r){return t*Math.sin(e*r-a)+n},s=function(r){return t*e*Math.cos(a-e*r)},u=function(t,r){var e=t+i*r,a=e+i,n=[e,2*e/3+1*a/3,1*e/3+2*a/3,a],u=[o(e),o(e)+s(e)*(a-e)/3,o(a)-s(a)*(a-e)/3,o(a)];return _.map(_.zip(n,u),l)},h=r[1]-r[0],p=Math.ceil(h/i)+1,c=a/e,f=c-r[0];c-=i*Math.ceil(f/i);for(var v=u(c,0),d="M"+v[0][0]+","+v[0][1]+" C"+v[1][0]+","+v[1][1]+" "+v[2][0]+","+v[2][1]+" "+v[3][0]+","+v[3][1],g=1;p>g;g++)v=u(c,g),d+=" C"+v[1][0]+","+v[1][1]+" "+v[2][0]+","+v[2][1]+" "+v[3][0]+","+v[3][1];return d};$.extend(KhanUtil,{svgPath:c});var d=function(t){var o={scale:function(t){"number"==typeof t&&(t=[t,t]),a=t[0],n=t[1],i.setSize((r[1]-r[0])*a,(e[1]-e[0])*n)},clipRect:function(t){var r=t[0],e=t[1];return r[1]+=e[1],{"clip-rect":l(r).concat(s(e)).join(" ")}},strokeWidth:function(t){return{"stroke-width":parseFloat(t)}},rx:function(t){return{rx:s([t,0])[0]}},ry:function(t){return{ry:s([0,t])[1]}},r:function(t){var r=s([t,t]);return{rx:r[0],ry:r[1]}}},u={};return $.each(t||{},function(t,r){var e=o[t];if("function"==typeof e)$.extend(u,e(r));else{var a=t.replace(/([A-Z]+)([A-Z][a-z])/g,"$1-$2").replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase();u[a]=r}}),u},g=function x(t){var r=t.constructor.prototype;if(r===Raphael.el){if("path"===t.type&&"undefined"==typeof t.arrowheadsDrawn){var e=t.attr("stroke-width"),a=.6+.4*e,n=t.getTotalLength(),o=i.set(),s=i.path("M-3 4 C-2.75 2.5 0 0.25 0.75 0C0 -0.25 -2.75 -2.5 -3 -4"),l=t.getPointAtLength(n-.4),u=t.getPointAtLength(n-.75*a),h=180*Math.atan2(l.y-u.y,l.x-u.x)/Math.PI,p=t.attr();delete p.path;var c=t.getSubpath(0,n-.75*a);return c=i.path(c).attr(p),c.arrowheadsDrawn=!0,t.remove(),s.rotate(h,.75,0).scale(a,a,.75,0).translate(u.x,u.y).attr(p).attr({"stroke-linejoin":"round","stroke-linecap":"round"}),s.arrowheadsDrawn=!0,o.push(c),o.push(s),o}}else if(r===Raphael.st)for(var f=0,n=t.items.length;n>f;f++)x(t.items[f]);return t},b={circle:function(t,r){return i.ellipse.apply(i,l(t).concat(s([r,r])))},rect:function(t,r,e,a){var n=l([t,r+a]),o=s([e,a]);return i.rect.apply(i,n.concat(o))},ellipse:function(t,r){return i.ellipse.apply(i,l(t).concat(s(r)))},fixedEllipse:function(t,r,e){var a=l(t),n=s(r),i=2,o=2*n[0]*e+i,u=2*n[1]*e+i,h=a[0]-o/2,p=a[1]-u/2,c=document.createElement("div");$(c).css({position:"absolute",width:o+"px",height:u+"px",left:h+"px",top:p+"px"});var f=Raphael(c,o,u),v=f.ellipse(o/2,u/2,n[0],n[1]);return{wrapper:c,visibleShape:v}},arc:function(t,r,e,a,n){e=(e%360+360)%360,a=(a%360+360)%360;var o=l(t),u=s(r),h=polar(r,e),p=polar(r,a),c=l([t[0]+h[0],t[1]+h[1]]),f=l([t[0]+p[0],t[1]+p[1]]),v=((a-e)%360+360)%360>180;return i.path("M"+c.join(" ")+"A"+u.join(" ")+" 0 "+(v?1:0)+" 0 "+f.join(" ")+(n?"L"+o.join(" ")+"z":""))},path:function(t){var r=i.path(c(t));return r.graphiePath=t,r},fixedPath:function(t,r,e){t=_.map(t,l),r=r?l(r):null,e=e||c;var a=_.min(_.pluck(t,0)),n=_.max(_.pluck(t,0)),i=_.min(_.pluck(t,1)),o=_.max(_.pluck(t,1)),s=[4,4],u=[a,i];t=_.map(t,function(t){return kvector.add(kvector.subtract(t,u),kvector.scale(s,.5))});var h=n-a+s[0],p=o-i+s[1],f=u[0]-s[0]/2,v=u[1]-s[1]/2,d=document.createElement("div");$(d).css({position:"absolute",width:h+"px",height:p+"px",left:f+"px",top:v+"px",transformOrigin:r?h/2+r[0]+"px "+(p/2+r[1])+"px":null});var g=Raphael(d,h,p),b=g.path(e(t));return{wrapper:d,visibleShape:b}},scaledPath:function(t){var r=i.path(c(t,!0));return r.graphiePath=t,r},line:function(t,r){return this.path([t,r])},parabola:function(t,r,e){return i.path(f(t,r,e))},fixedLine:function(t,r,e){var a=[e,e];t=l(t),r=l(r);var n=[Math.min(t[0],r[0]),Math.min(t[1],r[1])];t=kvector.add(kvector.subtract(t,n),kvector.scale(a,.5)),r=kvector.add(kvector.subtract(r,n),kvector.scale(a,.5));var i=n[0]-a[0]/2,o=n[1]-a[1]/2,s=Math.abs(t[0]-r[0])+a[0],u=Math.abs(t[1]-r[1])+a[1],h=document.createElement("div");$(h).css({position:"absolute",width:s+"px",height:u+"px",left:i+"px",top:o+"px",transformOrigin:t[0]+"px "+t[1]+"px"});var p=Raphael(h,s,u),c="M"+t[0]+" "+t[1]+" L"+r[0]+" "+r[1],f=p.path(c);return f.graphiePath=[t,r],{wrapper:h,visibleShape:f}},sinusoid:function(t,r,e,a){return i.path(v(t,r,e,a))},grid:function(t,r){for(var e=o.step||[1,1],a=i.set(),n=e[0]*Math.ceil(t[0]/e[0]);n<=t[1];n+=e[0])a.push(this.line([n,r[0]],[n,r[1]]));for(var s=e[1]*Math.ceil(r[0]/e[1]);s<=r[1];s+=e[1])a.push(this.line([t[0],s],[t[1],s]));return a},label:function(r,e,a,n){n="undefined"==typeof n||n;var i=$("<span>").addClass("graphie-label");n||i.html(e);var s=o["label-distance"];i.css($.extend({},o,{position:"absolute",padding:(null!=s?s:7)+"px"})).data("labelDirection",a).appendTo(t),i.setPosition=function(t){var r=l(t);i.css({left:r[0],top:r[1]})},i.setPosition(r);var u=i[0];if(i.processMath=function(t,r){KhanUtil.processMath(u,t,r,function(){var t=u.scrollWidth,r=u.scrollHeight;p(u,[t,r])})},n)i.processMath(e,!1);else{var h=u.scrollWidth,c=u.scrollHeight;p(u,[h,c])}return i},plotParametric:function(t,r,e,a){a=a||function(t){return[t,0]},o.strokeLinejoin||(o.strokeLinejoin="round"),o.strokeLinecap||(o.strokeLinecap="round");var s=r[0],l=r[1],u=(l-s)/(o["plot-points"]||800);0===u&&(u=1);for(var h=i.set(),p=[],c=KhanUtil.coordDiff(t(s),a(s)),f=s,v=s;l>=v;v+=u){var d=t(v),g=a(v),b=KhanUtil.coordDiff(d,g);if(b[1]<0!=c[1]<0&&Math.abs(b[1]-c[1])>2*n||Math.abs(b[1])>1e7||isNaN(b[1])){if(e){p.push(d);for(var m=v-u;m>=f;m-=u)p.push(a(m));f=v}h.push(this.path(p)),p=[],e&&p.push(d)}else p.push(d);c=b}if(e)for(var m=l-u;m>=f;m-=u)p.push(a(m));return h.push(this.path(p)),h},plotPolar:function(t,r){var e=r[0],n=r[1];return o["plot-points"]||(o["plot-points"]=2*(n-e)*a),this.plotParametric(function(r){return polar(t(r),180*r/Math.PI)},r)},plot:function(t,r,e,n,i){var s=r[0],l=r[1];if(o["plot-points"]||(o["plot-points"]=2*(l-s)*a),e){if(i)throw new Error("Can't shade area between functions with swapped axes.");return this.plotParametric(function(r){return[t(r),r]},r,n)}if(i){if(n)return this.plotParametric(function(r){return[r,t(r)]},r,n,function(t){return[t,i(t)]});throw new Error("fn2 should only be set when 'shade' is True.")}return this.plotParametric(function(r){return[r,t(r)]},r,n)},plotPiecewise:function(t,r){var e=i.set(),a=this;return _.times(t.length,function(n){var i=t[n],o=r[n],s=a.plotParametric(function(t){return[t,i(t)]},o);_.each(s,function(t){e.push(t)})}),e},plotEndpointCircles:function(t){var r=i.set(),e=this;return _.each(t,function(t,a){r.push(e.circle(t,.15))}),r},plotAsymptotes:function(t,r){for(var e=r[0],a=r[1],s=(a-e)/(o["plot-points"]||800),l=i.set(),u=t(e),h=e;a>=h;h+=s){var p=t(h);0>p!=0>u&&Math.abs(p-u)>2*n&&l.push(this.line([h,n],[h,-n])),u=p}return l}},m=new Graphie;return _.extend(m,{raphael:i,init:function(o){var s=o.scale||[40,40];if(s="number"==typeof s?[s,s]:s,a=s[0],n=s[1],null==o.range)return Khan.error("range should be specified in graph init");r=o.range[0],e=o.range[1];var l=(r[1]-r[0])*a,u=(e[1]-e[0])*n;return i.setSize(l,u),$(t).css({width:l,height:u}),this.range=o.range,this.scale=s,this.dimensions=[l,u],this.xpixels=l,this.ypixels=u,this},setInterval:function(){var t=Function.prototype.apply.call(window.setInterval,window,arguments);return intervalIDs.push(t),t},style:function(t,r){var e=d(t);if("function"==typeof r){var a=o;o=$.extend({},o,e);var n=r.call(m);return o=a,n}$.extend(o,e)},scalePoint:l,scaleVector:s,unscalePoint:u,unscaleVector:h,svgPath:c,svgParabolaPath:f,svgSinusoidPath:v}),$.each(b,function(t){m[t]=function(){var r,e=arguments[arguments.length-1],a=o;if("object"!=typeof e||_.isArray(e))o=$.extend({},o),r=b[t].apply(b,arguments);else{o=$.extend({},o,d(e));var n=[].slice.call(arguments,0,arguments.length-1);r=b[t].apply(b,n)}var i=r.constructor.prototype;return i===Raphael.el||i===Raphael.st?(r.attr(o),o.arrows&&(r=g(r))):r instanceof $&&r.css(o),o=a,r}}),m.graphInit=function(t){t=t||{},$.each(t,function(r,e){r.match(/.*Opacity$/)||"range"===r||"number"!=typeof e||(t[r]=[e,e]),("range"===r||"gridRange"===r)&&(e.constructor===Array?e[0].constructor!==Array&&(t[r]=[[-e[0],e[0]],[-e[1],e[1]]]):"number"==typeof e&&(t[r]=[[-e,e],[-e,e]]))});var r=t.range||[[-10,10],[-10,10]],e=t.gridRange||t.range,a=t.scale||[20,20],n=null!=t.grid?t.grid:!0,i=t.gridOpacity||.1,o=t.gridStep||[1,1],s=null!=t.axes?t.axes:!0,l=t.axisArrows||"",u=t.axisOpacity||1,h=t.axisCenter||[Math.min(Math.max(r[0][0],0),r[0][1]),Math.min(Math.max(r[1][0],0),r[1][1])],p=null!=t.axisLabels?t.axisLabels:!1,c=null!=t.ticks?t.ticks:!0,f=t.tickStep||[2,2],v=t.tickLen||[5,5],d=t.tickOpacity||1,g=t.labels||t.labelStep||!1,b=t.labelStep||[1,1],m=t.labelOpacity||1,y=t.unityLabels||!1,x=t.labelFormat||function(t){return t},M=t.xLabelFormat||x,w=t.yLabelFormat||x,k=null!=t.smartLabelPositioning?t.smartLabelPositioning:!0,P=[[r[0][0]-(r[0][0]>0?1:0),r[0][1]+(r[0][1]<0?1:0)],[r[1][0]-(r[1][0]>0?1:0),r[1][1]+(r[1][1]<0?1:0)]];if(_.isArray(y)||(y=[y,y]),k){var L=function(t){return function(r){return(t(r)+"").replace(/-(\d)/g,"\\llap{-}$1")}};M=L(M),w=L(w)}this.init({range:P,scale:a}),n&&this.grid(e[0],e[1],{stroke:"#000000",opacity:i,step:o}),s&&("<->"===l||l===!0?this.style({stroke:"#000000",opacity:u,strokeWidth:2,arrows:"->"},function(){r[1][0]<0&&r[1][1]>0&&(this.path([h,[e[0][0],h[1]]]),this.path([h,[e[0][1],h[1]]])),r[0][0]<0&&r[0][1]>0&&(this.path([h,[h[0],e[1][0]]]),this.path([h,[h[0],e[1][1]]]))}):("->"===l||""===l)&&this.style({stroke:"#000000",opacity:u,strokeWidth:2,arrows:l},function(){this.path([[e[0][0],h[1]],[e[0][1],h[1]]]),this.path([[h[0],e[1][0]],[h[0],e[1][1]]])}),p&&2===p.length&&(this.label([e[0][1],h[1]],p[0],"right"),this.label([h[0],e[1][1]],p[1],"above"))),c&&this.style({stroke:"#000000",opacity:d,strokeWidth:1},function(){var t=o[0]*f[0],n=v[0]/a[1],i=e[0][0],s=e[0][1];if(r[1][0]<0&&r[1][1]>0){for(var u=t+h[0];s>=u;u+=t)(s>u||!l)&&this.line([u,-n+h[1]],[u,n+h[1]]);for(var u=-t+h[0];u>=i;u-=t)(u>i||!l)&&this.line([u,-n+h[1]],[u,n+h[1]])}if(t=o[1]*f[1],n=v[1]/a[0],i=e[1][0],s=e[1][1],r[0][0]<0&&r[0][1]>0){for(var p=t+h[1];s>=p;p+=t)(s>p||!l)&&this.line([-n+h[0],p],[n+h[0],p]);for(var p=-t+h[1];p>=i;p-=t)(p>i||!l)&&this.line([-n+h[0],p],[n+h[0],p])}}),g&&this.style({stroke:"#000000",opacity:m},function(){for(var t=o[0]*f[0]*b[0],r=e[0][0],a=e[0][1],n=h[0]<0?"above":"below",i=h[0]<0?"right":"left",s=0===h[0]&&0!==h[1],u=0!==h[0]&&0===h[1],p=0!==h[0]||0!==h[1],c=y[0]||p,v=y[1]||p,d=(s?0:t)+h[0];a>=d;d+=t)(a>d||!l)&&this.label([d,h[1]],M(d),n);for(var d=-t*(c?1:2)+h[0];d>=r;d-=t)(d>r||!l)&&this.label([d,h[1]],M(d),n);t=o[1]*f[1]*b[1],r=e[1][0],a=e[1][1];for(var g=(u?0:t)+h[1];a>=g;g+=t)(a>g||!l)&&this.label([h[0],g],w(g),i);for(var g=-t*(v?1:2)+h[1];g>=r;g-=t)(g>r||!l)&&this.label([h[0],g],w(g),i)})},m},$.fn.graphie=function(t){return null==Khan.query.nographie?this.find(".graphie, script[type='text/graphie']").addBack().filter(".graphie, script[type='text/graphie']").each(function(){var r,e=$(this).text();if(null==$(this).data("graphie")){if($(this).empty(),$(this).data("update")){var a=$(this).data("update");$(this).remove();var n=$("#problemarea").add(t);r=n.find("#"+a+".graphie").data("graphie")}else{var i=this;null!=$(this).filter("script")[0]&&(i=$("<div>").addClass("graphie").attr("id",$(this).attr("id")).insertAfter(this)[0],$(this).remove()),r=KhanUtil.createGraphie(i),$(i).data("graphie",r);var a=$(i).attr("id");a&&(KhanUtil.graphs[a]=r)}"undefined"==typeof r.graph&&(r.graph={}),e="(function() {"+e+"\n})()",KhanUtil.currentGraph=r,$.tmpl.getVAR(e,r)}}).end():void 0},$.fn.graphieCleanup=function(t){cleanupIntervals()};
},{"./kpoint.js":10,"./kvector.js":11,"./tex.js":15,"./tmpl.js":16}],7:[function(require,module,exports){
function sum(e){return _.reduce(e,function(e,t){return e+t},0)}function clockwise(e){var t=_.zip(e,e.slice(1).concat(e.slice(0,1))),o=_.map(t,function(e){var t=e[0],o=e[1];return(o[0]-t[0])*(o[1]+t[1])});return sum(o)>0}function addPoints(){var e=_.toArray(arguments),t=_.zip.apply(_,e);return _.map(t,sum)}function reverseVector(e){return _.map(e,function(e){return-1*e})}function scaledDistanceFromAngle(e){var t=70.2941120352484,o=11.374597405497571,n=-.037587715462826674;return(t-o)*Math.exp(n*e)+o}function scaledPolarRad(e,t){return[e*Math.cos(t),e*Math.sin(t)*-1]}function scaledPolarDeg(e,t){var o=t*Math.PI/180;return scaledPolarRad(e,o)}function Protractor(e,t){this.set=e.raphael.set(),this.cx=t[0],this.cy=t[1];var o=this,n=e.unscaleVector(180.5)[0],i=e.scalePoint([this.cx-n,this.cy+n-e.unscaleVector(10.5)[1]]);this.set.push(e.mouselayer.image("https://ka-perseus-graphie.s3.amazonaws.com/e9d032f2ab8b95979f674fbfa67056442ba1ff6a.png",i[0],i[1],360,180));var a=function(o,i){var a=e.scaleVector(n);a[0]-=16,a[1]-=16;var r=e.scalePoint(t),s=Math.sin((o+90)*Math.PI/180)*(a[0]+i)+r[0],l=Math.cos((o+90)*Math.PI/180)*(a[1]+i)+r[1];return s+","+l},r=e.raphael.path(" M"+a(180,6)+" L"+a(180,2)+" L"+a(183,10)+" L"+a(180,18)+" L"+a(180,14)+" A"+(e.scaleVector(n)[0]+10)+","+(e.scaleVector(n)[1]+10)+",0,0,1,"+a(170,14)+" L"+a(170,18)+" L"+a(167,10)+" L"+a(170,2)+" L"+a(170,6)+" A"+(e.scaleVector(n)[0]+10)+","+(e.scaleVector(n)[1]+10)+",0,0,0,"+a(180,6)+" Z").attr({stroke:null,fill:KhanUtil.INTERACTIVE});this.set.push(r),this.centerPoint=e.addMovablePoint({coord:t,visible:!1}),this.rotateHandle=e.addMovablePoint({coord:[Math.sin(275*Math.PI/180)*(n+.5)+this.cx,Math.cos(275*Math.PI/180)*(n+.5)+this.cy],onMove:function(e,t){var n=180*Math.atan2(o.centerPoint.coord[1]-t,o.centerPoint.coord[0]-e)/Math.PI;o.rotate(-n-5,!0)}}),this.rotateHandle.constraints.fixedDistance.dist=n+.5,this.rotateHandle.constraints.fixedDistance.point=this.centerPoint,this.rotateHandle.visibleShape.remove(),this.rotateHandle.mouseTarget.attr({scale:2});var s=!1,l=!1,c=function(){return l||s},d=this,h=$(d.rotateHandle.mouseTarget.getMouseTarget());h.bind("vmousedown",function(e){s=!0,r.animate({scale:1.5,fill:KhanUtil.INTERACTING},50),$(document).bind("vmouseup.rotateHandle",function(e){s=!1,c()||r.animate({scale:1,fill:KhanUtil.INTERACTIVE},50),$(document).unbind("vmouseup.rotateHandle")})}),h.bind("vmouseover",function(e){l=!0,r.animate({scale:1.5,fill:KhanUtil.INTERACTING},50)}),h.bind("vmouseout",function(e){l=!1,c()||r.animate({scale:1,fill:KhanUtil.INTERACTIVE},50)});var u=$.map(this.set,function(e){return e.node});return this.makeTranslatable=function(){$(u).css("cursor","move"),$(u).bind("vmousedown",function(t){t.preventDefault();var n=t.pageX-$(e.raphael.canvas.parentNode).offset().left,i=t.pageY-$(e.raphael.canvas.parentNode).offset().top;$(document).bind("vmousemove.protractor",function(t){var a=t.pageX-$(e.raphael.canvas.parentNode).offset().left,r=t.pageY-$(e.raphael.canvas.parentNode).offset().top;a=Math.max(10,Math.min(e.xpixels-10,a)),r=Math.max(10,Math.min(e.ypixels-10,r));var s=a-n,l=r-i;$.each(o.set.items,function(){this.translate(s,l)}),o.centerPoint.setCoord([o.centerPoint.coord[0]+s/e.scale[0],o.centerPoint.coord[1]-l/e.scale[1]]),o.rotateHandle.setCoord([o.rotateHandle.coord[0]+s/e.scale[0],o.rotateHandle.coord[1]-l/e.scale[1]]),n=a,i=r}),$(document).one("vmouseup",function(e){$(document).unbind("vmousemove.protractor")})})},this.rotation=0,this.rotate=function(t,o){var n=e.scalePoint(this.centerPoint.coord);return o&&(this.rotation=0),this.set.rotate(this.rotation+t,n[0],n[1]),this.rotation=this.rotation+t,this},this.moveTo=function(t,n){var i=e.scalePoint(o.centerPoint.coord),a=e.scalePoint([t,n]),r=2*KhanUtil.getDistance(i,a);$({x:i[0],y:i[1]}).animate({x:a[0],y:a[1]},{duration:r,step:function(t,n){var i=0,a=0;"x"===n.prop?i=t-e.scalePoint(o.centerPoint.coord)[0]:"y"===n.prop&&(a=t-e.scalePoint(o.centerPoint.coord)[1]),$.each(o.set.items,function(){this.translate(i,a)}),o.centerPoint.setCoord([o.centerPoint.coord[0]+i/e.scale[0],o.centerPoint.coord[1]-a/e.scale[1]]),o.rotateHandle.setCoord([o.rotateHandle.coord[0]+i/e.scale[0],o.rotateHandle.coord[1]-a/e.scale[1]])}})},this.rotateTo=function(e){Math.abs(this.rotation-e)>180&&(this.rotation+=360);var t=5*Math.abs(this.rotation-e);$({0:this.rotation}).animate({0:e},{duration:t,step:function(e,t){o.rotate(e,!0),o.rotateHandle.setCoord([Math.sin((e+275)*Math.PI/180)*(n+.5)+o.centerPoint.coord[0],Math.cos((e+275)*Math.PI/180)*(n+.5)+o.centerPoint.coord[1]])}})},this.remove=function(){this.set.remove()},this.makeTranslatable(),this}function Ruler(e,t){function o(e){for(var t=0;t<g.length;t++){var o=g[t];if(e%o===0)return n[o]}}_.defaults(t,{center:[0,0],pixelsPerUnit:40,ticksPerUnit:10,units:10,label:"",style:{fill:null,stroke:KhanUtil.GRAY}});var n,i=_.extend({},t.style,{strokeWidth:1}),a=_.extend({},t.style,{strokeWidth:2}),r=t.units*t.pixelsPerUnit,s=50,l=e.unscalePoint(kvector.subtract(e.scalePoint(t.center),kvector.scale([r,-s],.5))),c=t.pixelsPerUnit/e.scale[0],d=s/e.scale[0],h=kvector.add(l,[t.units*c,d]),u=1;if(10===t.ticksPerUnit)n={10:u,5:.55*u,1:.35*u};else{var p=[1,.6,.45,.3];n={};for(var v=t.ticksPerUnit;v>=1;v/=2)n[v]=u*(p.shift()||.2)}var g=_.keys(n).sort(function(e,t){return t-e}),f=l[0],m=l[1],y=h[0],b=h[1],x=t.units*t.ticksPerUnit+1,k=e.raphael.set(),M=1/e.scale[0];k.push(e.line([f-M,m],[y+M,m],a)),k.push(e.line([f-M,b],[y+M,b],a)),_.times(x,function(n){var r=n/t.ticksPerUnit,s=f+r*c,l=o(n)*d,h=0===n||n===x-1?a:i;if(k.push(e.line([s,m],[s,m+l],h)),r%1===0){var u,p,v=e.scalePoint([s,b]);0===r?(u=t.label,p={mm:13,cm:11,m:8,km:11,"in":8,ft:8,yd:10,mi:10}[u]||3*u.toString().length):(u=r,p=-3*(r.toString().length+1));var g=e.raphael.text(v[0]+p,v[1]+10,u);g.attr({"font-family":"KaTeX_Main","font-size":"12px",color:"#444"}),k.push(g)}});var A=e.mouselayer.path(KhanUtil.svgPath([l,[f,b],h,[y,m],!0]));A.attr({fill:"#000",opacity:0,stroke:"#000","stroke-width":2}),k.push(A);var S=$.map(k,function(e){return e.node});$(S).css("cursor","move"),$(S).bind("vmousedown",function(t){t.preventDefault();var o=t.pageX-$(e.raphael.canvas.parentNode).offset().left,n=t.pageY-$(e.raphael.canvas.parentNode).offset().top;$(document).bind("vmousemove.ruler",function(t){var i=t.pageX-$(e.raphael.canvas.parentNode).offset().left,a=t.pageY-$(e.raphael.canvas.parentNode).offset().top;i=Math.max(10,Math.min(e.xpixels-10,i)),a=Math.max(10,Math.min(e.ypixels-10,a));var r=i-o,s=a-n;k.translate(r,s),T.setCoord([T.coord[0]+r/e.scale[0],T.coord[1]-s/e.scale[1]]),P.setCoord([P.coord[0]+r/e.scale[0],P.coord[1]-s/e.scale[1]]),o=i,n=a}),$(document).one("vmouseup",function(e){$(document).unbind("vmousemove.ruler")})});var T=e.addMovablePoint({coord:l,normalStyle:{fill:KhanUtil.INTERACTIVE,"fill-opacity":0,stroke:KhanUtil.INTERACTIVE},highlightStyle:{fill:KhanUtil.INTERACTING,"fill-opacity":.1,stroke:KhanUtil.INTERACTING},pointSize:6,onMove:function(t,o){var n=P.coord[1]-o,i=P.coord[0]-t,a=180*Math.atan2(n,i)/Math.PI,r=kvector.scale(kvector.add([t,o],P.coord),.5),s=e.scalePoint(r),l=kvector.scale(kvector.add(T.coord,P.coord),.5),c=e.scalePoint(l),d=kvector.subtract(s,c);k.rotate(-a,c[0],c[1]),k.translate(d[0],d[1])}}),P=e.addMovablePoint({coord:[y,m],normalStyle:{fill:KhanUtil.INTERACTIVE,"fill-opacity":0,stroke:KhanUtil.INTERACTIVE},highlightStyle:{fill:KhanUtil.INTERACTING,"fill-opacity":.1,stroke:KhanUtil.INTERACTING},pointSize:6,onMove:function(t,o){var n=o-T.coord[1],i=t-T.coord[0],a=180*Math.atan2(n,i)/Math.PI,r=kvector.scale(kvector.add([t,o],T.coord),.5),s=e.scalePoint(r),l=kvector.scale(kvector.add(T.coord,P.coord),.5),c=e.scalePoint(l),d=kvector.subtract(s,c);k.rotate(-a,c[0],c[1]),k.translate(d[0],d[1])}});return T.constraints.fixedDistance.dist=r/e.scale[0],T.constraints.fixedDistance.point=P,P.constraints.fixedDistance.dist=r/e.scale[0],P.constraints.fixedDistance.point=T,this.remove=function(){k.remove(),T.remove(),P.remove()},this}function MovableAngle(e,t){if(this.graphie=e,_.extend(this,t),_.defaults(this,{normalStyle:{stroke:KhanUtil.INTERACTIVE,"stroke-width":2,fill:KhanUtil.INTERACTIVE},highlightStyle:{stroke:KhanUtil.INTERACTING,"stroke-width":2,fill:KhanUtil.INTERACTING},labelStyle:{stroke:KhanUtil.DYNAMIC,"stroke-width":1,color:KhanUtil.DYNAMIC},angleStyle:{stroke:KhanUtil.DYNAMIC,"stroke-width":1,color:KhanUtil.DYNAMIC},allowReflex:!0}),!this.points||3!==this.points.length)throw new Error("MovableAngle requires 3 points");this.points=_.map(t.points,function(t){return _.isArray(t)?e.addMovablePoint({coord:t,visible:!1,constraints:{fixed:!0},normalStyle:this.normalStyle}):t},this),this.coords=_.pluck(this.points,"coord"),null==this.reflex&&(this.allowReflex?this.reflex=this._getClockwiseAngle(this.coords)>180:this.reflex=!1),this.rays=_.map([0,2],function(t){return e.addMovableLineSegment({pointA:this.points[1],pointZ:this.points[t],fixed:!0,extendRay:!0})},this),this.temp=[],this.labeledAngle=e.label([0,0],"","center",this.labelStyle),this.fixed||(this.addMoveHandlers(),this.addHighlightHandlers()),this.update()}require("../third_party/jquery.mobile.vmouse.js"),require("./graphie.js");var kvector=require("./kvector.js"),kpoint=require("./kpoint.js"),kline=require("./kline.js"),WrappedEllipse=require("./wrapped-ellipse.js"),WrappedLine=require("./wrapped-line.js"),WrappedPath=require("./wrapped-path.js");$.extend(KhanUtil,{FILL_OPACITY:.3,dragging:!1,createSorter:function(){var e,t={};return t.hasAttempted=!1,t.init=function(o){e=$("[id="+o+"]").last();var n=e.wrap("<div>").parent(),i=$("<li>");i.addClass("placeholder"),n.addClass("sortable ui-helper-clearfix"),e.find("li").each(function(o,n){$(n).bind("vmousedown",function(o){if("vmousedown"===o.type&&(1===o.which||0===o.which)){o.preventDefault(),$(n).addClass("dragging");var a=$(this).index();i.insertAfter(n),i.width($(n).width()),$(this).css("z-index",100);var r=$(this).offset(),s={left:o.pageX-r.left-3,top:o.pageY-r.top-3};$(n).css({position:"absolute"}),$(n).offset({left:r.left,top:r.top}),$(document).bind("vmousemove.tile vmouseup.tile",function(o){if(o.preventDefault(),"vmousemove"===o.type){t.hasAttempted=!0,$(n).offset({left:o.pageX-s.left,top:o.pageY-s.top});var r=e.offset().left,l=$(n).offset().left-r,c=0,d=0;if(e.find("li").each(function(){this!==i[0]&&this!==n&&(l>d+$(this).outerWidth(!0)/2&&(c+=1),d+=$(this).outerWidth(!0))}),c!==a)if(a=c,0===c)i.prependTo(e),$(n).prependTo(e);else{i.detach(),$(n).detach();var h=e.find("li")[c-1];i.insertAfter(h),$(n).insertAfter(h)}}else if("vmouseup"===o.type){$(document).unbind(".tile");var u=$(n).offset();$(u).animate(i.offset(),{duration:150,step:function(e,t){u[t.prop]=e,$(n).offset(u)},complete:function(){$(n).css("z-index",0),i.detach(),$(n).css({position:"static"}),$(n).removeClass("dragging")}})}})}})})},t.getContent=function(){var t=[];return e.find("li").each(function(e,o){t.push($.trim($(o).find(".sort-key").text()))}),t},t.setContent=function(t){var o=[];$.each(t,function(t,n){var i=e.find("li .sort-key").filter(function(){return $(this).text()===n}).closest("li").get(0);$(i).detach(),o.push(i)}),e.append(o)},t},bogusShape:{animate:function(){},attr:function(){},remove:function(){}}}),$.extend(KhanUtil.Graphie.prototype,{initAutoscaledGraph:function(e,t){var o=this;t=$.extend({xpixels:500,ypixels:500,xdivisions:20,ydivisions:20,labels:!0,unityLabels:!0,range:void 0===e?[[-10,10],[-10,10]]:e},t),t.scale=[t.xpixels/(t.range[0][1]-t.range[0][0]),t.ypixels/(t.range[1][1]-t.range[1][0])],t.gridStep=[(t.range[0][1]-t.range[0][0])/t.xdivisions,(t.range[1][1]-t.range[1][0])/t.ydivisions],o.xpixels=t.xpixels,o.ypixels=t.ypixels,o.range=t.range,o.scale=t.scale,o.graphInit(t)},addMouseLayer:function(e){var t=this;e=_.extend({allowScratchpad:!1},e);var o=2;if(t.mouselayer=Raphael(t.raphael.canvas.parentNode,t.xpixels,t.ypixels),$(t.mouselayer.canvas).css("z-index",o),e.onClick||e.onMouseDown||e.onMouseMove||e.onMouseOver||e.onMouseOut){var n=t.mouselayer.rect(0,0,t.xpixels,t.ypixels).attr({fill:"#000",opacity:0}),i=!1;$(t.mouselayer.canvas).on("vmousedown",function(o){o.target===n[0]&&(e.onMouseDown&&e.onMouseDown(t.getMouseCoord(o)),i=!0,e.onMouseMove&&$(document).bind("vmousemove.mouseLayer",function(o){i&&(o.preventDefault(),e.onMouseMove(t.getMouseCoord(o)))}),$(document).bind("vmouseup.mouseLayer",function(o){$(document).unbind(".mouseLayer"),i&&e.onClick&&e.onClick(t.getMouseCoord(o)),i=!1}))}),e.onMouseOver&&$(t.mouselayer.canvas).on("vmouseover",function(o){e.onMouseOver(t.getMouseCoord(o))}),e.onMouseOut&&$(t.mouselayer.canvas).on("vmouseout",function(o){e.onMouseOut(t.getMouseCoord(o))})}e.allowScratchpad||Khan.scratchpad.disable(),t._mouselayerWrapper=document.createElement("div"),$(t._mouselayerWrapper).css({position:"absolute",left:0,top:0,zIndex:o}),t._visiblelayerWrapper=document.createElement("div"),$(t._visiblelayerWrapper).css({position:"absolute",left:0,top:0});var a=t.raphael.canvas.parentNode;a.appendChild(t._visiblelayerWrapper),a.appendChild(t._mouselayerWrapper),t.addToMouseLayerWrapper=function(e){this._mouselayerWrapper.appendChild(e)},t.addToVisibleLayerWrapper=function(e){this._visiblelayerWrapper.appendChild(e)}},getMousePx:function(e){var t=this,o=e.pageX-$(t.raphael.canvas.parentNode).offset().left,n=e.pageY-$(t.raphael.canvas.parentNode).offset().top;return[o,n]},getMouseCoord:function(e){return this.unscalePoint(this.getMousePx(e))},drawArcs:function(e,t,o,n){var i=KhanUtil.findAngle(e,t),a=KhanUtil.findAngle(o,t);if(((a-i)%360+360)%360>180){var r=i;i=a,a=r}var s=.3;75>((a-i)%360+360)%360&&(s=-.6/90*(((a-i)%360+360)%360)+.8);for(var l=[],c=0;n>c;++c)l.push(this.arc(t,s+.15*c,i,a));return l},labelAngle:function(e){var t=this;_.defaults(e,{point1:[0,0],vertex:[0,0],point3:[0,0],label:null,numArcs:1,showRightAngleMarker:!0,pushOut:0,clockwise:!1,style:{}});var o,n,i=void 0===e.text?"":e.text,a=e.vertex,r=t.scalePoint(a);e.clockwise?(o=e.point1,n=e.point3):(o=e.point3,n=e.point1);var s=KhanUtil.findAngle(o,a),l=KhanUtil.findAngle(n,a),c=(l+360-s)%360,d=(s+c/2)%360,h=5*e.pushOut,u=h+scaledDistanceFromAngle(c),p=[];if(Math.abs(c-90)<1e-9&&e.showRightAngleMarker){var v=addPoints(r,scaledPolarDeg(u,s)),g=addPoints(r,scaledPolarDeg(u,l));u*=Math.SQRT2;var f=addPoints(r,scaledPolarDeg(u,d));_.each([v,g],function(o){p.push(t.scaledPath([o,f],e.style))})}else _.times(e.numArcs,function(o){p.push(t.arc(a,t.unscaleVector(u),s,l,e.style)),u+=3});if(i){var m=i.match(/\$deg(\d)?/);if(m){var y=m[1]||1;i=i.replace(m[0],KhanUtil.toFixedApprox(c,y)+"^{\\circ}")}var b=scaledPolarDeg(u+15,d),x=addPoints(r,b),k=t.unscalePoint(x);e.label?(e.label.setPosition(k),e.label.processMath(i,!0)):t.label(k,i,"center",e.style)}return p},labelSide:function(e){var t=this;_.defaults(e,{point1:[0,0],point2:[0,0],label:null,text:"",numTicks:0,numArrows:0,clockwise:!1,style:{}});var o,n;e.clockwise?(o=e.point1,n=e.point2):(o=e.point2,n=e.point1);var i=[(o[0]+n[0])/2,(o[1]+n[1])/2],a=t.scalePoint(i),r=Math.atan2(n[1]-o[1],n[0]-o[0]),s=r+Math.PI/2,l=[],c=0;if(e.numTicks){var d=e.numTicks,h=5,u=5,p=_.extend({},e.style,{strokeWidth:2});_.times(d,function(e){var o=h*(e-(d-1)/2),n=scaledPolarRad(o,r),i=scaledPolarRad(u,s),c=[addPoints(a,n,i),addPoints(a,n,reverseVector(i))];l.push(t.scaledPath(c,p))}),c+=h*(d-1)+15}if(e.numArrows){var d=e.numArrows,v=[o,n].sort(function(e,t){return e[1]===t[1]?e[0]-t[0]:e[1]-t[1]})[0],g=t.scalePoint(v),p=_.extend({},e.style,{arrows:"->",strokeWidth:2}),h=5;_.times(d,function(e){var n=c+h*e,i=scaledPolarRad(n,r);v!==o&&(i=reverseVector(i));var s=addPoints(a,i);l.push(t.scaledPath([g,s],p))})}var f=e.text;if(f){var m=f.match(/\$len(\d)?/);if(m){var y=KhanUtil.getDistance(o,n),b=m[1]||1;f=f.replace(m[0],KhanUtil.toFixedApprox(y,b))}var x=20,k=scaledPolarRad(x,s),M=addPoints(a,k),A=t.unscalePoint(M);e.label?(e.label.setPosition(A),e.label.processMath(f,!0)):t.label(A,f,"center",e.style)}return l},labelVertex:function(e){var t=this;if(_.defaults(e,{point1:null,vertex:[0,0],point3:null,label:null,text:"",clockwise:!1,style:{}}),e.text){var o,n,i=e.vertex,a=t.scalePoint(i);e.clockwise?(o=e.point1,n=e.point3):(o=e.point3,n=e.point1);var r,s=135;if(o&&n){var l=KhanUtil.findAngle(o,i),c=KhanUtil.findAngle(n,i);s=(c+360-l)%360,r=(l+s/2+180)%360}else if(o){var d=KhanUtil.findAngle(i,o);r=d+90}else if(n){var d=KhanUtil.findAngle(n,i);r=d+90}else r=135;var h=10+scaledDistanceFromAngle(360-s),u=scaledPolarDeg(h,r),p=addPoints(a,u),v=t.unscalePoint(p);e.label?(e.label.setPosition(v),e.label.processMath(e.text,!0)):t.label(v,e.text,"center",e.style)}},addMovablePoint:function(e){var t=$.extend(!0,{graph:this,coord:[0,0],snapX:0,snapY:0,pointSize:4,highlight:!1,dragging:!1,visible:!0,bounded:!0,constraints:{fixed:!1,constrainX:!1,constrainY:!1,fixedAngle:{},fixedDistance:{}},lineStarts:[],lineEnds:[],polygonVertices:[],normalStyle:{},highlightStyle:{fill:KhanUtil.INTERACTING,stroke:KhanUtil.INTERACTING},labelStyle:{color:KhanUtil.INTERACTIVE},vertexLabel:"",mouseTarget:null},e),o=t.constraints.fixed?KhanUtil.DYNAMIC:KhanUtil.INTERACTIVE;t.normalStyle=_.extend({},{fill:o,stroke:o},e.normalStyle),void 0!==e.coordX&&(t.coord[0]=e.coordX),void 0!==e.coordY&&(t.coord[1]=e.coordY);var n=t.graph,i=function(e){t.visible&&t.bounded&&!t.constraints.fixed&&(e=n.constrainToBounds(e,10));var o=e[0],i=e[1];if(0!==t.snapX&&(o=Math.round(o/t.snapX)*t.snapX),0!==t.snapY&&(i=Math.round(i/t.snapY)*t.snapY),t.constraints.fixedDistance.snapPoints){var a=n.scalePoint(e),r=a[0],s=a[1],l=2*Math.PI/t.constraints.fixedDistance.snapPoints,c=t.constraints.fixedDistance.dist,d=t.constraints.fixedDistance.point,h=(d[0]-n.range[0][0])*n.scale[0],u=(-d[1]+n.range[1][1])*n.scale[1],p=r-h,v=-s+u,g=Math.atan(v/p),f=0>p;f&&(g+=Math.PI),g=Math.round(g/l)*l,p=c*Math.cos(g),v=c*Math.sin(g),r=p+h,s=-v+u,o=KhanUtil.roundTo(5,r/n.scale[0]+n.range[0][0]),i=KhanUtil.roundTo(5,n.range[1][1]-s/n.scale[1])}var m=t.applyConstraint([o,i]);return m};t.applyConstraint=function(e,o,n){var i=e.slice(),a={};if(n?$.extend(a,{fixed:!1,constrainX:!1,constrainY:!1,fixedAngle:{},fixedDistance:{}},o):$.extend(a,this.constraints,o),a.constrainX)i=[this.coord[0],e[1]];else if(a.constrainY)i=[e[0],this.coord[1]];else if("number"==typeof a.fixedAngle.angle&&"number"==typeof a.fixedDistance.dist){var r=a.fixedAngle.vertex.coord||a.fixedAngle.vertex,s=a.fixedAngle.ref.coord||a.fixedAngle.ref,l=a.fixedDistance.point.coord||a.fixedDistance.point,c=(a.fixedAngle.angle+KhanUtil.findAngle(s,r))*Math.PI/180,d=a.fixedDistance.dist;i[0]=d*Math.cos(c)+l[0],i[1]=d*Math.sin(c)+l[1]}else if("number"==typeof a.fixedAngle.angle){var r=a.fixedAngle.vertex.coord||a.fixedAngle.vertex,s=a.fixedAngle.ref.coord||a.fixedAngle.ref,c=(a.fixedAngle.angle+KhanUtil.findAngle(s,r))*Math.PI/180,h=KhanUtil.findAngle(e,r)*Math.PI/180,u=KhanUtil.getDistance(e,r),d=u*Math.cos(c-h);d=1>d?1:d,i[0]=d*Math.cos(c)+r[0],i[1]=d*Math.sin(c)+r[1]}else if("number"==typeof a.fixedDistance.dist){var l=a.fixedDistance.point.coord||a.fixedDistance.point,h=KhanUtil.findAngle(e,l),d=a.fixedDistance.dist;h=h*Math.PI/180,i[0]=d*Math.cos(h)+l[0],i[1]=d*Math.sin(h)+l[1]}else a.fixed&&(i=t.coord);return i},t.coord=i(t.coord);var a=2;if(t.visible&&n.style(t.normalStyle,function(){var e=[t.pointSize/n.scale[0],t.pointSize/n.scale[1]],o={maxScale:a};t.visibleShape=new WrappedEllipse(n,t.coord,e,o),t.visibleShape.attr(_.omit(t.normalStyle,"scale")),t.visibleShape.toFront()}),t.normalStyle.scale=1,t.highlightStyle.scale=a,t.vertexLabel&&(t.labeledVertex=this.label([0,0],"","center",t.labelStyle)),t.drawLabel=function(){t.vertexLabel&&t.graph.labelVertex({vertex:t.coord,label:t.labeledVertex,text:t.vertexLabel,style:t.labelStyle})},t.drawLabel(),t.grab=function(){$(document).bind("vmousemove.point vmouseup.point",function(e){e.preventDefault(),t.dragging=!0,KhanUtil.dragging=!0;var o=n.getMouseCoord(e);o=i(o);var a,r,s=o[0],l=o[1];if("vmousemove"===e.type){var c=!0;if(_.isFunction(t.onMove)){var d=t.onMove(s,l);d===!1&&(c=!1),_.isArray(d)&&(s=d[0],l=d[1])}if(a=(s-n.range[0][0])*n.scale[0],r=(-l+n.range[1][1])*n.scale[1],c){var h=n.unscalePoint([a,r]);t.visibleShape.moveTo(h),t.mouseTarget.moveTo(h),t.coord=[s,l],t.updateLineEnds(),$(t).trigger("move")}t.drawLabel()}else if("vmouseup"===e.type){if($(document).unbind(".point"),t.dragging=!1,KhanUtil.dragging=!1,_.isFunction(t.onMoveEnd)){var d=t.onMoveEnd(s,l);if(_.isArray(d)){s=d[0],l=d[1],a=(s-n.range[0][0])*n.scale[0],r=(-l+n.range[1][1])*n.scale[1];var h=n.unscalePoint([a,r]);t.visibleShape.moveTo(h),t.mouseTarget.moveTo(h),t.coord=[s,l]}}t.highlight||(t.visibleShape.animate(t.normalStyle,50),t.onUnhighlight&&t.onUnhighlight())}})},t.visible&&!t.constraints.fixed){if(!t.mouseTarget){var r=n.unscaleVector(15),e={mouselayer:!0};t.mouseTarget=new WrappedEllipse(n,t.coord,r,e),t.mouseTarget.attr({fill:"#000",opacity:0})}var s=$(t.mouseTarget.getMouseTarget());s.css("cursor","move"),s.bind("vmousedown vmouseover vmouseout",function(e){"vmouseover"===e.type?(t.highlight=!0,KhanUtil.dragging||(t.visibleShape.animate(t.highlightStyle,50),t.onHighlight&&t.onHighlight())):"vmouseout"===e.type?(t.highlight=!1,t.dragging||KhanUtil.dragging||(t.visibleShape.animate(t.normalStyle,50),t.onUnhighlight&&t.onUnhighlight())):"vmousedown"!==e.type||1!==e.which&&0!==e.which||(e.preventDefault(),t.grab())})}return t.moveTo=function(e,o,n){var i=KhanUtil.getDistance(this.graph.scalePoint([e,o]),this.graph.scalePoint(this.coord)),a=5*i,r=n&&function(e){t.coord=e,t.updateLineEnds()};this.visibleShape.animateTo([e,o],a,r),this.mouseTarget.animateTo([e,o],a,r),this.coord=[e,o],_.isFunction(this.onMove)&&this.onMove(e,o)},t.updateLineEnds=function(){$(this.lineStarts).each(function(){this.coordA=t.coord,this.transform()}),$(this.lineEnds).each(function(){this.coordZ=t.coord,this.transform()}),$(this.polygonVertices).each(function(){this.transform()})},t.setCoord=function(e){this.visible&&(this.visibleShape.moveTo(e),null!=this.mouseTarget&&this.mouseTarget.moveTo(e)),this.coord=e.slice()},t.setCoordConstrained=function(e){this.setCoord(i(e))},t.toBack=function(){this.visible&&(null!=this.mouseTarget&&this.mouseTarget.toBack(),this.visibleShape.toBack())},t.toFront=function(){this.visible&&(null!=this.mouseTarget&&this.mouseTarget.toFront(),this.visibleShape.toFront())},t.remove=function(){this.visibleShape&&this.visibleShape.remove(),this.mouseTarget&&this.mouseTarget.remove(),this.labeledVertex&&this.labeledVertex.remove()},t},addInteractiveFn:function(e,t){var o=this;t=$.extend({graph:o,snap:0,range:[o.range[0][0],o.range[0][1]]},t);var n={highlight:!1};o.style({stroke:KhanUtil.BLUE},function(){n.visibleShape=o.plot(e,t.range,t.swapAxes)}),o.style({fill:KhanUtil.BLUE,stroke:KhanUtil.BLUE},function(){n.cursorPoint=o.ellipse([0,e(0)],[4/o.scale[0],4/o.scale[1]])}),n.cursorPoint.attr("opacity",0);for(var i=30,a=[],r=(t.range[1]-t.range[0])/100,s=function(e,n){t.swapAxes?a.push([(n-o.range[0][0])*o.scale[0],(o.range[1][1]-e)*o.scale[1]]):a.push([(e-o.range[0][0])*o.scale[0],(o.range[1][1]-n)*o.scale[1]])},l=t.range[0];l<=t.range[1];l+=r){var c=(e(l-.001)-e(l+.001))/.002,d=l,h=e(l)+i/(2*o.scale[1]);if(0!==c){var u=-1/(c*(o.scale[1]/o.scale[0]))/(o.scale[1]/o.scale[0]);0>c?(d=l-Math.cos(-Math.atan(u*(o.scale[1]/o.scale[0])))*i/(2*o.scale[0]),h=u*(l-d)+e(l)):c>0&&(d=l+Math.cos(-Math.atan(u*(o.scale[1]/o.scale[0])))*i/(2*o.scale[0]),h=u*(l-d)+e(l))}s(d,h)}for(var l=t.range[1];l>=t.range[0];l-=r){var c=(e(l-.001)-e(l+.001))/.002,d=l,h=e(l)-i/(2*o.scale[1]);if(0!==c){var u=-1/(c*(o.scale[1]/o.scale[0]))/(o.scale[1]/o.scale[0]);0>c?(d=l+Math.cos(-Math.atan(u*(o.scale[1]/o.scale[0])))*i/(2*o.scale[0]),h=u*(l-d)+e(l)):c>0&&(d=l-Math.cos(-Math.atan(u*(o.scale[1]/o.scale[0])))*i/(2*o.scale[0]),h=u*(l-d)+e(l))}s(d,h)}return n.mouseTarget=o.mouselayer.path(KhanUtil.unscaledSvgPath(a)),n.mouseTarget.attr({fill:"#000",opacity:0}),$(n.mouseTarget[0]).bind("vmouseover vmouseout vmousemove",function(i){i.preventDefault();var a=i.pageX-$(o.raphael.canvas.parentNode).offset().left,r=i.pageY-$(o.raphael.canvas.parentNode).offset().top;a=Math.max(10,Math.min(o.xpixels-10,a)),r=Math.max(10,Math.min(o.ypixels-10,r)),t.snap&&(a=Math.round(a/(o.scale[0]*t.snap))*o.scale[0]*t.snap);var s=a/o.scale[0]+o.range[0][0],l=o.range[1][1]-r/o.scale[1],c=function(n,i){for(var a=0,r=Math.sqrt(n*n+i*i),s=t.range[0];s<t.range[1];s+=(t.range[1]-t.range[0])/o.xpixels)Math.sqrt((s-n)*(s-n)+(e(s)-i)*(e(s)-i))<r&&(a=s,r=Math.sqrt((s-n)*(s-n)+(e(s)-i)*(e(s)-i)));return a};if(t.swapAxes){var d=c(l,s);s=e(d),l=d}else{var d=c(s,l);s=d,l=e(d)}n.cursorPoint.attr("cx",(o.range[0][1]+s)*o.scale[0]),n.cursorPoint.attr("cy",(o.range[1][1]-l)*o.scale[1]),_.isFunction(n.onMove)&&n.onMove(s,l),"vmouseover"===i.type?(n.cursorPoint.animate({opacity:1},50),n.highlight=!0):"vmouseout"===i.type&&(n.highlight=!1,n.cursorPoint.animate({opacity:0},50),_.isFunction(n.onLeave)&&n.onLeave(s,l))}),n.mouseTarget.toBack(),n},addMovableLineSegment:function(e){var t=$.extend({graph:this,coordA:[0,0],coordZ:[1,1],snapX:0,snapY:0,fixed:!1,ticks:0,normalStyle:{},highlightStyle:{stroke:KhanUtil.INTERACTING,"stroke-width":6},labelStyle:{stroke:KhanUtil.INTERACTIVE,color:KhanUtil.INTERACTIVE},highlight:!1,dragging:!1,tick:[],extendLine:!1,extendRay:!1,constraints:{fixed:!1,constrainX:!1,constrainY:!1},sideLabel:"",vertexLabels:[],numArrows:0,numTicks:0,movePointsWithLine:!1},e),o=t.fixed?KhanUtil.DYNAMIC:KhanUtil.INTERACTIVE;t.normalStyle=_.extend({},{"stroke-width":2,stroke:o},e.normalStyle),t.arrowStyle=_.extend({},t.normalStyle,{color:t.normalStyle.stroke}),void 0!==e.pointA?(t.coordA=e.pointA.coord,t.pointA.lineStarts.push(t)):void 0!==e.coordA&&(t.coordA=e.coordA.slice()),void 0!==e.pointZ?(t.coordZ=e.pointZ.coord,t.pointZ.lineEnds.push(t)):void 0!==e.coordA&&(t.coordA=t.coordA.slice());var n=t.graph;n.style(t.normalStyle);for(var i=0;i<t.ticks;++i)t.tick[i]=KhanUtil.bogusShape;for(var a=KhanUtil.unscaledSvgPath([[0,0],[1,0]]),i=0;i<t.ticks;++i){var r=.5-(t.ticks-1+2*i)/n.scale[0];a+=KhanUtil.unscaledSvgPath([[r,-7],[r,7]])}var e={thickness:Math.max(t.normalStyle["stroke-width"],t.highlightStyle["stroke-width"])};if(t.visibleLine=new WrappedLine(n,[0,0],[1,0],e),t.visibleLine.attr(t.normalStyle),!t.fixed){var e={thickness:30,mouselayer:!0};t.mouseTarget=new WrappedLine(n,[0,0],[1,0],e),t.mouseTarget.attr({fill:"#000",opacity:0})}if(t.transform=function(e){e&&("object"==typeof this.pointA&&(this.coordA=this.pointA.coord),"object"==typeof this.pointZ&&(this.coordZ=this.pointZ.coord));var o=function(e){var t=e.graph.scalePoint(e.coordA),o=e.graph.scalePoint(e.coordZ);return kvector.polarDegFromCart(kvector.subtract(o,t))[1]},i=function(e,o,n){var e=t.graph,i=e.range[0][1]-e.range[0][0],a=e.range[1][1]-e.range[1][0],r=i+a,s=e.unscaleVector(kvector.cartFromPolarDeg([1,n])),l=kvector.scale(kvector.normalize(s),r),c=kvector.add(o,l),d=kvector.polarDegFromCart(s)[1],h=e.constrainToBoundsOnAngle(c,4,d*Math.PI/180);return h},a=o(this),r=this.coordA,s=this.coordZ;this.extendLine?(r=i(n,r,360-a),s=i(n,s,(540-a)%360)):this.extendRay&&(s=i(n,r,360-a));var l=[this.visibleLine];this.fixed||l.push(this.mouseTarget),_.each(l,function(e){e.moveTo(r,s)});var c=function(e,t){var o=[.75,0],n=[[-3,4],[-2.75,2.5],[0,.25],o,[0,-.25],[-2.75,-2.5],[-3,-4]],a=1.4;n=_.map(n,function(e){var t=kvector.subtract(e,o),n=kvector.scale(t,a);return kvector.add(o,n)});var r=function(e){for(var t="M"+e[0][0]+" "+e[0][1],o=1;o<e.length;o+=3)t+="C"+e[o][0]+" "+e[o][1]+" "+e[o+1][0]+" "+e[o+1][1]+" "+e[o+2][0]+" "+e[o+2][1];return t},s=_.map(n,e.unscalePoint),l={center:e.unscalePoint(o),createPath:r},c=new WrappedPath(e,s,l);return c.attr(_.extend({"stroke-linejoin":"round","stroke-linecap":"round","stroke-dasharray":""},t)),c.toCoordAtAngle=function(t,n){var r=e.scalePoint(i(e,t,n)),s=KhanUtil.getCanUse3dTransform();c.transform("translateX("+(r[0]+a*o[0])+"px) translateY("+(r[1]+a*o[1])+"px) "+(s?"translateZ(0) ":"")+"rotate("+(360-KhanUtil.bound(n))+"deg)")},c};null==this._arrows&&(this._arrows=[],this.extendLine?(this._arrows.push(c(n,this.normalStyle)),this._arrows.push(c(n,this.normalStyle))):this.extendRay&&this._arrows.push(c(n,this.normalStyle)));var d=[this.coordA,this.coordZ],h=[360-a,(540-a)%360];_.each(this._arrows,function(e,t){e.toCoordAtAngle(d[t],h[t])}),_.invoke(this.temp,"remove"),this.temp=[];var u=this.coordA[0]<this.coordZ[0]||this.coordA[0]===this.coordZ[0]&&this.coordA[1]>this.coordZ[1];this.sideLabel&&this.temp.push(this.graph.labelSide({point1:this.coordA,point2:this.coordZ,label:this.labeledSide,text:this.sideLabel,numArrows:this.numArrows,numTicks:this.numTicks,clockwise:u,style:this.labelStyle})),this.vertexLabels.length&&(this.graph.labelVertex({vertex:this.coordA,point3:this.coordZ,label:this.labeledVertices[0],text:this.vertexLabels[0],clockwise:u,style:this.labelStyle}),this.graph.labelVertex({point1:this.coordA,vertex:this.coordZ,label:this.labeledVertices[1],text:this.vertexLabels[1],clockwise:u,style:this.labelStyle})),this.temp=_.flatten(this.temp)},t.toBack=function(){t.fixed||t.mouseTarget.toBack(),t.visibleLine.toBack()},t.toFront=function(){t.fixed||t.mouseTarget.toFront(),t.visibleLine.toFront()},t.remove=function(){t.fixed||t.mouseTarget.remove(),t.visibleLine.remove(),t.labeledSide&&t.labeledSide.remove(),t.labeledVertices&&_.invoke(t.labeledVertices,"remove"),t._arrows&&_.invoke(t._arrows,"remove"),t.temp.length&&_.invoke(t.temp,"remove")},t.hide=function(){t.visibleLine.hide(),t.temp.length&&_.invoke(t.temp,"hide"),t._arrows&&_.invoke(t._arrows,"hide")},t.show=function(){t.visibleLine.show(),t.temp.length&&_.invoke(t.temp,"show"),t._arrows&&_.invoke(t._arrows,"show")},t.sideLabel&&(t.labeledSide=this.label([0,0],"","center",t.labelStyle)),t.vertexLabels.length&&(t.labeledVertices=_.map(t.vertexLabels,function(e){return this.label([0,0],"","center",t.labelStyle)},this)),!t.fixed&&!t.constraints.fixed){var s=$(t.mouseTarget.getMouseTarget());s.css("cursor","move"),s.bind("vmousedown vmouseover vmouseout",function(e){if("vmouseover"===e.type)KhanUtil.dragging||(t.highlight=!0,t.visibleLine.animate(t.highlightStyle,50),t.arrowStyle=_.extend({},t.arrowStyle,{color:t.highlightStyle.stroke,stroke:t.highlightStyle.stroke}),t.transform());else if("vmouseout"===e.type)t.highlight=!1,t.dragging||(t.visibleLine.animate(t.normalStyle,50),t.arrowStyle=_.extend({},t.arrowStyle,{color:t.normalStyle.stroke,stroke:t.normalStyle.stroke}),t.transform());else if("vmousedown"===e.type&&(1===e.which||0===e.which)){e.preventDefault();var o=(e.pageX-$(n.raphael.canvas.parentNode).offset().left)/n.scale[0]+n.range[0][0],i=n.range[1][1]-(e.pageY-$(n.raphael.canvas.parentNode).offset().top)/n.scale[1];t.snapX>0&&(o=Math.round(o/t.snapX)*t.snapX),t.snapY>0&&(i=Math.round(i/t.snapY)*t.snapY);var a=[t.coordA[0]-o,t.coordA[1]-i],r=[t.coordZ[0]-o,t.coordZ[1]-i],s=-Math.min(n.scaleVector(a)[0],n.scaleVector(r)[0]),l=Math.max(n.scaleVector(a)[0],n.scaleVector(r)[0]),c=Math.max(n.scaleVector(a)[1],n.scaleVector(r)[1]),d=-Math.min(n.scaleVector(a)[1],n.scaleVector(r)[1]);$(document).bind("vmousemove.lineSegment vmouseup.lineSegment",function(e){e.preventDefault(),t.dragging=!0,KhanUtil.dragging=!0;var o=e.pageX-$(n.raphael.canvas.parentNode).offset().left,i=e.pageY-$(n.raphael.canvas.parentNode).offset().top;o=Math.max(s+10,Math.min(n.xpixels-10-l,o)),i=Math.max(c+10,Math.min(n.ypixels-10-d,i));var h=o/n.scale[0]+n.range[0][0],u=n.range[1][1]-i/n.scale[1];if(t.snapX>0&&(h=Math.round(h/t.snapX)*t.snapX),t.snapY>0&&(u=Math.round(u/t.snapY)*t.snapY),"vmousemove"===e.type){t.constraints.constrainX&&(h=t.coordA[0]-a[0]),t.constraints.constrainY&&(u=t.coordA[1]-a[1]);var p=h+a[0]-t.coordA[0],v=u+a[1]-t.coordA[1];t.coordA=[h+a[0],u+a[1]],t.coordZ=[h+r[0],u+r[1]],t.transform(),t.movePointsWithLine&&("object"==typeof t.pointA&&t.pointA.setCoord([t.pointA.coord[0]+p,t.pointA.coord[1]+v]),"object"==typeof t.pointZ&&t.pointZ.setCoord([t.pointZ.coord[0]+p,t.pointZ.coord[1]+v])),
_.isFunction(t.onMove)&&t.onMove(p,v)}else"vmouseup"===e.type&&($(document).unbind(".lineSegment"),t.dragging=!1,KhanUtil.dragging=!1,t.highlight||(t.visibleLine.animate(t.normalStyle,50),t.arrowStyle=_.extend({},t.arrowStyle,{color:t.normalStyle.stroke,stroke:t.normalStyle.stroke}),t.transform()),_.isFunction(t.onMoveEnd)&&t.onMoveEnd());$(t).trigger("move")})}})}return void 0!==t.pointA&&t.pointA.toFront(),void 0!==t.pointZ&&t.pointZ.toFront(),t.transform(),t},addMovablePolygon:function(e){var t=this,o=$.extend({snapX:0,snapY:0,fixed:!1,constrainToGraph:!0,normalStyle:{},highlightStyle:{stroke:KhanUtil.INTERACTING,"stroke-width":2,fill:KhanUtil.INTERACTING,"fill-opacity":.05},pointHighlightStyle:{fill:KhanUtil.INTERACTING,stroke:KhanUtil.INTERACTING},labelStyle:{stroke:KhanUtil.DYNAMIC,"stroke-width":1,color:KhanUtil.DYNAMIC},angleLabels:[],showRightAngleMarkers:[],sideLabels:[],vertexLabels:[],numArcs:[],numArrows:[],numTicks:[],updateOnPointMove:!0,closed:!0},_.omit(e,"points")),n=o.fixed?KhanUtil.DYNAMIC:KhanUtil.INTERACTIVE;o.normalStyle=_.extend({"stroke-width":2,"fill-opacity":0,fill:n,stroke:n},e.normalStyle),o.points=e.points;var i=function(e){return!_.isArray(e)};return o.update=function(){var e=o.points.length;o.coords=_.map(o.points,function(e,t){return i(e)?e.coord:e}),o.left=_.min(_.pluck(o.coords,0)),o.right=_.max(_.pluck(o.coords,0)),o.top=_.max(_.pluck(o.coords,1)),o.bottom=_.min(_.pluck(o.coords,1));var n=_.map(o.coords,function(e){return t.scalePoint(e)});o.closed?n.push(!0):n=n.concat(_.clone(n).reverse()),o.path=KhanUtil.unscaledSvgPath(n),_.invoke(o.temp,"remove"),o.temp=[];var a=clockwise(o.coords);(o.angleLabels.length||o.showRightAngleMarkers.length)&&_.each(o.labeledAngles,function(n,i){o.temp.push(t.labelAngle({point1:o.coords[(i-1+e)%e],vertex:o.coords[i],point3:o.coords[(i+1)%e],label:n,text:o.angleLabels[i],showRightAngleMarker:o.showRightAngleMarkers[i],numArcs:o.numArcs[i],clockwise:a,style:o.labelStyle}))}),o.sideLabels.length&&_.each(o.labeledSides,function(n,i){o.temp.push(t.labelSide({point1:o.coords[i],point2:o.coords[(i+1)%e],label:n,text:o.sideLabels[i],numArrows:o.numArrows[i],numTicks:o.numTicks[i],clockwise:a,style:o.labelStyle}))}),o.vertexLabels.length&&_.each(o.labeledVertices,function(n,i){t.labelVertex({point1:o.coords[(i-1+e)%e],vertex:o.coords[i],point3:o.coords[(i+1)%e],label:n,text:o.vertexLabels[i],clockwise:a,style:o.labelStyle})}),o.temp=_.flatten(o.temp)},o.transform=function(){o.update(),o.visibleShape.attr({path:o.path}),o.fixed||o.mouseTarget.attr({path:o.path})},o.remove=function(){o.visibleShape.remove(),o.fixed||o.mouseTarget.remove(),o.labeledAngles&&_.invoke(o.labeledAngles,"remove"),o.labeledSides&&_.invoke(o.labeledSides,"remove"),o.labeledVertices&&_.invoke(o.labeledVertices,"remove"),o.temp.length&&_.invoke(o.temp,"remove")},o.toBack=function(){o.fixed||o.mouseTarget.toBack(),o.visibleShape.toBack()},o.toFront=function(){o.fixed||o.mouseTarget.toFront(),o.visibleShape.toFront()},o.updateOnPointMove&&_.each(_.filter(o.points,i),function(e){e.polygonVertices.push(o)}),o.coords=new Array(o.points.length),o.angleLabels.length&&(o.labeledAngles=_.times(Math.max(o.angleLabels.length,o.showRightAngleMarkers.length),function(){return this.label([0,0],"","center",o.labelStyle)},this)),o.sideLabels.length&&(o.labeledSides=_.map(o.sideLabels,function(e){return this.label([0,0],"","center",o.labelStyle)},this)),o.vertexLabels.length&&(o.labeledVertices=_.map(o.vertexLabels,function(e){return this.label([0,0],"","center",o.labelStyle)},this)),o.update(),o.visibleShape=t.raphael.path(o.path),o.visibleShape.attr(o.normalStyle),o.fixed||(o.mouseTarget=t.mouselayer.path(o.path),o.mouseTarget.attr({fill:"#000",opacity:0,cursor:"move"}),$(o.mouseTarget[0]).bind("vmousedown vmouseover vmouseout",function(e){if("vmouseover"===e.type)(!KhanUtil.dragging||o.dragging)&&(o.highlight=!0,o.visibleShape.animate(o.highlightStyle,50),_.each(_.filter(o.points,i),function(e){e.visibleShape.animate(o.pointHighlightStyle,50)}));else if("vmouseout"===e.type){if(o.highlight=!1,!o.dragging){o.visibleShape.animate(o.normalStyle,50);var n=_.filter(o.points,i);_.any(_.pluck(n,"dragging"))||_.each(n,function(e){e.visibleShape.animate(e.normalStyle,50)})}}else if("vmousedown"===e.type&&(1===e.which||0===e.which)){e.preventDefault(),_.each(_.filter(o.points,i),function(e){e.dragging=!0});var a=(e.pageX-$(t.raphael.canvas.parentNode).offset().left)/t.scale[0]+t.range[0][0],r=t.range[1][1]-(e.pageY-$(t.raphael.canvas.parentNode).offset().top)/t.scale[1];o.snapX>0&&(a=Math.round(a/o.snapX)*o.snapX),o.snapY>0&&(r=Math.round(r/o.snapY)*o.snapY);var s=a,l=r,c=o.coords.slice(),d=(a-o.left)*t.scale[0],h=(o.right-a)*t.scale[0],u=(o.top-r)*t.scale[1],p=(r-o.bottom)*t.scale[1];$(document).bind("vmousemove.polygon vmouseup.polygon",function(e){e.preventDefault(),o.dragging=!0,KhanUtil.dragging=!0;var n=e.pageX-$(t.raphael.canvas.parentNode).offset().left,v=e.pageY-$(t.raphael.canvas.parentNode).offset().top;o.constrainToGraph&&(n=Math.max(d+10,Math.min(t.xpixels-10-h,n)),v=Math.max(u+10,Math.min(t.ypixels-10-p,v)));var g=n/t.scale[0]+t.range[0][0],f=t.range[1][1]-v/t.scale[1];if(o.snapX>0&&(g=Math.round(g/o.snapX)*o.snapX),o.snapY>0&&(f=Math.round(f/o.snapY)*o.snapY),"vmousemove"===e.type){var m=g-a,y=f-r,b=!0;if(_.isFunction(o.onMove)){var x=o.onMove(m,y);x===!1?b=!1:_.isArray(x)&&(m=x[0],y=x[1],g=a+m,f=r+y)}var k=function(e){return[c[e][0]+m,c[e][1]+y]};b&&(_.each(o.points,function(e,t){i(e)?e.setCoord(k(t)):o.points[t]=k(t)}),o.transform(),$(o).trigger("move"),s=g,l=f)}else if("vmouseup"===e.type){$(document).unbind(".polygon");var M=_.filter(o.points,i);_.each(M,function(e){e.dragging=!1}),o.dragging=!1,KhanUtil.dragging=!1,o.highlight||(o.visibleShape.animate(o.normalStyle,50),_.each(M,function(e){e.visibleShape.animate(e.normalStyle,50)})),_.isFunction(o.onMoveEnd)&&o.onMoveEnd(s-a,l-r)}})}})),_.invoke(_.filter(o.points,i),"toFront"),o},constrainToBounds:function(e,t){var o=this.unscalePoint([t,this.ypixels-t]),n=this.unscalePoint([this.xpixels-t,t]),i=Math.max(o[0],Math.min(n[0],e[0])),a=Math.max(o[1],Math.min(n[1],e[1]));return[i,a]},constrainToBoundsOnAngle:function(e,t,o){var n=this.unscalePoint([t,this.ypixels-t]),i=this.unscalePoint([this.xpixels-t,t]),a=e.slice();return a[0]<n[0]?a=[n[0],a[1]+(n[0]-a[0])*Math.tan(o)]:a[0]>i[0]&&(a=[i[0],a[1]-(a[0]-i[0])*Math.tan(o)]),a[1]<n[1]?a=[a[0]+(n[1]-a[1])/Math.tan(o),n[1]]:a[1]>i[1]&&(a=[a[0]-(a[1]-i[1])/Math.tan(o),i[1]]),a},addMovableAngle:function(e){return new MovableAngle(this,e)},addArrowWidget:function(e){var t=$.extend({graph:this,direction:"up",coord:[0,0],onClick:function(){}},e),o=t.graph;return"up"===t.direction?t.visibleShape=o.path([[t.coord[0],t.coord[1]-4/o.scale[1]],[t.coord[0]-4/o.scale[0],t.coord[1]-4/o.scale[1]],[t.coord[0],t.coord[1]+4/o.scale[1]],[t.coord[0]+4/o.scale[0],t.coord[1]-4/o.scale[1]],[t.coord[0],t.coord[1]-4/o.scale[1]]],{stroke:"",fill:KhanUtil.INTERACTIVE}):"down"===t.direction&&(t.visibleShape=o.path([[t.coord[0],t.coord[1]+4/o.scale[1]],[t.coord[0]-4/o.scale[0],t.coord[1]+4/o.scale[1]],[t.coord[0],t.coord[1]-4/o.scale[1]],[t.coord[0]+4/o.scale[0],t.coord[1]+4/o.scale[1]],[t.coord[0],t.coord[1]+4/o.scale[1]]],{stroke:"",fill:KhanUtil.INTERACTIVE})),_.defer(function(){t.visibleShape.attr({stroke:"",fill:KhanUtil.INTERACTIVE})}),t.mouseTarget=o.mouselayer.circle(o.scalePoint(t.coord)[0],o.scalePoint(t.coord)[1],15),t.mouseTarget.attr({fill:"#000",opacity:0}),$(t.mouseTarget[0]).css("cursor","pointer"),$(t.mouseTarget[0]).bind("vmousedown vmouseover vmouseout",function(e){if("vmouseover"===e.type)t.visibleShape.animate({scale:2,fill:KhanUtil.INTERACTING},20);else if("vmouseout"===e.type)t.visibleShape.animate({scale:1,fill:KhanUtil.INTERACTING},20);else if("vmousedown"===e.type&&(1===e.which||0===e.which))return t.hidden||t.onClick(),!1}),t.hide=function(){t.visibleShape.hide(),t.hidden=!0,$(t.mouseTarget[0]).css("cursor","default")},t.show=function(){t.visibleShape.show(),t.hidden=!1,$(t.mouseTarget[0]).css("cursor","pointer")},t},addRectGraph:function(e){function t(e,t,o,n){a.points[o].setCoord([e,a.points[o].coord[1]]),a.points[n].setCoord([a.points[n].coord[0],t]),a.points[o].updateLineEnds(),a.points[n].updateLineEnds()}function o(e,t,o){return o?e>t:t>e}function n(e,t,n){var i=a.getXLims(),r=a.getYLims(),s=c[e],l=o(i[s[0]],t,1===s[0]),d=o(r[s[1]],n,1===s[1]);return l&&d}function i(e,t){var o=a.constraints.constrainX,n=a.getX()+e<a.constraints.xmin,i=a.getX2()+e>a.constraints.xmax,r=a.constraints.constrainY,s=a.getY()+t<a.constraints.ymin,l=a.getY2()+t>a.constraints.ymax;return e=o||n||i?0:e,t=r||s||l?0:t,[e,t]}var a=$.extend(!0,{x:0,y:0,width:1,height:1,normalStyle:{points:{stroke:KhanUtil.INTERACTIVE,fill:KhanUtil.INTERACTIVE,opacity:1},edges:{stroke:KhanUtil.INTERACTIVE,opacity:1,"stroke-width":1},area:{fill:KhanUtil.INTERACTIVE,"fill-opacity":.1,"stroke-width":0}},hoverStyle:{points:{color:KhanUtil.INTERACTING,opacity:1,width:2},edges:{stroke:KhanUtil.INTERACTING,opacity:1,"stroke-width":1},area:{fill:KhanUtil.INTERACTING,"fill-opacity":.2,"stroke-width":0}},fixed:{edges:[!1,!1,!1,!1],points:[!1,!1,!1,!1]},constraints:{constrainX:!1,constrainY:!1,xmin:null,xmax:null,ymin:null,ymax:null},snapX:0,snapY:0,onMove:function(){}},e);a=$.extend({initialized:function(){return a.points&&a.points.length},x2:function(){return this.x+this.width},y2:function(){return this.y+this.height},getX:function(){return a.initialized()?a.points[0].coord[0]:a.x},getY:function(){return a.initialized()?a.points[0].coord[1]:a.y},getX2:function(){return a.getX()+a.getWidth()},getY2:function(){return a.getY()+a.getHeight()},getXLims:function(){var e=a.getX();return[e,e+a.getWidth()]},getYLims:function(){var e=a.getY();return[e,e+a.getHeight()]},getWidth:function(){if(a.initialized()){var e=a.points[1].coord[0],t=a.points[2].coord[0];return t-e}return a.width},getHeight:function(){if(a.initialized()){var e=a.points[0].coord[1],t=a.points[1].coord[1];return t-e}return a.height},getCoord:function(){return[a.getX(),a.getY()]},getRaphaelParamsArr:function(){var e=a.getWidth(),t=a.getHeight(),o=a.getX(),n=a.getY(),i=r.scalePoint([o,n+t]),s=r.scaleVector([e,t]);return i.concat(s)},getRaphaelParams:function(){var e=a.getRaphaelParamsArr();return{x:e[0],y:e[1],width:e[2],height:e[3]}}},a);var r=this;a.fillArea=r.rect().attr(a.normalStyle.area),a.mouseTarget=r.mouselayer.rect().attr({fill:"#000",opacity:0,"fill-opacity":0}),a.render=function(){a.fillArea.attr(a.getRaphaelParams()),a.mouseTarget.attr(a.getRaphaelParams())},a.render(),a.points=[];var s=[[a.x,a.y],[a.x,a.y2()],[a.x2(),a.y2()],[a.x2(),a.y]],l=[[1,3],[0,2],[3,1],[2,0]],c=[[1,1],[1,0],[0,0],[0,1]];_.times(4,function(e){var o=l[e][0],i=l[e][1],c=s[e],d=r.addMovablePoint({graph:r,coord:c,normalStyle:a.normalStyle.points,hoverStyle:a.hoverStyle.points,snapX:a.snapX,snapY:a.snapY,visible:!a.fixed.points[e],constraints:{fixed:a.fixed.points[e]},onMove:function(r,s){return n(e,r,s)?(t(r,s,o,i),void a.render()):!1}});a.points.push(d)}),a.edges=[],a.moveEdge=function(e,t,o){var n=a.edges[o].pointA,i=a.edges[o].pointZ;n.setCoord([n.coord[0]+e,n.coord[1]+t]),i.setCoord([i.coord[0]+e,i.coord[1]+t]),n.updateLineEnds(),i.updateLineEnds()},_.times(4,function(e){var t=a.points[e],o=a.points[(e+1)%4],n=e%2,i=(e+1)%2,s=r.addMovableLineSegment({graph:r,pointA:t,pointZ:o,normalStyle:a.normalStyle.edges,hoverStyle:a.hoverStyle.edges,snapX:a.snapX,snapY:a.snapY,fixed:a.fixed.edges[e],constraints:{constrainX:n,constrainY:i},onMove:function(t,o){a.moveEdge(t,o,e),a.render()}});a.edges.push(s)});var d=[a.fillArea,a.mouseTarget];a.elems=d.concat(a.edges).concat(a.points),a.translate=function(e,t){if(!a.constraints.constrainX||!a.constraints.constrainY){var o=i(e,t);e=o[0],t=o[1],_.each(a.points,function(o,n){var i=o.coord[0]+e,a=o.coord[1]+t;o.setCoord([i,a]),o.updateLineEnds()}),a.render(),a.onMove(e,t)}},a.moveTo=function(e,t){var o=e-a.getX(),n=t-a.getY();a.translate(o,n)},a.snap=function(){var e,t;_.each(a.points,function(o,n){var i=o.coord[0],r=o.coord[1],s=i,l=r;a.snapX&&(s=KhanUtil.roundToNearest(a.snapX,i)),a.snapY&&(l=KhanUtil.roundToNearest(a.snapY,r)),e&&t||(e=s-i,t=l-r),o.setCoord([s,l]),o.updateLineEnds()}),a.render(),a.onMove(e,t)},a.toFront=function(){_.each(a.elems,function(e){e.toFront()})},a.hide=function(e){a.hidden||(e=e||100,a.fillArea.animate({"fill-opacity":0},e),$(a.mouseTarget[0]).css("display","none"),a.hidden=!0)},a.show=function(e){a.hidden&&(e=e||100,a.fillArea.animate(a.normalStyle.area,e),$(a.mouseTarget[0]).css("display","block"),a.hidden=!1)},a.enableHoverStyle=function(){a.highlight=!0,KhanUtil.dragging||a.fillArea.animate(a.hoverStyle.area,100)},a.enableNormalStyle=function(){a.highlight=!1,a.dragging||a.fillArea.animate(a.normalStyle.area,100)};var h=function(){$(a.mouseTarget[0]).css("cursor","move"),$(a.mouseTarget[0]).on("vmouseover vmouseout vmousedown",function(e){"vmouseover"===e.type?a.enableHoverStyle():"vmouseout"===e.type?a.enableNormalStyle():"vmousedown"!==e.type||1!==e.which&&0!==e.which||(e.preventDefault(),a.toFront(),a.prevCoord=r.getMouseCoord(e),a.enableHoverStyle(),$(document).on("vmousemove vmouseup",function(e){if(e.preventDefault(),a.dragging=!0,KhanUtil.dragging=!0,"vmousemove"===e.type){var t=r.getMouseCoord(e);if(a.prevCoord&&2===a.prevCoord.length){var o=KhanUtil.coordDiff(a.prevCoord,t);a.translate(o[0],o[1])}a.prevCoord=t}else if("vmouseup"===e.type){$(document).off("vmousemove vmouseup"),a.dragging=!1,KhanUtil.dragging=!1;var t=r.getMouseCoord(e);(t[0]<a.getX()||t[0]>a.getX2()||t[1]<a.getY()||t[1]>a.getY2())&&a.enableNormalStyle(),a.snap()}}))})};return h(),a},addCircleGraph:function(e){var t=this,o=$.extend({center:[0,0],radius:2,snapX:.5,snapY:.5,snapRadius:.5,minRadius:1,centerConstraints:{},centerNormalStyle:{},centerHighlightStyle:{stroke:KhanUtil.INTERACTING,fill:KhanUtil.INTERACTING},circleNormalStyle:{stroke:KhanUtil.INTERACTIVE,"fill-opacity":0},circleHighlightStyle:{stroke:KhanUtil.INTERACTING,fill:KhanUtil.INTERACTING,"fill-opacity":.05}},e),n=o.centerConstraints.fixed?KhanUtil.DYNAMIC:KhanUtil.INTERACTIVE,i=e?e.centerNormalStyle:null;return o.centerNormalStyle=_.extend({},{fill:n,stroke:n},i),o.centerPoint=t.addMovablePoint({graph:t,coord:o.center,normalStyle:o.centerNormalStyle,snapX:o.snapX,snapY:o.snapY,constraints:o.centerConstraints}),o.circ=t.circle(o.center,o.radius,o.circleNormalStyle),o.perim=t.mouselayer.circle(t.scalePoint(o.center)[0],t.scalePoint(o.center)[1],t.scaleVector(o.radius)[0]).attr({"stroke-width":20,opacity:.002}),o.centerConstraints.fixed||$(o.centerPoint.mouseTarget.getMouseTarget()).on("vmouseover vmouseout",function(e){o.centerPoint.highlight||o.centerPoint.dragging?o.circ.animate(o.circleHighlightStyle,50):o.circ.animate(o.circleNormalStyle,50)}),o.toFront=function(){o.circ.toFront(),o.perim.toFront(),o.centerPoint.visibleShape.toFront(),o.centerConstraints.fixed||o.centerPoint.mouseTarget.toFront()},o.centerPoint.onMove=function(e,n){o.toFront(),o.circ.attr({cx:t.scalePoint(e)[0],cy:t.scalePoint(n)[1]}),o.perim.attr({cx:t.scalePoint(e)[0],cy:t.scalePoint(n)[1]}),o.onMove&&o.onMove(e,n)},$(o.centerPoint).on("move",function(){o.center=this.coord,$(o).trigger("move")}),o.setCenter=function(e,t){o.centerPoint.setCoord([e,t]),o.centerPoint.onMove(e,t),o.center=[e,t]},o.setRadius=function(e){o.radius=e,o.perim.attr({r:t.scaleVector(e)[0]}),o.circ.attr({rx:t.scaleVector(e)[0],ry:t.scaleVector(e)[1]})},o.remove=function(){o.centerPoint.remove(),o.circ.remove(),o.perim.remove()},$(o.perim[0]).css("cursor","move"),$(o.perim[0]).on("vmouseover vmouseout vmousedown",function(e){if("vmouseover"===e.type)o.highlight=!0,KhanUtil.dragging||(o.circ.animate(o.circleHighlightStyle,50),o.centerPoint.visibleShape.animate(o.centerHighlightStyle,50));else if("vmouseout"===e.type)o.highlight=!1,o.dragging||o.centerPoint.dragging||(o.circ.animate(o.circleNormalStyle,50),o.centerPoint.visibleShape.animate(o.centerNormalStyle,50));else if("vmousedown"===e.type&&(1===e.which||0===e.which)){e.preventDefault(),o.toFront();var n=o.radius;$(document).on("vmousemove vmouseup",function(e){if(e.preventDefault(),o.dragging=!0,KhanUtil.dragging=!0,"vmousemove"===e.type){var i=t.constrainToBounds(t.getMouseCoord(e),10),a=KhanUtil.getDistance(o.centerPoint.coord,i);a=Math.max(o.minRadius,Math.round(a/o.snapRadius)*o.snapRadius);var r=o.radius,s=!0;if(o.onResize){var l=o.onResize(a,r);_.isNumber(l)?a=l:l===!1&&(s=!1)}s&&(o.setRadius(a),$(o).trigger("move"))}else"vmouseup"===e.type&&($(document).off("vmousemove vmouseup"),o.dragging=!1,KhanUtil.dragging=!1,o.onResizeEnd&&o.onResizeEnd(o.radius,n))})}}),o},interactiveEllipse:function(e){var t=this,o=$.extend({center:[0,0],radius:2,xRadius:2,yRadius:2,ellipseNormalStyle:{stroke:KhanUtil.BLUE,"fill-opacity":0},ellipseBoundaryHideStyle:{"fill-opacity":0,"stroke-width":0},ellipseBoundaryShowStyle:{"fill-opacity":1,fill:KhanUtil.BLUE},onMove:function(e,t){},onLeave:function(e,t){}},e);return o.circ=t.ellipse(o.center,[o.xRadius,o.yRadius],o.ellipseNormalStyle),o.perim=t.mouselayer.ellipse(t.scalePoint(o.center)[0],t.scalePoint(o.center)[1],t.scaleVector(o.xRadius)[0],t.scaleVector(o.yRadius)[0]).attr({"stroke-width":30,opacity:.002}),o.boundaryPoint=t.circle(o.center,.4,o.ellipseBoundaryHideStyle),o.remove=function(){o.circ.remove(),o.perim.remove()},o.showPoint=function(e){var n=t.constrainToBounds(t.getMouseCoord(e),10),i=o.yRadius*(o.center[0]-n[0]),a=o.xRadius*(o.center[1]-n[1]),r=Math.atan2(a,i);n[0]=o.center[0]-o.xRadius*Math.cos(r),n[1]=o.center[1]-o.yRadius*Math.sin(r);var s=t.scalePoint(n);o.boundaryPoint.attr({cx:s[0]}),o.boundaryPoint.attr({cy:s[1]}),o.boundaryPoint.animate(o.ellipseBoundaryShowStyle,50),o.onMove(n[0],n[1])},$(o.perim[0]).on("vmouseover vmouseout vmousemove",function(e){"vmouseover"===e.type?o.showPoint(e):"vmouseout"===e.type?(o.boundaryPoint.animate(o.ellipseBoundaryHideStyle,50),o.onLeave()):"vmousemove"===e.type&&o.showPoint(e)}),o},addRotateHandle:function(){var e=function(e,t,o,n,i,a,r){var s=function(n,i){var r=o+i,s=KhanUtil.kvector.cartFromPolarDeg([r,a+n]),l=KhanUtil.kvector.add(t,s),c=e.scalePoint(l);return c[0]+","+c[1]},l=e.scaleVector(o-n),c=e.scaleVector(o+n);return e.raphael.path(" M"+s(i,-n)+" L"+s(i,-3*n)+" L"+s(2*i,0)+" L"+s(i,3*n)+" L"+s(i,n)+" A"+c[0]+","+c[1]+",0,0,1,"+s(-i,n)+" L"+s(-i,3*n)+" L"+s(-2*i,0)+" L"+s(-i,-3*n)+" L"+s(-i,-n)+" A"+l[0]+","+l[1]+",0,0,0,"+s(i,-n)+" Z").attr({stroke:null,fill:r?KhanUtil.INTERACTING:KhanUtil.INTERACTIVE})};return function(t){var o=this,n=t.center,i=t.radius,a=t.lengthAngle||30,r=t.hideArrow||!1,s=t.mouseTarget,l=_.uniqueId("rotateHandle");_.isArray(n)&&(n={coord:n});var c=o.addMovablePoint({coord:KhanUtil.kpoint.addVector(n.coord,KhanUtil.kvector.cartFromPolarDeg(i,t.angleDeg||0)),constraints:{fixedDistance:{dist:i,point:n}},mouseTarget:s});n.toFront();var d,h=n.coord,u=c.coord,p=u,v=!1,g=!1,f=function(i){if(!r){var s=KhanUtil.kvector.subtract(i,n.coord),l=KhanUtil.kvector.polarDegFromCart(s),c=l[1];d&&d.remove(),d=e(o,n.coord,t.radius,v||g?t.hoverWidth/2:t.width/2,a,c,v||g)}};$(n).on("move."+l,function(){var e=KhanUtil.kvector.subtract(n.coord,h);c.setCoord(KhanUtil.kvector.add(c.coord,e)),f(c.coord),h=n.coord,c.constraints.fixedDistance.point=n,u=c.coord}),c.onMove=function(e,o){v||(p=u,v=!0);var i=[e,o];if(t.onMove){var a=KhanUtil.kvector.polarDegFromCart(KhanUtil.kvector.subtract(u,n.coord)),r=KhanUtil.kvector.polarDegFromCart(KhanUtil.kvector.subtract(i,n.coord)),s=a[1],l=r[1],c=t.onMove(l,s);null!=c&&c!==!0&&(c===!1&&(c=s),i=KhanUtil.kvector.add(n.coord,KhanUtil.kvector.cartFromPolarDeg([a[0],c])))}return f(i),u=i,i},c.onMoveEnd=function(){if(v=!1,f(c.coord),t.onMoveEnd){var e=KhanUtil.kvector.polarDegFromCart(KhanUtil.kvector.subtract(p,n.coord)),o=KhanUtil.kvector.polarDegFromCart(KhanUtil.kvector.subtract(c.coord,n.coord));t.onMoveEnd(o[1],e[1])}},c.visibleShape.remove(),s||c.mouseTarget.attr({scale:2});var m=$(c.mouseTarget.getMouseTarget());m.bind("vmouseover",function(e){g=!0,f(c.coord)}),m.bind("vmouseout",function(e){g=!1,f(c.coord)}),f(c.coord);var y=c.remove;return c.remove=function(){y.call(c),d&&d.remove(),$(n).off("move."+l)},c.update=function(){f(c.coord)},c}}(),addReflectButton:function(){var e=function(e,t,o,n,i,a,r){kpoint.equal(o[0],o[1])&&(o=[o[0],kpoint.addVector(o[0],[1,1])]);var s=kvector.normalize(kvector.subtract(o[1],o[0])),l=kvector.scale(s,n/2),c=kvector.scale(s,i),d=kvector.rotateDeg(c,90),h=kvector.rotateDeg(c,-90),u=kvector.negate(l),p=kvector.rotateDeg(l,90),v=kvector.rotateDeg(l,-90),g=kpoint.addVectors(t,d),f=kpoint.addVectors(t,h),m=kpoint.addVectors(t,d,l,p),y=kpoint.addVectors(t,d,u,p),b=kpoint.addVectors(t,h,l,v),x=kpoint.addVectors(t,h,u,v),k=e.path([g,m,y,!0],a),M=e.path([f,b,x,!0],r);return{remove:function(){k.remove(),M.remove()}}};return function(t){var o,n=this,i=t.line,a=n.addMovablePoint({constraints:t.constraints,coord:kline.midpoint([i.pointA.coord,i.pointZ.coord]),snapX:n.snap[0],snapY:n.snap[1],onMove:function(e,t){return!1},onMoveEnd:function(e,o){t.onMoveEnd&&t.onMoveEnd.call(this,e,o)}}),r=!1,s=!1,l=function(){return r},c=_.map([0,1],function(e){var o=e?t.highlightStyle:t.normalStyle;return _.map([0,1],function(e){return _.defaults({"fill-opacity":e},o)})}),d=function(e){return s&&(e=!e),c[+l()][+e]},h=function(i,a){o&&o.remove(),o=e(n,i,a,l()?1.5*t.size:t.size,l()?.125*t.size:.25,d(0),d(1))},u=function(e,t){e=e||i.pointA.coord,t=t||i.pointZ.coord;var o=kline.midpoint([e,t]);a.setCoord(o),h(o,[e,t])};$(i).on("move",_.bind(u,a,null,null));var p=$(a.mouseTarget.getMouseTarget());p.on("vclick",function(){var e=t.onClick();e!==!1&&(s=!s,h(a.coord,[i.pointA.coord,i.pointZ.coord]))}),i.pointA.toFront(),i.pointZ.toFront(),a.visibleShape.remove();var v=n.scaleVector(t.size)[0]/20;a.mouseTarget.attr({scale:1.5*v}),p.css("cursor","pointer"),p.bind("vmouseover",function(e){r=!0,h(a.coord,[i.pointA.coord,i.pointZ.coord])}),p.bind("vmouseout",function(e){r=!1,h(a.coord,[i.pointA.coord,i.pointZ.coord])});var g=a.remove;return a.remove=function(){o.remove(),g.call(a)},a.update=u,a.isFlipped=function(){return s},u(),a}}(),protractor:function(e){return new Protractor(this,e)},ruler:function(e){return new Ruler(this,e||{})},addPoints:addPoints}),_.extend(MovableAngle.prototype,{points:[],snapDegrees:0,snapOffsetDeg:0,angleLabel:"",numArcs:1,pushOut:0,fixed:!1,addMoveHandlers:function(){function e(e,o){var n=30,i=KhanUtil.getDistance(t.scalePoint(e),t.scalePoint(o));return n>i}var t=this.graphie,o=this.points;o[1].onMove=function(n,i){var a=o[1].coord,r=[n,i],s=addPoints(r,reverseVector(a)),l=!0,c={};return _.each([0,2],function(n){var i=o[n].coord,a=addPoints(i,s),d=KhanUtil.findAngle(r,a);d*=Math.PI/180,a=t.constrainToBoundsOnAngle(a,10,d),c[n]=a,e(r,a)&&(l=!1)}),l&&_.each(c,function(e,t){o[t].setCoord(e)}),l};var n=this.snapDegrees,i=this.snapOffsetDeg;_.each([0,2],function(a){o[a].onMove=function(a,r){var s=[a,r],l=o[1].coord;if(e(l,s))return!1;if(n){var c=KhanUtil.findAngle(s,l);c=Math.round((c-i)/n)*n+i;var d=KhanUtil.getDistance(s,l);return addPoints(l,t.polar(d,c))}return!0}}),$(o).on("move",function(){this.update(),$(this).trigger("move")}.bind(this))},addHighlightHandlers:function(){var e=this.points[1];e.onHighlight=function(){_.each(this.points,function(e){e.visibleShape.animate(this.highlightStyle,50)},this),_.each(this.rays,function(e){e.visibleLine.animate(this.highlightStyle,50),e.arrowStyle=_.extend({},e.arrowStyle,{color:this.highlightStyle.stroke,stroke:this.highlightStyle.stroke})},this),this.angleStyle=_.extend({},this.angleStyle,{color:this.highlightStyle.stroke,stroke:this.highlightStyle.stroke}),this.update()}.bind(this),e.onUnhighlight=function(){_.each(this.points,function(e){e.visibleShape.animate(this.normalStyle,50)},this),_.each(this.rays,function(e){e.visibleLine.animate(e.normalStyle,50),e.arrowStyle=_.extend({},e.arrowStyle,{color:e.normalStyle.stroke,stroke:e.normalStyle.stroke})},this),this.angleStyle=_.extend({},this.angleStyle,{color:KhanUtil.DYNAMIC,stroke:KhanUtil.DYNAMIC}),this.update()}.bind(this)},_getClockwiseAngle:function(e){var t=(KhanUtil.findAngle(e[2],e[0],e[1])+360)%360;return t},isReflex:function(){return this.reflex},isClockwise:function(){var e=this._getClockwiseAngle(this.coords)>180;return e===this.reflex},getClockwiseCoords:function(){return this.isClockwise()?_.clone(this.coords):_.clone(this.coords).reverse()},update:function(e){var t=this.coords;this.coords=_.pluck(this.points,"coord"),_.invoke(this.points,"updateLineEnds");var o=this._getClockwiseAngle(t),n=this._getClockwiseAngle(this.coords),i=o>180,a=n>180;this.allowReflex&&(null==e&&(e=i!==a&&Math.abs(n-o)<180),e&&(this.reflex=!this.reflex)),_.invoke(this.temp,"remove"),this.temp=this.graphie.labelAngle({point1:this.coords[0],vertex:this.coords[1],point3:this.coords[2],label:this.labeledAngle,text:this.angleLabel,numArcs:this.numArcs,pushOut:this.pushOut,clockwise:this.reflex===a,style:this.angleStyle})},remove:function(){_.invoke(this.rays,"remove"),_.invoke(this.temp,"remove"),this.labeledAngle.remove()}});
},{"../third_party/jquery.mobile.vmouse.js":22,"./graphie.js":6,"./kline.js":8,"./kpoint.js":10,"./kvector.js":11,"./wrapped-ellipse.js":19,"./wrapped-line.js":20,"./wrapped-path.js":21}],8:[function(require,module,exports){
var kpoint=require("./kpoint.js"),knumber=require("./knumber.js"),kline=KhanUtil.kline={distanceToPoint:function(n,e){return kpoint.distanceToLine(e,n)},reflectPoint:function(n,e){return kpoint.reflectOverLine(e,n)},midpoint:function(n){return[(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2]},equal:function(n,e,r){var t=n[0][0],i=n[0][1],u=n[1][0],o=n[1][1];return _.every(e,function(n){var e=n[0],c=n[1],a=.5*Math.abs(t*o+u*c+e*i-u*i-e*o-t*c);return knumber.equal(a,0,r)})},intersect:function(n,e,r,t,i,u,o,c){function a(n,e,r,t){return n*t-e*r}if(0===a(r,t,o,c))return 0===a(i-n,u-e,r,t);var f=a(i-n,u-e,o,c)/a(r,t,o,c),k=a(i-n,u-e,r,t)/a(r,t,o,c);return f>=0&&1>=f&&k>=0&&1>=k}};module.exports=kline;
},{"./knumber.js":9,"./kpoint.js":10}],9:[function(require,module,exports){
var DEFAULT_TOLERANCE=1e-9,EPSILON=Math.pow(2,-42),knumber=KhanUtil.knumber={DEFAULT_TOLERANCE:DEFAULT_TOLERANCE,EPSILON:EPSILON,is:function(n){return _.isNumber(n)&&!_.isNaN(n)},equal:function(n,r,u){return null==n||null==r?n===r:(null==u&&(u=DEFAULT_TOLERANCE),Math.abs(n-r)<u)},sign:function(n,r){return knumber.equal(n,0,r)?0:Math.abs(n)/n},round:function(n,r){var u=Math.pow(10,r);return Math.round(n*u)/u},roundTo:function(n,r){return Math.round(n/r)*r},floorTo:function(n,r){return Math.floor(n/r)*r},ceilTo:function(n,r){return Math.ceil(n/r)*r},isInteger:function(n,r){return knumber.equal(Math.round(n),n,r)},toFraction:function(n,r,u){u=u||1e3,r=r||EPSILON;for(var t=[1,0],o=[0,1],e=Math.floor(n),a=n-e;o[0]<=u;){if(knumber.equal(t[0]/o[0],n,r))return[t[0],o[0]];t=[e*t[0]+t[1],t[0]],o=[e*o[0]+o[1],o[0]],e=Math.floor(1/a),a=1/a-e}return[n,1]}};module.exports=knumber;
},{}],10:[function(require,module,exports){
var kvector=require("./kvector.js"),knumber=require("./knumber.js"),kpoint=KhanUtil.kpoint={rotateRad:function(r,t,o){return void 0===o?kvector.rotateRad(r,t):kvector.add(o,kvector.rotateRad(kvector.subtract(r,o),t))},rotateDeg:function(r,t,o){return void 0===o?kvector.rotateDeg(r,t):kvector.add(o,kvector.rotateDeg(kvector.subtract(r,o),t))},distanceToPoint:function(r,t){return kvector.length(kvector.subtract(r,t))},distanceToLine:function(r,t){var o=kvector.subtract(t[1],t[0]),e=kvector.subtract(r,t[0]),c=kvector.projection(e,o),a=kvector.subtract(c,e);return kvector.length(a)},reflectOverLine:function(r,t){var o=kvector.subtract(t[1],t[0]),e=kvector.subtract(r,t[0]),c=kvector.projection(e,o),a=kvector.subtract(kvector.scale(c,2),e);return kvector.add(t[0],a)},compare:function(r,t,o){if(r.length!==t.length)return r.length-t.length;for(var e=0;e<r.length;e++)if(!knumber.equal(r[e],t[e],o))return r[e]-t[e];return 0}};_.extend(kpoint,{is:kvector.is,addVector:kvector.add,addVectors:kvector.add,subtractVector:kvector.subtract,equal:kvector.equal,polarRadFromCart:kvector.polarRadFromCart,polarDegFromCart:kvector.polarDegFromCart,cartFromPolarRad:kvector.cartFromPolarRad,cartFromPolarDeg:kvector.cartFromPolarDeg,round:kvector.round,roundTo:kvector.roundTo,floorTo:kvector.floorTo,ceilTo:kvector.ceilTo}),module.exports=kpoint;
},{"./knumber.js":9,"./kvector.js":11}],11:[function(require,module,exports){
function arraySum(r){return _.reduce(r,function(r,t){return r+t},0)}function arrayProduct(r){return _.reduce(r,function(r,t){return r*t},1)}var knumber=require("./knumber.js"),kvector=KhanUtil.kvector={is:function(r,t){return _.isArray(r)?void 0!==t&&r.length!==t?!1:_.all(r,knumber.is):!1},normalize:function(r){return kvector.scale(r,1/kvector.length(r))},length:function(r){return Math.sqrt(kvector.dot(r,r))},dot:function(r,t){var n=_.toArray(arguments),e=_.zip.apply(_,n),o=_.map(e,arrayProduct);return arraySum(o)},add:function(){var r=_.toArray(arguments),t=_.zip.apply(_,r);return _.map(t,arraySum)},subtract:function(r,t){return _.map(_.zip(r,t),function(r){return r[0]-r[1]})},negate:function(r){return _.map(r,function(r){return-r})},scale:function(r,t){return _.map(r,function(r){return r*t})},equal:function(r,t,n){return _.all(_.zip(r,t),function(r){return knumber.equal(r[0],r[1],n)})},codirectional:function(r,t,n){return knumber.equal(kvector.length(r),0,n)||knumber.equal(kvector.length(t),0,n)?!0:(r=kvector.normalize(r),t=kvector.normalize(t),kvector.equal(r,t,n))},collinear:function(r,t,n){return kvector.codirectional(r,t,n)||kvector.codirectional(r,kvector.negate(t),n)},polarRadFromCart:function(r){var t=kvector.length(r),n=Math.atan2(r[1],r[0]);return 0>n&&(n+=2*Math.PI),[t,n]},polarDegFromCart:function(r){var t=kvector.polarRadFromCart(r);return[t[0],180*t[1]/Math.PI]},cartFromPolarRad:function(r,t){return _.isUndefined(t)&&(t=r[1],r=r[0]),[r*Math.cos(t),r*Math.sin(t)]},cartFromPolarDeg:function(r,t){return _.isUndefined(t)&&(t=r[1],r=r[0]),kvector.cartFromPolarRad(r,t*Math.PI/180)},rotateRad:function(r,t){var n=kvector.polarRadFromCart(r),e=n[1]+t;return kvector.cartFromPolarRad(n[0],e)},rotateDeg:function(r,t){var n=kvector.polarDegFromCart(r),e=n[1]+t;return kvector.cartFromPolarDeg(n[0],e)},angleRad:function(r,t){return Math.acos(kvector.dot(r,t)/(kvector.length(r)*kvector.length(t)))},angleDeg:function(r,t){return 180*kvector.angleRad(r,t)/Math.PI},projection:function(r,t){var n=kvector.dot(r,t)/kvector.dot(t,t);return kvector.scale(t,n)},round:function(r,t){return _.map(r,function(r,n){return knumber.round(r,t[n]||t)})},roundTo:function(r,t){return _.map(r,function(r,n){return knumber.roundTo(r,t[n]||t)})},floorTo:function(r,t){return _.map(r,function(r,n){return knumber.floorTo(r,t[n]||t)})},ceilTo:function(r,t){return _.map(r,function(r,n){return knumber.ceilTo(r,t[n]||t)})}};module.exports=kvector;
},{"./knumber.js":9}],12:[function(require,module,exports){
require("./math.js"),require("./expressions.js"),$.extend(KhanUtil,{negParens:function(t,n){var i=n?"\\"+n+"{"+t+"}":t;return 0>t?"("+i+")":i},decimalFraction:function(t,n,i,e,r){var a=KhanUtil.toFraction(t);return KhanUtil.fraction(a[0],a[1],n,i,e,r)},reduce:function(t,n){var i=KhanUtil.getGCD(t,n);return t/=i,n/=i,[t,n]},toFractionTex:function(t,n){var i=KhanUtil.toFraction(t);return 1===i[1]?i[0]:(0>t?"-":"")+"\\"+(n?"d":"")+"frac{"+Math.abs(i[0])+"}{"+Math.abs(i[1])+"}"},fraction:function(t,n,i,e,r,a){var o=function(t,n){return(r?"\\frac":"\\dfrac")+"{"+t+"}{"+n+"}"},l=0>t*n,f=l?"-":"";if(t=Math.abs(t),n=Math.abs(n),e){var c=KhanUtil.getGCD(t,n);t/=c,n/=c}i=i&&(0===t||0===n||1===n),a=a&&(!i||l);var u,h=a?"\\left(":"",s=a?"\\right)":"";return i?0===t?u="0":0===n?u="\\text{undefined}":1===n&&(u=f+t):u=f+o(t,n),h+u+s},mixedFractionFromImproper:function(t,n,i,e,r,a){return KhanUtil.mixedFraction(Math.floor(t/n),t%n,n,i,e,r,a)},mixedFraction:function(t,n,i,e,r,a,o){var l=t?t:0,f=n?n:0,c=i?i:1;if(0>l&&0>f)throw"NumberFormatException: Both integer portion and fraction cannot both be negative.";if(0>c)throw"NumberFormatException: Denominator cannot be be negative.";if(0===c)throw"NumberFormatException: Denominator cannot be be 0.";return r&&(0>l?l-=Math.floor(f/c):l+=Math.floor(f/c),f%=c),0!==l&&0!==f?l+" "+KhanUtil.fraction(n,i,e,r,a,o):0!==l&&0===f?l:0===l&&0!==f?KhanUtil.fraction(n,i,e,r,a,o):0},fractionReduce:function(t,n,i,e){return KhanUtil.fraction(t,n,!0,!0,i,e)},fractionSmall:function(t,n,i,e,r){return KhanUtil.fraction(t,n,i,e,!0,r)},piFraction:function(t,n,i,e){if(t.constructor===Number){null==i&&(i=.001);var r=KhanUtil.toFraction(t/Math.PI,i),a=r[0],o=r[1];if(n){if(0===a)return"0";if(1===a&&1===o)return"\\pi"}var l=e?KhanUtil.fraction(a,o):KhanUtil.fractionSmall(a,o);return 1===o?a+"\\pi":l+"\\pi"}},reduces:function(t,n){return KhanUtil.getGCD(t,n)>1},fractionSimplification:function(t,n){var i="\\frac{"+t+"}{"+n+"}";return(1>=n||KhanUtil.getGCD(t,n)>1)&&(i+=" = "+KhanUtil.fractionReduce(t,n)),i},mixedOrImproper:function(t,n){if(n>t||KhanUtil.rand(2)>0)return KhanUtil.fraction(t,n);var i=Math.floor(t/n);return i+KhanUtil.fraction(t-n*i,n)},splitRadical:function(t){if(0===t)return[0,1];for(var n=1,i=t,e=2;t>=e*e;e++)for(;i%(e*e)===0;)i/=e*e,n*=e;return[n,i]},formattedSquareRootOf:function(t){if(1===t||0===t)return t.toString();var n=KhanUtil.splitRadical(t),i=1===n[0]?"":n[0].toString(),e=1===n[1]?"":"\\sqrt{"+n[1]+"}";return i+e},squareRootCanSimplify:function(t){return KhanUtil.formattedSquareRootOf(t)!=="\\sqrt{"+t+"}"},cardinalThrough20:function(t){var n=[$._("zero"),$._("one"),$._("two"),$._("three"),$._("four"),$._("five"),$._("six"),$._("seven"),$._("eight"),$._("nine"),$._("ten"),$._("eleven"),$._("twelve"),$._("thirteen"),$._("fourteen"),$._("fifteen"),$._("sixteen"),$._("seventeen"),$._("eighteen"),$._("nineteen"),$._("twenty")];return t>=0&&20>=t?n[t]:String(t)},CardinalThrough20:function(t){var n=KhanUtil.cardinalThrough20(t);return n.charAt(0).toUpperCase()+n.slice(1)},ordinalThrough20:function(t){var n=[$._("zeroth"),$._("first"),$._("second"),$._("third"),$._("fourth"),$._("fifth"),$._("sixth"),$._("seventh"),$._("eighth"),$._("ninth"),$._("tenth"),$._("eleventh"),$._("twelfth"),$._("thirteenth"),$._("fourteenth"),$._("fifteenth"),$._("sixteenth"),$._("seventeenth"),$._("eighteenth"),$._("nineteenth"),$._("twentieth")];return t>=0&&20>=t?n[t]:t+"th"},cardinal:function(t){var n=["",$._("thousand"),$._("million"),$._("billion"),$._("trillion"),$._("quadrillion"),$._("quintillion"),$._("sextillion"),$._("septillion"),$._("octillion"),$._("nonillion"),$._("decillion"),$._("undecillion"),$._("duodecillion"),$._("tredecillion"),$._("quattuordecillion"),$._("quindecillion"),$._("sexdecillion"),$._("septendecillion"),$._("octodecillion"),$._("novemdecillion"),$._("vigintillion")],i=[$._("zero"),$._("one"),$._("two"),$._("three"),$._("four"),$._("five"),$._("six"),$._("seven"),$._("eight"),$._("nine"),$._("ten"),$._("eleven"),$._("twelve"),$._("thirteen"),$._("fourteen"),$._("fifteen"),$._("sixteen"),$._("seventeen"),$._("eighteen"),$._("nineteen")],e=["","",$._("twenty"),$._("thirty"),$._("forty"),$._("fifty"),$._("sixty"),$._("seventy"),$._("eighty"),$._("ninety")],r=function(t){var n=Math.floor(t/100),r=t%100,a="";if(n&&(a+=$._("%(unit)s hundred",{unit:i[n]})),n&&r&&(a+=" "),r)if(20>r)a+=i[r];else{var o=Math.floor(r/10),l=r%10;o&&(a+=e[o]),o&&l&&(a+="-"),l&&(a+=i[l])}return a};if(0===t)return $._("zero");var a=!1;0>t&&(a=!0,t=Math.abs(t));for(var o=[],l=0;t>0;){var f=t%1e3;f>0&&(l>0&&o.unshift(n[l]),o.unshift(r(f))),t=Math.floor(t/1e3),l+=1}return a&&o.unshift($._("negative")),o.join(" ")},Cardinal:function(t){var n=KhanUtil.cardinal(t);return n.charAt(0).toUpperCase()+n.slice(1)},quadraticRoots:function(t,n,i){var e=KhanUtil.splitRadical(n*n-4*t*i),r="x =";if(n*n-4*t*i===0)r+=KhanUtil.fraction(-n,2*t,!0,!0,!0);else if(1===e[1])r+=KhanUtil.fraction(-n+e[0],2*t,!0,!0,!0)+","+KhanUtil.fraction(-n-e[0],2*t,!0,!0,!0);else if(1===e[0])r+=KhanUtil.expr(["frac",["+-",-n,["sqrt",e[1]]],2*t]);else{var a=KhanUtil.getGCD(n,2*t,e[0]);r+=a===Math.abs(2*t)?KhanUtil.expr(["+-",-n/(2*t),["*",e[0]/a,["sqrt",e[1]]]]):KhanUtil.expr(["frac",["+-",-n/a,["*",e[0]/a,["sqrt",e[1]]]],2*t/a])}return r},commafy:function(t){var n=t.toString().split("."),i=icu.getDecimalFormatSymbols().grouping_separator,e=icu.getDecimalFormatSymbols().decimal_separator;return" "===i&&(i="\\;"),n[0].length>=5&&(n[0]=n[0].replace(/(\d)(?=(\d{3})+$)/g,"$1{"+i+"}")),n[1]&&n[1].length>=5&&(n[1]=n[1].replace(/(\d{3})(?=\d)/g,"$1\\;")),n.join(e)},plus:function(){for(var t,n=[],i=0;i<arguments.length;i++)t=KhanUtil._plusTrim(arguments[i]),t&&n.push(t);return n.length>0?n.join(" + "):"0"},_plusTrim:function(t){if("string"==typeof t&&isNaN(t)){if(-1!==t.indexOf("{")){var n=t.indexOf("{",t.indexOf("{")+1)+1,i=t.indexOf("}",t.indexOf("}")+1);return n!==t.lastIndexOf("{")+1&&1===+KhanUtil._plusTrim(t.slice(n,i))?-1!==t.indexOf("\\")?t.slice(0,t.indexOf("\\"))+t.slice(i+1):t.slice(i+1):t.slice(0,n)+KhanUtil._plusTrim(t.slice(n,i))+t.slice(i)}return 0===t.indexOf("1")&&isNaN(t[1])?t.slice(1):0===t.indexOf("-1")&&isNaN(t[2])?"-"+t.slice(2):0===t.indexOf("0")||0===t.indexOf("-0")?"":t}return"number"==typeof t?t:isNaN(t)?void 0:+t},randVar:function(){return KhanUtil.randFromArray(["a","k","n","p","q","r","t","x","y","z"])},eulerFormExponent:function(t){var n=KhanUtil.toFraction(t/Math.PI,.001),i=n[0],e=n[1],r=(i>1?i:"")+"\\pi i";return 1!==e&&(r+=" / "+e),r},polarForm:function(t,n,i){var e,r=KhanUtil.toFraction(n/Math.PI,.001),a=r[0];if(i)if(a>0){var o=KhanUtil.expr(["^","e",KhanUtil.eulerFormExponent(n)]);e=(t>1?t:"")+" "+o}else e=t;else if(0===n)e=t;else{var l=KhanUtil.piFraction(n,!0),f="\\cos \\left("+l+"\\right) + i \\sin \\left("+l+"\\right)";e=1!==t?t+"\\left("+f+"\\right)":f}return e},coefficient:function(t){return 1===t||"1"===t?"":-1===t||"-1"===t?"-":t},fractionVariable:function(t,n,i){if(i=i||"",0===n)return"\\text{undefined}";if(0===t)return 0;if("number"==typeof n){0>n&&(t*=-1,n*=-1);var e=KhanUtil.getGCD(t,n);if(t/=e,n/=e,1===n)return KhanUtil.coefficient(t)+i}return 0>t?"-\\dfrac{"+KhanUtil.coefficient(-t)+i+"}{"+n+"}":"\\dfrac{"+KhanUtil.coefficient(t)+i+"}{"+n+"}"},complexNumber:function(t,n){return 0===t&&0===n?"0":0===t?KhanUtil.coefficient(n)+"i":0===n?t:KhanUtil.expr(["+",t,["*",n,"i"]])},complexFraction:function(t,n,i,e){var r="";return 0===t&&0===i&&(r="0"),0!==t&&(r+=KhanUtil.fraction(t,n,!1,!0)),0!==i&&(i/e>0?(0!==t&&(r+=" + "),r+=KhanUtil.fraction(i,e,!1,!0)+" i"):(i=Math.abs(i),e=Math.abs(e),r+=" - ",r+=KhanUtil.fraction(i,e,!1,!0)+" i")),r},scientificExponent:function(t){return Math.floor(Math.log(Math.abs(t))/Math.log(10))},scientificMantissa:function(t,n){var i=KhanUtil.scientificExponent(n),e=Math.pow(10,i);t-=1;var r=KhanUtil.roundTo(t,n/e);return r},scientific:function(t,n){var i=KhanUtil.scientificExponent(n),e=KhanUtil.localeToFixed(KhanUtil.scientificMantissa(t,n),t-1);return""+e+"\\times 10^{"+i+"}"}});
},{"./expressions.js":4,"./math.js":13}],13:[function(require,module,exports){
require("../third_party/raphael.js");var knumber=require("./knumber.js");$.extend(KhanUtil,{cleanMath:function(n){return"string"==typeof n?n.replace(/\+\s*-/g,"- ").replace(/-\s*-/g,"+ ").replace(/\^1/g,""):n},rand:function(n){return Math.floor(n*KhanUtil.random())},digits:function(n){if(0===n)return[0];for(var r=[];n>0;)r.push(n%10),n=Math.floor(n/10);return r},integerToDigits:function(n){return KhanUtil.digits(n).reverse()},decimalDigits:function(n){var r=""+Math.abs(n);r=r.replace(".","");for(var t=[],e=r.length;e>0;e--)t.push(r.charAt(e-1));return t},decimalPlaces:function(n){var r=""+Math.abs(n);return r=r.split("."),1===r.length?0:r[1].length},digitsToInteger:function(n){var r=Math.floor(Math.pow(10,n.length-1)),t=0;return $.each(n,function(n,e){t+=e*r,r/=10}),t},padDigitsToNum:function(n,r){for(n=n.slice(0);n.length<r;)n.push(0);return n},placesLeftOfDecimal:[$._("one"),$._("ten"),$._("hundred"),$._("thousand")],placesRightOfDecimal:[$._("one"),$._("tenth"),$._("hundredth"),$._("thousandth"),$._("ten thousandth")],powerToPlace:function(n){return 0>n?KhanUtil.placesRightOfDecimal[-1*n]:KhanUtil.placesLeftOfDecimal[n]},roundTowardsZero:function(n){return 0>n?Math.ceil(n-.001):Math.floor(n+.001)},bound:function(n){return 0===n?n:0>n?-KhanUtil.bound(-n):Math.max(1e-6,Math.min(n,1e20))},factorial:function(n){return 1>=n?n:n*KhanUtil.factorial(n-1)},getGCD:function(n,r){if(arguments.length>2){var t=[].slice.call(arguments,1);return KhanUtil.getGCD(n,KhanUtil.getGCD.apply(KhanUtil,t))}var e;for(n=Math.abs(n),r=Math.abs(r);r;)e=n%r,n=r,r=e;return n},getLCM:function(n,r){if(arguments.length>2){var t=[].slice.call(arguments,1);return KhanUtil.getLCM(n,KhanUtil.getLCM.apply(KhanUtil,t))}return Math.abs(n*r)/KhanUtil.getGCD(n,r)},primes:[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97],denominators:[2,3,4,5,6,8,10,12,100],smallDenominators:[2,3,4,5,6,8,10,12],getPrime:function(){return KhanUtil.primes[KhanUtil.rand(KhanUtil.primes.length)]},isPrime:function(n){if(1>=n)return!1;if(101>n)return!!$.grep(KhanUtil.primes,function(r,t){return Math.abs(r-n)<=.5}).length;if(1>=n||n>2&&n%2===0)return!1;for(var r=3,t=Math.sqrt(n);t>=r;r+=2)if(n%r===0)return!1;return!0},isOdd:function(n){return n%2===1},isEven:function(n){return n%2===0},getOddComposite:function(n,r){void 0===n&&(n=0),void 0===r&&(r=100);var t=[9,15,21,25,27,33,35,39,45,49,51,55];t=t.concat([57,63,65,69,75,77,81,85,87,91,93,95,99]);for(var e=-1;n>e||e>r;)e=t[KhanUtil.rand(t.length)];return e},getEvenComposite:function(n,r){void 0===n&&(n=0),void 0===r&&(r=100);var t=[4,6,8,10,12,14,16,18,20,22,24,26];t=t.concat([28,30,32,34,36,38,40,42,44,46,48]),t=t.concat([50,52,54,56,58,60,62,64,66,68,70,72]),t=t.concat([74,76,78,80,82,84,86,88,90,92,94,96,98]);for(var e=-1;n>e||e>r;)e=t[KhanUtil.rand(t.length)];return e},getComposite:function(){return KhanUtil.randRange(0,1)?KhanUtil.getEvenComposite():KhanUtil.getOddComposite()},getPrimeFactorization:function(n){if(1===n)return[];if(KhanUtil.isPrime(n))return[n];for(var r=Math.sqrt(n),t=2;r>=t;t++)if(n%t===0)return $.merge(KhanUtil.getPrimeFactorization(t),KhanUtil.getPrimeFactorization(n/t))},getFactors:function(n){for(var r=[],t=function(n){-1===_(r).indexOf(n)&&r.push(n)},e=n,a=1;e>=a*a;a++)n%a===0&&(t(a),t(n/a));return KhanUtil.sortNumbers(r)},getNontrivialFactor:function(n){var r=KhanUtil.getFactors(n);return r[KhanUtil.randRange(1,r.length-2)]},getMultiples:function(n,r){for(var t=[],e=1;r>=e*n;e++)t.push(e*n);return t},splitRadical:function(n){if(0===n)return[0,1];for(var r=1,t=n,e=2;n>=e*e;e++)for(;t%(e*e)===0;)t/=e*e,r*=e;return[r,t]},splitCube:function(n){if(0===n)return[0,1];for(var r=1,t=n,e=2;n>=e*e*e;e++)for(;t%(e*e*e)===0;)t/=e*e*e,r*=e;return[r,t]},randRange:function(n,r){var t=[].slice.call(arguments,2);if(0===t.length)return Math.floor(KhanUtil.rand(r-n+1))+n;var e=[n,r].concat(t.slice(1));return $.map(new Array(t[0]),function(){return[KhanUtil.randRange.apply(null,e)]})},randRangeUnique:function(n,r,t){if(null==t)return KhanUtil.randRange(n,r);for(var e=[],a=n;r>=a;a++)e.push(a);return KhanUtil.shuffle(e,t)},randRangeUniqueNonZero:function(n,r,t){if(null==t)return KhanUtil.randRangeNonZero(n,r);for(var e=[],a=n;r>=a;a++)0!==a&&e.push(a);return KhanUtil.shuffle(e,t)},randRangeWeighted:function(n,r,t,e){return KhanUtil.random()<e||t===n&&t===r?t:KhanUtil.randRangeExclude(n,r,[t])},randRangeExclude:function(n,r,t){var e;do e=KhanUtil.randRange(n,r);while(-1!==_(t).indexOf(e));return e},randRangeWeightedExclude:function(n,r,t,e,a){var i;do i=KhanUtil.randRangeWeighted(n,r,t,e);while(-1!==_(a).indexOf(i));return i},randRangeNonZero:function(n,r){return KhanUtil.randRangeExclude(n,r,[0])},randFromArray:function(n,r){return null==r?n[KhanUtil.rand(n.length)]:$.map(new Array(r),function(){return KhanUtil.randFromArray(n)})},randFromArrayExclude:function(n,r){for(var t=[],e=0;e<n.length;e++)-1===_(r).indexOf(n[e])&&t.push(n[e]);return KhanUtil.randFromArray(t)},roundToNearest:function(n,r){return Math.round(r/n)*n},roundTo:function(n,r){var t=Math.pow(10,n).toFixed(5);return Math.round((r*t).toFixed(5))/t},toFixedApprox:function(n,r){var t=n.toFixed(r);return knumber.equal(+t,n)?t:"\\approx "+t},roundToApprox:function(n,r){var t=KhanUtil.roundTo(r,n);return knumber.equal(t,n)?String(t):KhanUtil.toFixedApprox(n,r)},floorTo:function(n,r){var t=Math.pow(10,n).toFixed(5);return Math.floor((r*t).toFixed(5))/t},ceilTo:function(n,r){var t=Math.pow(10,n).toFixed(5);return Math.ceil((r*t).toFixed(5))/t},toFraction:function(n,r){if(null==r&&(r=Math.pow(2,-46)),0>n||n>1){var t=n%1;t+=0>t?1:0;var e=KhanUtil.toFraction(t,r);return e[0]+=Math.round(n-t)*e[1],e}if(Math.abs(Math.round(Number(n))-n)<=r)return[Math.round(n),1];for(var a=0,i=1,o=1,u=1,l=1,c=2;;){if(Math.abs(Number(l/c)-n)<=r)return[l,c];n>l/c?(a=l,i=c):(o=l,u=c),l=a+o,c=i+u}},getNumericFormat:function(n){if(n=$.trim(n),n=n.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1"),n.match(/^[+-]?\d+$/))return"integer";if(n.match(/^[+-]?\d+\s+\d+\s*\/\s*\d+$/))return"mixed";var r=n.match(/^[+-]?(\d+)\s*\/\s*(\d+)$/);return r?parseFloat(r[1])>parseFloat(r[2])?"improper":"proper":n.replace(/[,. ]/g,"").match(/^\d+$/)?"decimal":n.match(/(pi?|\u03c0|t(?:au)?|\u03c4|pau)/)?"pi":null},toNumericString:function(n,r){if(null==n)return"";if(0===n)return"0";if("percent"===r)return 100*n+"%";if("pi"===r){var t=knumber.toFraction(n/Math.PI),e=Math.abs(t[0]),a=t[1];if(knumber.isInteger(e)){var i=0>n?"-":"",o="π";return i+(1===e?"":e)+o+(1===a?"":"/"+a)}}if(_(["proper","improper","mixed","fraction"]).contains(r)){var t=knumber.toFraction(n),e=Math.abs(t[0]),a=t[1],i=0>n?"-":"";if(1===a)return i+e;if("mixed"===r){var u=e%a,l=(e-u)/a;return i+(l?l+" ":"")+u+"/"+a}return i+e+"/"+a}return String(n)},shuffle:function(n,r){n=[].slice.call(n,0);for(var t="undefined"==typeof r||r>n.length?0:n.length-r,e=n.length;e>t;e--){var a=Math.floor(KhanUtil.random()*e),i=n[a];n[a]=n[e-1],n[e-1]=i}return n.slice(t)},sortNumbers:function(n){return n.slice(0).sort(function(n,r){return n-r})},truncate_to_max:function(n,r){return parseFloat(n.toFixed(r))},isInt:function(n){return parseFloat(n)===parseInt(n,10)&&!isNaN(n)},colorMarkup:function(n,r){return"\\color{"+r+"}{"+n+"}"},contains:function(n,r){return _.any(n,function(n){return _.isEqual(r,n)?!0:!1})},BLUE:"#6495ED",ORANGE:"#FFA500",PINK:"#FF00AF",GREEN:"#28AE7B",PURPLE:"#9D38BD",RED:"#DF0030",GRAY:"gray",BLACK:"black",LIGHT_BLUE:"#9AB8ED",LIGHT_ORANGE:"#EDD19B",LIGHT_PINK:"#ED9BD3",LIGHT_GREEN:"#9BEDCE",LIGHT_PURPLE:"#DA9BED",LIGHT_RED:"#ED9AAC",LIGHT_GRAY:"#ED9B9B",LIGHT_BLACK:"#ED9B9B",GRAY10:"#D6D6D6",GRAY20:"#CDCDCD",GRAY30:"#B3B3B3",GRAY40:"#9A9A9A",GRAY50:"#808080",GRAY60:"#666666",GRAY70:"#4D4D4D",GRAY80:"#333333",GRAY90:"#1A1A1A",BLUE_A:"#C7E9F1",BLUE_B:"#9CDCEB",BLUE_C:"#58C4DD",BLUE_D:"#29ABCA",BLUE_E:"#1C758A",TEAL_A:"#ACEAD7",TEAL_B:"#76DDC0",TEAL_C:"#5CD0B3",TEAL_D:"#55C1A7",TEAL_E:"#49A88F",GREEN_A:"#C9E2AE",GREEN_B:"#A6CF8C",GREEN_C:"#83C167",GREEN_D:"#77B05D",GREEN_E:"#699C52",GOLD_A:"#F7C797",GOLD_B:"#F9B775",GOLD_C:"#F0AC5F",GOLD_D:"#E1A158",GOLD_E:"#C78D46",RED_A:"#F7A1A3",RED_B:"#FF8080",RED_C:"#FC6255",RED_D:"#E65A4C",RED_E:"#CF5044",MAROON_A:"#ECABC1",MAROON_B:"#EC92AB",MAROON_C:"#C55F73",MAROON_D:"#A24D61",MAROON_E:"#94424F",PURPLE_A:"#CAA3E8",PURPLE_B:"#B189C6",PURPLE_C:"#9A72AC",PURPLE_D:"#715582",PURPLE_E:"#644172",MINT_A:"#F5F9E8",MINT_B:"#EDF2DF",MINT_C:"#E0E5CC",GRAY_A:"#FDFDFD",GRAY_B:"#F7F7F7",GRAY_C:"#EEEEEE",GRAY_D:"#DDDDDD",GRAY_E:"#CCCCCC",GRAY_F:"#AAAAAA",GRAY_G:"#999999",GRAY_H:"#555555",GRAY_I:"#333333",KA_BLUE:"#314453",KA_GREEN:"#639B24",_BACKGROUND:"#FDFDFD"}),$.extend(KhanUtil,{INTERACTING:KhanUtil.ORANGE,INTERACTIVE:KhanUtil.ORANGE,DYNAMIC:KhanUtil.BLUE});
},{"../third_party/raphael.js":23,"./knumber.js":9}],14:[function(require,module,exports){
var pluck=function(r,c){return _.object(_.map(r,function(r,t){return[t,r[c]]}))},mapObject=function(r,c){var t={};return _.each(_.keys(r),function(e){t[e]=c(r[e],e)}),t},mapObjectFromArray=function(r,c){var t={};return _.each(r,function(r){t[r]=c(r)}),t};module.exports={pluck:pluck,mapObject:mapObject,mapObjectFromArray:mapObjectFromArray};
},{}],15:[function(require,module,exports){
function findChildOrAdd(t,a){var e=$(t).find("."+a);return 0===e.length?$("<span>").addClass(a).appendTo($(t)):e}function doCallback(t,a){var e=0;!function r(){var n=t.scrollHeight;n>18||e>=10?a():(e++,setTimeout(r,100))}()}$.extend(KhanUtil,{processMath:function(t,a,e,r){var n=$(t);if(null==n.attr("data-math-formula")||e){var i=findChildOrAdd(n,"katex-holder"),l=findChildOrAdd(n,"mathjax-holder"),o=l.find("script[type='math/tex']")[0];if(null==a&&(n.attr("data-math-formula")?a=n.attr("data-math-formula"):o&&(a=o.text||o.textContent)),a=null!=a?a+"":"",KhanUtil.cleanMath&&(a=KhanUtil.cleanMath(a)),n.attr("data-math-formula",a),Exercises.useKatex)try{if(katex.render(a,i[0]),"mathjax"===n.attr("data-math-type")){var u=MathJax.Hub.getJaxFor(o);if(u){var h=u.SourceElement();h.previousSibling&&h.previousSibling.className&&u.Remove()}}return n.attr("data-math-type","katex"),void(r&&doCallback(t,r))}catch(d){if(d.__proto__!==katex.ParseError.prototype)throw d}n.attr("data-math-type","mathjax"),o?"text"in o?o.text=a:o.textContent=a:l.append("<script type='math/tex'>"+a.replace(/<\//g,"< /")+"</script>"),"undefined"!=typeof MathJax&&(MathJax.Hub.Queue(["Reprocess",MathJax.Hub,l[0]]),MathJax.Hub.Queue(function(){KhanUtil.debugLog("MathJax done typesetting ("+a+")")}),r&&MathJax.Hub.Queue(function(){var a=MathJax.Callback(function(){});return doCallback(t,function(){r(),a()}),a}))}},processAllMath:function(t,a){var e=$(t);e.filter("code").add(e.find("code")).each(function(){var t=$(this),e=t.attr("data-math-formula");null==e&&(e=t.text(),t.empty()),KhanUtil.processMath(this,e,a)})},cleanupMath:function(t){var a=$(t);if(a.attr("data-math-formula")){if("undefined"!=typeof MathJax){var e=MathJax.Hub.getJaxFor(a.find("script")[0]);if(e){var r=e.SourceElement();r.previousSibling&&r.previousSibling.className&&e.Remove()}}a.text(a.attr("data-math-formula")),a.attr("data-math-formula",null),a.attr("data-math-type",null)}return t},retrieveMathFormula:function(t){return $(t).attr("data-math-formula")}}),$.fn.tex=function(){return KhanUtil.processAllMath(this,!1),this},$.fn.texCleanup=function(){return this.filter("code").add(this.find("code")).each(function(){KhanUtil.cleanupMath(this)}),this};
},{}],16:[function(require,module,exports){
var crc32=require("./crc32.js"),localMode,VARS={};$.tmpl={DATA_ENSURE_LOOPS:0,attr:{"data-ensure":function(t,e){return function(t){var n=!(!e||!$.tmpl.getVAR(e));return!n&&$.tmpl.DATA_ENSURE_LOOPS++>1e4&&localMode?(alert("unsatisfiable data-ensure?"),!0):n}},"data-if":function(t,e){var n=$(t);e=e&&$.tmpl.getVAR(e);var r=n.next();return void 0===r.data("lastCond")&&r.data("lastCond",e),e?void 0:[]},"data-else-if":function(t,e){var n=$(t),r=n.data("lastCond");e=!r&&e&&$.tmpl.getVAR(e);var a=n.next();return void 0===a.data("lastCond")&&a.data("lastCond",r||e),e?void 0:[]},"data-else":function(t){var e=$(t);return e.data("lastCond")?[]:void 0},"data-each":function(t,e){var n;if($(t).removeAttr("data-each"),n=/^(.+) times(?: as (\w+))?$/.exec(e)){var r=$.tmpl.getVAR(n[1]);return{items:$.map(new Array(r),function(t,e){return e}),value:n[2],oldValue:VARS[n[2]]}}return(n=/^(.*?)(?: as (?:(\w+), )?(\w+))?$/.exec(e))?{items:$.tmpl.getVAR(n[1]),value:n[3],pos:n[2],oldValue:VARS[n[3]],oldPos:VARS[n[2]]}:void 0},"data-unwrap":function(t){return $(t).contents()},"data-video-hint":function(t){var e=$(t).data("youtube-id");if(e){e=e.split(/,\s*/);var n=$(t).data("video-hint-author")||"Sal",r=$._("Watch %(author)s work through a very similar problem:",{author:n}),a=$("<p>").text(r),i=$("<div>",{"class":"video-hint"});return i.append(a),_.each(e,function(t){var e="http://www.khanacademy.org/embed_video?v="+t,n=$("<iframe>").attr({frameborder:"0",scrolling:"no",width:"100%",height:"360px",src:e});i.append(n)}),i}}},type:{"var":function(t,e){if(!e&&$(t).children().length>0)return function(t){return $.tmpl.type["var"](t,t.innerHTML)};e=e||$.tmpl.getVAR(t);var n=t.id;if(!n){if(null==e)return[];var r=$("<div>"),a=r.append(e+" ").html();return r.html(a.slice(0,-1)).contents()}var i=function(t,e){KhanUtil[t]&&Khan.error("Defining variable '"+t+"' overwrites utility property of same name."),VARS[t]=e};if(-1!==n.indexOf(",")){var o=n.split(/\s*,\s*/);$.each(o,function(t,n){n.length>0&&i(n,e[t])})}else i(n,e)}},getVAR:function(elem,ctx){function doEval(){with(Math)with(KhanUtil)with(ctx)with(VARS)return eval("(function() { return ("+code+"); })()")}var code=elem.nodeName?$(elem).text():elem;if(null==ctx&&(ctx={}),null!=Khan.query.debug)return doEval();try{return doEval()}catch(e){var info;elem.nodeName?(info=elem.nodeName.toLowerCase(),null!=elem.id&&elem.id.length>0&&(info+="#"+elem.id)):info=JSON.stringify(code),Khan.error("Error while evaluating "+info,e)}},getVarsHash:function(){return crc32(JSON.stringify($.map(VARS,function(t,e){return[e,String(t)]})))}},"undefined"!=typeof KhanUtil&&(KhanUtil.tmpl=$.tmpl),$.fn.tmplLoad=function(t,e){VARS={},$.tmpl.DATA_ENSURE_LOOPS=0,localMode=e.localMode,localMode&&($.tmpl.VARS=VARS)},$.fn.tmpl=function(){function t(n){var r=[],a=n.childNodes,i=e(n,r);if(i===!1)return t(n);if(void 0===i);else{if("object"==typeof i&&"undefined"!=typeof i.length)return n.parentNode&&($.each(i,function(t,e){e.nodeType&&n.parentNode.insertBefore(e,n)}),$.each(i,function(e,n){t(n)}),n.parentNode.removeChild(n)),null;if(i.items){var o=n.parentNode,l=n.nextSibling;return $.each(i.items,function(e,r){i.value&&(VARS[i.value]=r),i.pos&&(VARS[i.pos]=e);var a=$(n).clone(!0).removeAttr("data-each").removeData("each")[0],d=["data-if","data-else-if","data-else"],u="";u+=i.pos?"var "+i.pos+" = "+JSON.stringify(e)+";":"",u+=i.value?"var "+i.value+" = "+JSON.stringify(r)+";":"";for(var s=0;s<d.length;s++){var p=d[s];$(a).find("["+p+"]").each(function(){var t=$(this).attr(p);t="(function() { "+u+" return "+t+" })()",$(this).attr(p,t)})}$(a).find(".graphie").addBack().filter(".graphie").each(function(){var t=$(this).text();$(this).text(u+t)}),l?o.insertBefore(a,l):o.appendChild(a),t(a)}),i.value&&(VARS[i.value]=i.oldValue),i.pos&&(VARS[i.pos]=i.oldPos),$(n).remove(),null}}for(var d=0;d<a.length;d++)1===a[d].nodeType&&null===t(a[d])&&d--;for(var d=0,u=r.length;u>d;d++)if(r[d](n)===!1)return t(n);return n}function e(t,e){var n,r=$(t);for(var a in $.tmpl.attr)if($.tmpl.attr.hasOwnProperty(a)){var i;if(i=/^data-/.test(a)?r.data(a.replace(/^data-/,"")):r.attr(a),void 0!==i)if(n=$.tmpl.attr[a](t,i),"function"==typeof n)e.push(n);else if(void 0!==n)return n}var o=t.nodeName.toLowerCase();return null!=$.tmpl.type[o]&&(n=$.tmpl.type[o](t),"function"==typeof n&&e.push(n)),n}for(var n=0,r=this.length;r>n;n++)t(this[n]);return this},$.extend($.expr[":"],{inherited:function(t){return $(t).data("inherited")}}),$.fn.extend({tmplApply:function(t){t=t||{};var e=t.attribute||"id",n=t.defaultApply||"replace",r={};return this.each(function(){var t=$(this),a=t.attr(e),i=t.data("apply")&&!t.data("apply").indexOf("hint");a&&(a in r&&!i?(r[a]=$.tmplApplyMethods[t.data("apply")||n].call(r[a],this),null==r[a]&&delete r[a]):t.closest(":inherited").length>0&&(r[a]=this))})}}),$.extend({tmplApplyMethods:{remove:function(t){$(this).remove(),$(t).remove()},replace:function(t){return $(this).replaceWith(t),t},splice:function(t){$(this).replaceWith($(t).contents())},append:function(t){return $(this).append(t),this},appendContents:function(t){return $(this).append($(t).contents()),$(t).remove(),this},prepend:function(t){return $(this).prepend(t),this},prependContents:function(t){return $(this).prepend($(t).contents()),$(t).remove(),this},before:function(t){return $(this).before(t),this},beforeContents:function(t){return $(this).before($(t).contents()),$(t).remove(),this},after:function(t){return $(this).after(t),this},afterContents:function(t){return $(this).after($(t).contents()),$(t).remove(),this},appendVars:function(t){var e=$(this).data("ensure")||"1",n=$(t).data("ensure")||"1";return $(this).data("ensure","("+e+") && ("+n+")"),$.tmplApplyMethods.appendContents.call(this,t)},prependVars:function(t){var e=$(this).data("ensure")||"1",n=$(t).data("ensure")||"1";return $(this).data("ensure","("+n+") && ("+e+")"),$.tmplApplyMethods.prependContents.call(this,t)}}});
},{"./crc32.js":3}],17:[function(require,module,exports){
function computePrefixedTransform(){var r=document.createElement("div"),n=["transform","msTransform","MozTransform","WebkitTransform","OTransform"],e=null;return _.each(n,function(n){"undefined"!=typeof r.style[n]&&(e=n)}),e}function computeCanUse3dTransform(){var r=document.createElement("div"),n=KhanUtil.getPrefixedTransform();return r.style[n]="translateZ(0px)",!!r.style[n]}var prefixedTransform=null,canUse3dTransform=null;$.extend(KhanUtil,{getPrefixedTransform:function(){return prefixedTransform=prefixedTransform||computePrefixedTransform()},getCanUse3dTransform:function(){return null==canUse3dTransform&&(canUse3dTransform=computeCanUse3dTransform()),canUse3dTransform}});
},{}],18:[function(require,module,exports){
var objective_=require("./objective_.js"),kvector=require("./kvector.js");require("./transform-helpers.js");var PASS_TO_RAPHAEL=["attr","animate"],WrappedDefaults=_.extend({transform:function(e){var t=KhanUtil.getPrefixedTransform();this.wrapper.style[t]=e},toFront:function(){var e=this.wrapper.parentNode;e&&e.appendChild(this.wrapper)},toBack:function(){var e=this.wrapper.parentNode;e.firstChild!==this.wrapper&&e.insertBefore(this.wrapper,e.firstChild)},remove:function(){this.visibleShape.remove(),$(this.wrapper).remove()},getMouseTarget:function(){return this.visibleShape[0]},moveTo:function(e){var t=kvector.subtract(this.graphie.scalePoint(e),this.graphie.scalePoint(this.initialPoint)),r=KhanUtil.getCanUse3dTransform(),i="translateX("+t[0]+"px) translateY("+t[1]+"px)"+(r?" translateZ(0)":"");this.transform(i)},hide:function(){this.visibleShape.hide()},show:function(){this.visibleShape.show()}},objective_.mapObjectFromArray(PASS_TO_RAPHAEL,function(e){return function(){this.visibleShape[e].apply(this.visibleShape,arguments)}}));module.exports=WrappedDefaults;
},{"./kvector.js":11,"./objective_.js":14,"./transform-helpers.js":17}],19:[function(require,module,exports){
var WrappedDefaults=require("./wrapped-defaults.js"),kvector=require("./kvector.js"),DEFAULT_OPTIONS={maxScale:1,mouselayer:!1},WrappedEllipse=function(e,a,r,t){t=_.extend({},DEFAULT_OPTIONS,t),_.extend(this,e.fixedEllipse(a,r,t.maxScale),{graphie:e,initialPoint:a}),t.mouselayer?this.graphie.addToMouseLayerWrapper(this.wrapper):this.graphie.addToVisibleLayerWrapper(this.wrapper)};_.extend(WrappedEllipse.prototype,{animateTo:function(e,a,r){var t=kvector.subtract(this.graphie.scalePoint(e),this.graphie.scalePoint(this.initialPoint)),i=KhanUtil.getCanUse3dTransform(),p=this,s=null,l=null;$(this.wrapper).animate({cx:t[0],cy:t[1]},{duration:a,step:function(e,a){s="cx"===a.prop&&e||null!=s&&s||"cx"===a.prop&&a.start,l="cy"===a.prop&&e||null!=l&&l||"cy"===a.prop&&a.start;var t="translateX("+s+"px) translateY("+l+"px)"+(i?" translateZ(0)":"");p.transform(t);var n=p.graphie.unscalePoint(kvector.add(p.graphie.scalePoint(p.initialPoint),[s,l]));r&&r(n)}})}},WrappedDefaults),module.exports=WrappedEllipse;
},{"./kvector.js":11,"./wrapped-defaults.js":18}],20:[function(require,module,exports){
var WrappedDefaults=require("./wrapped-defaults.js"),kpoint=require("./kpoint.js"),kvector=require("./kvector.js");require("./transform-helpers.js");var DEFAULT_OPTIONS={thickness:2,mouselayer:!1},WrappedLine=function(e,t,r,a){a=_.extend({},DEFAULT_OPTIONS,a);var i=[e.range[0][0],0],n=[e.range[0][1],0];_.extend(this,e.fixedLine(i,n,a.thickness)),_.extend(this,{graphie:e,initialPoint:e.scalePoint(i),initialLength:kpoint.distanceToPoint(e.scalePoint(i),e.scalePoint(n))}),a.mouselayer?this.graphie.addToMouseLayerWrapper(this.wrapper):this.graphie.addToVisibleLayerWrapper(this.wrapper),this.moveTo(t,r)};_.extend(WrappedLine.prototype,WrappedDefaults,{getMouseTarget:function(){return this.wrapper},moveTo:function(e,t){var r=this.graphie.scalePoint(e),a=this.graphie.scalePoint(t),i=kvector.polarDegFromCart(kvector.subtract(a,r)),n=i[0],s=KhanUtil.bound(i[1]),o=kvector.subtract(r,this.initialPoint),p=KhanUtil.bound(n/this.initialLength),h=KhanUtil.getCanUse3dTransform(),l="translateX("+o[0]+"px) translateY("+o[1]+"px) "+(h?"translateZ(0) ":"")+"rotate("+s+"deg) scaleX("+p+") scaleY(1)";this.transform(l)}}),module.exports=WrappedLine;
},{"./kpoint.js":10,"./kvector.js":11,"./transform-helpers.js":17,"./wrapped-defaults.js":18}],21:[function(require,module,exports){
var WrappedDefaults=require("./wrapped-defaults.js"),DEFAULT_OPTIONS={center:null,createPath:null,mouselayer:!1},WrappedPath=function(e,a,r){r=_.extend({},DEFAULT_OPTIONS,r),_.extend(this,e.fixedPath(a,r.center,r.createPath)),_.extend(this,{graphie:e,initialPoint:e.scalePoint(_.head(a))}),r.mouselayer?this.graphie.addToMouseLayerWrapper(this.wrapper):this.graphie.addToVisibleLayerWrapper(this.wrapper)};_.extend(WrappedPath.prototype,WrappedDefaults),module.exports=WrappedPath;
},{"./wrapped-defaults.js":18}],22:[function(require,module,exports){
!function(t,e,n,o){function a(t){for(;t&&"undefined"!=typeof t.originalEvent;)t=t.originalEvent;return t}function i(e,n){var i,r,u,s,c,h,v,d,l=e.type;if(e=t.Event(e),e.type=n,i=e.originalEvent,r=t.event.props,l.search(/mouse/)>-1&&(r=I),i)for(v=r.length,s;v;)s=r[--v],e[s]=i[s];if(l.search(/mouse(down|up)|click/)>-1&&!e.which&&(e.which=1),-1!==l.search(/^touch/)&&(u=a(i),l=u.touches,c=u.changedTouches,h=l&&l.length?l[0]:c&&c.length?c[0]:o))for(d=0,len=Y.length;d<len;d++)s=Y[d],e[s]=h[s];return e}function r(e){for(var n,o,a={};e;){n=t.data(e,y);for(o in n)n[o]&&(a[o]=a.hasVirtualBinding=!0);e=e.parentNode}return a}function u(e,n){for(var o;e;){if(o=t.data(e,y),o&&(!n||o[n]))return e;e=e.parentNode}return null}function s(){V=!1}function c(){V=!0}function h(){z=0,L.length=0,S=!1,c()}function v(){s()}function d(){l(),B=setTimeout(function(){B=0,h()},t.vmouse.resetTimerDuration)}function l(){B&&(clearTimeout(B),B=0)}function f(e,n,o){var a;return(o&&o[e]||!o&&u(n.target,e))&&(a=i(n,e),t(n.target).trigger(a)),a}function p(e){var n=t.data(e.target,P);if(!(S||z&&z===n)){var o=f("v"+e.type,e);o&&(o.isDefaultPrevented()&&e.preventDefault(),o.isPropagationStopped()&&e.stopPropagation(),o.isImmediatePropagationStopped()&&e.stopImmediatePropagation())}}function g(e){var n,o,i=a(e).touches;if(i&&1===i.length&&(n=e.target,o=r(n),o.hasVirtualBinding)){z=q++,t.data(n,P,z),l(),v(),H=!1;var u=a(e).touches[0];N=u.pageX,x=u.pageY,f("vmouseover",e,o),f("vmousedown",e,o)}}function m(t){V||(H||f("vmousecancel",t,r(t.target)),H=!0,d())}function b(e){if(!V){var n=a(e).touches[0],o=H,i=t.vmouse.moveDistanceThreshold;H=H||Math.abs(n.pageX-N)>i||Math.abs(n.pageY-x)>i,flags=r(e.target),H&&!o&&f("vmousecancel",e,flags),f("vmousemove",e,flags),d()}}function D(t){if(!V){c();var e,n=r(t.target);if(f("vmouseup",t,n),!H){var o=f("vclick",t,n);o&&o.isDefaultPrevented()&&(e=a(t).changedTouches[0],L.push({touchID:z,x:e.clientX,y:e.clientY}),S=!0)}f("vmouseout",t,n),H=!1,d()}}function T(e){var n,o=t.data(e,y);if(o)for(n in o)if(o[n])return!0;return!1}function k(){}function w(e){var n=e.substr(1);return{setup:function(o,a){T(this)||t.data(this,y,{});var i=t.data(this,y);i[e]=!0,M[e]=(M[e]||0)+1,1===M[e]&&Q.bind(n,p),t(this).bind(n,k),j&&(M.touchstart=(M.touchstart||0)+1,1===M.touchstart&&Q.bind("touchstart",g).bind("touchend",D).bind("touchmove",b).bind("scroll",m))},teardown:function(o,a){--M[e],M[e]||Q.unbind(n,p),j&&(--M.touchstart,M.touchstart||Q.unbind("touchstart",g).unbind("touchmove",b).unbind("touchend",D).unbind("scroll",m));var i=t(this),r=t.data(this,y);r&&(r[e]=!1),i.unbind(n,k),T(this)||i.removeData(y)}}}var y="virtualMouseBindings",P="virtualTouchID",X="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),Y="clientX clientY pageX pageY screenX screenY".split(" "),E=t.event.mouseHooks?t.event.mouseHooks.props:[],I=t.event.props.concat(E),M={},B=0,N=0,x=0,H=!1,L=[],S=!1,V=!1,j="addEventListener"in n,Q=t(n),q=1,z=0;t.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};for(var A=0;A<X.length;A++)t.event.special[X[A]]=w(X[A]);j&&n.addEventListener("click",function(e){var n,o,a,i,r,u,s=L.length,c=e.target;if(s)for(n=e.clientX,o=e.clientY,threshold=t.vmouse.clickDistanceThreshold,a=c;a;){for(i=0;s>i;i++)if(r=L[i],u=0,a===c&&Math.abs(r.x-n)<threshold&&Math.abs(r.y-o)<threshold||t.data(a,P)===r.touchID)return e.preventDefault(),void e.stopPropagation();a=a.parentNode}},!0)}(jQuery,window,document);
},{}],23:[function(require,module,exports){
!function(){function t(){if(t.is(arguments[0],H)){for(var e=arguments[0],r=Zt[m](t,e.splice(0,3+t.is(e[0],q))),i=r.set(),s=0,n=e[S];n>s;s++){var a=e[s]||{};c[p](a.type)&&i[Y](r[a.type]().attr(a))}return i}return Zt[m](t,arguments)}function e(){for(var t=[],e=0;32>e;e++)t[e]=(~~(16*G.random()))[W](16);return t[12]=4,t[16]=(3&t[16]|8)[W](16),"r-"+t[T]("")}function r(t,e,r){function i(){var s=Array[f].slice.call(arguments,0),n=s[T]("►"),a=i.cache=i.cache||{},o=i.count=i.count||[];return a[p](n)?r?r(a[n]):a[n]:(o[S]>=1e3&&delete a[o.shift()],o[Y](n),a[n]=t[m](e,s),r?r(a[n]):a[n])}return i}function i(e,r,i,s,n){return n?t.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",e+n,r,i-2*n,n,-n,s-2*n,2*n-i,2*n-s):t.format("M{0},{1}l{2},0,0,{3},{4},0z",e,r,i,s,-i)}function s(){return this.x+_+this.y}function n(e){return function(r,i,s,n){var a={back:e};return t.is(s,"function")?n=s:a.rot=s,r&&r.constructor==Pt&&(r=r.attrs.path),r&&(a.along=r),this.animate(a,i,n)}}function a(t,e,r,i,s,n){function a(t){return((u*t+c)*t+l)*t}function o(t,e){var r=h(t,e);return((d*r+p)*r+f)*r}function h(t,e){var r,i,s,n,o,h;for(s=t,h=0;8>h;h++){if(n=a(s)-t,R(n)<e)return s;if(o=(3*u*s+2*c)*s+l,R(o)<1e-6)break;s-=n/o}if(r=0,i=1,s=t,r>s)return r;if(s>i)return i;for(;i>r;){if(n=a(s),R(n-t)<e)return s;t>n?r=s:i=s,s=(i-r)/2+r}return s}var l=3*e,c=3*(i-e)-l,u=1-l-c,f=3*r,p=3*(s-r)-f,d=1-f-p;return o(t,1/(200*n))}var o;o="".trim?function(t,e,r){t.setAttribute(e,String(r).trim())}:function(t,e,r){t.setAttribute(e,String(r))},t.version="1.5.2";var h,l=/[, ]+/,c={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},u=/\{(\d+)\}/g,f="prototype",p="hasOwnProperty",d=document,v=window,y={was:Object[f][p].call(v,"Raphael"),is:v.Raphael},g=function(){this.customAttributes={}},x="appendChild",m="apply",b="concat",k="createTouch"in d,w="",_=" ",B=String,C="split",A="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend"[C](_),N={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},T="join",S="length",M=B[f].toLowerCase,G=Math,E=G.max,z=G.min,R=G.abs,L=G.pow,j=G.PI,q="number",V="string",H="array",W="toString",F="fill",P=Object[f][W],Y="push",D=/^url\(['"]?([^\)]+?)['"]?\)$/i,X=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,O={NaN:1,Infinity:1,"-Infinity":1},I=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,$=G.round,U=parseFloat,Z=parseInt,Q=" progid:DXImageTransform.Microsoft",J=B[f].toUpperCase,K={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},tt={along:"along",blur:q,"clip-rect":"csv",cx:q,cy:q,fill:"colour","fill-opacity":q,"font-size":q,height:q,opacity:q,path:"path",r:q,rotation:"csv",rx:q,ry:q,scale:"csv",stroke:"colour","stroke-opacity":q,"stroke-width":q,translation:"csv",width:q,x:q,y:q},et="replace",rt=/^(from|to|\d+%?)$/,it=/\s*,\s*/,st={hs:1,rg:1},nt=/,?([achlmqrstvxz]),?/gi,at=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/gi,ot=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/gi,ht=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,lt=function(t,e){return t.key-e.key};if(t.type=v.SVGAngle||d.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==t.type){var ct,ut=d.createElement("div");if(ut.innerHTML='<v:shape adj="1"/>',ct=ut.firstChild,ct.style.behavior="url(#default#VML)",!ct||"object"!=typeof ct.adj)return t.type=null;ut=null}t.svg=!(t.vml="VML"==t.type),g[f]=t[f],h=g[f],t._id=0,t._oid=0,t.fn={},t.is=function(t,e){return e=M.call(e),"finite"==e?!O[p](+t):"null"==e&&null===t||e==typeof t||"object"==e&&t===Object(t)||"array"==e&&Array.isArray&&Array.isArray(t)||P.call(t).slice(8,-1).toLowerCase()==e},t.angle=function(e,r,i,s,n,a){if(null==n){var o=e-i,h=r-s;return o||h?(180*(0>o)+180*G.atan(-h/-o)/j+360)%360:0}return t.angle(e,r,n,a)-t.angle(i,s,n,a)},t.rad=function(t){return t%360*j/180},t.deg=function(t){return 180*t/j%360},t.snapTo=function(e,r,i){if(i=t.is(i,"finite")?i:10,t.is(e,H)){for(var s=e.length;s--;)if(R(e[s]-r)<=i)return e[s]}else{e=+e;var n=r%e;if(i>n)return r-n;if(n>e-i)return r-n+e}return r},t.setWindow=function(t){v=t,d=v.document};var ft=function(e){if(t.vml){var i,s=/^\s+|\s+$/g;try{var n=new ActiveXObject("htmlfile");n.write("<body>"),n.close(),i=n.body}catch(a){i=createPopup().document.body}var o=i.createTextRange();ft=r(function(t){try{i.style.color=B(t)[et](s,w);var e=o.queryCommandValue("ForeColor");return e=(255&e)<<16|65280&e|(16711680&e)>>>16,"#"+("000000"+e[W](16)).slice(-6)}catch(r){return"none"}})}else{var h=d.createElement("i");h.title="Raphaël Colour Picker",h.style.display="none",d.body[x](h),ft=r(function(t){return h.style.color=t,d.defaultView.getComputedStyle(h,w).getPropertyValue("color")})}return ft(e)},pt=function(){return"hsb("+[this.h,this.s,this.b]+")"},dt=function(){return"hsl("+[this.h,this.s,this.l]+")"},vt=function(){return this.hex};t.hsb2rgb=function(e,r,i,s){return t.is(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(i=e.b,r=e.s,e=e.h,s=e.o),t.hsl2rgb(e,r,i/2,s)},t.hsl2rgb=function(e,r,i,s){t.is(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(i=e.l,r=e.s,e=e.h),(e>1||r>1||i>1)&&(e/=360,r/=100,i/=100);var n,a,o,h={},l=["r","g","b"];if(r){n=.5>i?i*(1+r):i+r-i*r,a=2*i-n;for(var c=0;3>c;c++)o=e+1/3*-(c-1),0>o&&o++,o>1&&o--,1>6*o?h[l[c]]=a+6*(n-a)*o:1>2*o?h[l[c]]=n:2>3*o?h[l[c]]=a+(n-a)*(2/3-o)*6:h[l[c]]=a}else h={r:i,g:i,b:i};return h.r*=255,h.g*=255,h.b*=255,h.hex="#"+(16777216|h.b|h.g<<8|h.r<<16).toString(16).slice(1),t.is(s,"finite")&&(h.opacity=s),h.toString=vt,h},t.rgb2hsb=function(e,r,i){if(null==r&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(i=e.b,r=e.g,e=e.r),null==r&&t.is(e,V)){var s=t.getRGB(e);e=s.r,r=s.g,i=s.b}(e>1||r>1||i>1)&&(e/=255,r/=255,i/=255);var n,a,o=E(e,r,i),h=z(e,r,i),l=o;if(h==o)return{h:0,s:0,b:o,toString:pt};var c=o-h;return a=c/o,n=e==o?(r-i)/c:r==o?2+(i-e)/c:4+(e-r)/c,n/=6,0>n&&n++,n>1&&n--,{h:n,s:a,b:l,toString:pt}},t.rgb2hsl=function(e,r,i){if(null==r&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(i=e.b,r=e.g,e=e.r),null==r&&t.is(e,V)){var s=t.getRGB(e);e=s.r,r=s.g,i=s.b}(e>1||r>1||i>1)&&(e/=255,r/=255,i/=255);var n,a,o,h=E(e,r,i),l=z(e,r,i),c=(h+l)/2;if(l==h)o={h:0,s:0,l:c};else{var u=h-l;a=.5>c?u/(h+l):u/(2-h-l),n=e==h?(r-i)/u:r==h?2+(i-e)/u:4+(e-r)/u,n/=6,0>n&&n++,n>1&&n--,o={h:n,s:a,l:c}}return o.toString=dt,o},t._path2string=function(){return this.join(",")[et](nt,"$1")},t.getRGB=r(function(e){if(!e||(e=B(e)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if("none"==e)return{r:-1,g:-1,b:-1,hex:"none"};!(st[p](e.toLowerCase().substring(0,2))||"#"==e.charAt())&&(e=ft(e));var r,i,s,n,a,o,h=e.match(X);return h?(h[2]&&(s=Z(h[2].substring(5),16),i=Z(h[2].substring(3,5),16),r=Z(h[2].substring(1,3),16)),h[3]&&(s=Z((a=h[3].charAt(3))+a,16),i=Z((a=h[3].charAt(2))+a,16),r=Z((a=h[3].charAt(1))+a,16)),h[4]&&(o=h[4][C](it),r=U(o[0]),"%"==o[0].slice(-1)&&(r*=2.55),i=U(o[1]),"%"==o[1].slice(-1)&&(i*=2.55),s=U(o[2]),"%"==o[2].slice(-1)&&(s*=2.55),"rgba"==h[1].toLowerCase().slice(0,4)&&(n=U(o[3])),o[3]&&"%"==o[3].slice(-1)&&(n/=100)),h[5]?(o=h[5][C](it),r=U(o[0]),"%"==o[0].slice(-1)&&(r*=2.55),i=U(o[1]),"%"==o[1].slice(-1)&&(i*=2.55),s=U(o[2]),"%"==o[2].slice(-1)&&(s*=2.55),("deg"==o[0].slice(-3)||"°"==o[0].slice(-1))&&(r/=360),"hsba"==h[1].toLowerCase().slice(0,4)&&(n=U(o[3])),o[3]&&"%"==o[3].slice(-1)&&(n/=100),t.hsb2rgb(r,i,s,n)):h[6]?(o=h[6][C](it),r=U(o[0]),"%"==o[0].slice(-1)&&(r*=2.55),i=U(o[1]),"%"==o[1].slice(-1)&&(i*=2.55),s=U(o[2]),"%"==o[2].slice(-1)&&(s*=2.55),("deg"==o[0].slice(-3)||"°"==o[0].slice(-1))&&(r/=360),"hsla"==h[1].toLowerCase().slice(0,4)&&(n=U(o[3])),o[3]&&"%"==o[3].slice(-1)&&(n/=100),t.hsl2rgb(r,i,s,n)):(h={r:r,g:i,b:s},h.hex="#"+(16777216|s|i<<8|r<<16).toString(16).slice(1),t.is(n,"finite")&&(h.opacity=n),h)):{r:-1,g:-1,b:-1,hex:"none",error:1}},t),t.getColor=function(t){var e=this.getColor.start=this.getColor.start||{h:0,s:1,b:t||.75},r=this.hsb2rgb(e.h,e.s,e.b);return e.h+=.075,e.h>1&&(e.h=0,e.s-=.2,e.s<=0&&(this.getColor.start={h:0,s:1,b:e.b})),r.hex},t.getColor.reset=function(){delete this.start},t.parsePathString=r(function(e){if(!e)return null;var r={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},i=[];return t.is(e,H)&&t.is(e[0],H)&&(i=gt(e)),i[S]||B(e)[et](at,function(t,e,s){var n=[],a=M.call(e);for(s[et](ot,function(t,e){e&&n[Y](+e)}),"m"==a&&n[S]>2&&(i[Y]([e][b](n.splice(0,2))),a="l",e="m"==e?"l":"L");n[S]>=r[a]&&(i[Y]([e][b](n.splice(0,r[a]))),r[a]););}),i[W]=t._path2string,i}),t.findDotsAtSegment=function(t,e,r,i,s,n,a,o,h){var l=1-h,c=L(l,3)*t+3*L(l,2)*h*r+3*l*h*h*s+L(h,3)*a,u=L(l,3)*e+3*L(l,2)*h*i+3*l*h*h*n+L(h,3)*o,f=t+2*h*(r-t)+h*h*(s-2*r+t),p=e+2*h*(i-e)+h*h*(n-2*i+e),d=r+2*h*(s-r)+h*h*(a-2*s+r),v=i+2*h*(n-i)+h*h*(o-2*n+i),y=(1-h)*t+h*r,g=(1-h)*e+h*i,x=(1-h)*s+h*a,m=(1-h)*n+h*o,b=90-180*G.atan((f-d)/(p-v))/j;return(f>d||v>p)&&(b+=180),{x:c,y:u,m:{x:f,y:p},n:{x:d,y:v},start:{x:y,y:g},end:{x:x,y:m},alpha:b}};var yt=r(function(t){if(!t)return{x:0,y:0,width:0,height:0};t=Ct(t);for(var e,r=0,i=0,s=[],n=[],a=0,o=t[S];o>a;a++)if(e=t[a],"M"==e[0])r=e[1],i=e[2],s[Y](r),n[Y](i);else{var h=Bt(r,i,e[1],e[2],e[3],e[4],e[5],e[6]);s=s[b](h.min.x,h.max.x),n=n[b](h.min.y,h.max.y),r=e[5],i=e[6]}var l=z[m](0,s),c=z[m](0,n);return{x:l,y:c,width:E[m](0,s)-l,height:E[m](0,n)-c}}),gt=function(e){var r=[];t.is(e,H)&&t.is(e&&e[0],H)||(e=t.parsePathString(e));for(var i=0,s=e[S];s>i;i++){r[i]=[];for(var n=0,a=e[i][S];a>n;n++)r[i][n]=e[i][n]}return r[W]=t._path2string,r},xt=r(function(e){t.is(e,H)&&t.is(e&&e[0],H)||(e=t.parsePathString(e));var r=[],i=0,s=0,n=0,a=0,o=0;"M"==e[0][0]&&(i=e[0][1],s=e[0][2],n=i,a=s,o++,r[Y](["M",i,s]));for(var h=o,l=e[S];l>h;h++){var c=r[h]=[],u=e[h];if(u[0]!=M.call(u[0]))switch(c[0]=M.call(u[0]),c[0]){case"a":c[1]=u[1],c[2]=u[2],c[3]=u[3],c[4]=u[4],c[5]=u[5],c[6]=+(u[6]-i).toFixed(3),c[7]=+(u[7]-s).toFixed(3);break;case"v":c[1]=+(u[1]-s).toFixed(3);break;case"m":n=u[1],a=u[2];default:for(var f=1,p=u[S];p>f;f++)c[f]=+(u[f]-(f%2?i:s)).toFixed(3)}else{c=r[h]=[],"m"==u[0]&&(n=u[1]+i,a=u[2]+s);for(var d=0,v=u[S];v>d;d++)r[h][d]=u[d]}var y=r[h][S];switch(r[h][0]){case"z":i=n,s=a;break;case"h":i+=+r[h][y-1];break;case"v":s+=+r[h][y-1];break;default:i+=+r[h][y-2],s+=+r[h][y-1]}}return r[W]=t._path2string,r},0,gt),mt=r(function(e){t.is(e,H)&&t.is(e&&e[0],H)||(e=t.parsePathString(e));var r=[],i=0,s=0,n=0,a=0,o=0;"M"==e[0][0]&&(i=+e[0][1],s=+e[0][2],n=i,a=s,o++,r[0]=["M",i,s]);for(var h=o,l=e[S];l>h;h++){var c=r[h]=[],u=e[h];if(u[0]!=J.call(u[0]))switch(c[0]=J.call(u[0]),c[0]){case"A":c[1]=u[1],c[2]=u[2],c[3]=u[3],c[4]=u[4],c[5]=u[5],c[6]=+(u[6]+i),c[7]=+(u[7]+s);break;case"V":c[1]=+u[1]+s;break;case"H":c[1]=+u[1]+i;break;case"M":n=+u[1]+i,a=+u[2]+s;default:for(var f=1,p=u[S];p>f;f++)c[f]=+u[f]+(f%2?i:s)}else for(var d=0,v=u[S];v>d;d++)r[h][d]=u[d];switch(c[0]){case"Z":i=n,s=a;break;case"H":i=c[1];break;case"V":s=c[1];break;case"M":n=r[h][r[h][S]-2],a=r[h][r[h][S]-1];default:i=r[h][r[h][S]-2],s=r[h][r[h][S]-1]}}return r[W]=t._path2string,r},null,gt),bt=function(t,e,r,i){return[t,e,r,i,r,i]},kt=function(t,e,r,i,s,n){var a=1/3,o=2/3;return[a*t+o*r,a*e+o*i,a*s+o*r,a*n+o*i,s,n]},wt=function(t,e,i,s,n,a,o,h,l,c){var u,f=120*j/180,p=j/180*(+n||0),d=[],v=r(function(t,e,r){var i=t*G.cos(r)-e*G.sin(r),s=t*G.sin(r)+e*G.cos(r);return{x:i,y:s}});if(c)A=c[0],N=c[1],_=c[2],B=c[3];else{u=v(t,e,-p),t=u.x,e=u.y,u=v(h,l,-p),h=u.x,l=u.y;var y=(G.cos(j/180*n),G.sin(j/180*n),(t-h)/2),g=(e-l)/2,x=y*y/(i*i)+g*g/(s*s);x>1&&(x=G.sqrt(x),i=x*i,s=x*s);var m=i*i,k=s*s,w=(a==o?-1:1)*G.sqrt(R((m*k-m*g*g-k*y*y)/(m*g*g+k*y*y))),_=w*i*g/s+(t+h)/2,B=w*-s*y/i+(e+l)/2,A=G.asin(((e-B)/s).toFixed(9)),N=G.asin(((l-B)/s).toFixed(9));A=_>t?j-A:A,N=_>h?j-N:N,0>A&&(A=2*j+A),0>N&&(N=2*j+N),o&&A>N&&(A-=2*j),!o&&N>A&&(N-=2*j)}var M=N-A;if(R(M)>f){var E=N,z=h,L=l;N=A+f*(o&&N>A?1:-1),h=_+i*G.cos(N),l=B+s*G.sin(N),d=wt(h,l,i,s,n,0,o,z,L,[N,E,_,B])}M=N-A;var q=G.cos(A),V=G.sin(A),H=G.cos(N),W=G.sin(N),F=G.tan(M/4),P=4/3*i*F,Y=4/3*s*F,D=[t,e],X=[t+P*V,e-Y*q],O=[h+P*W,l-Y*H],I=[h,l];if(X[0]=2*D[0]-X[0],X[1]=2*D[1]-X[1],c)return[X,O,I][b](d);d=[X,O,I][b](d)[T]()[C](",");for(var $=[],U=0,Z=d[S];Z>U;U++)$[U]=U%2?v(d[U-1],d[U],p).y:v(d[U],d[U+1],p).x;return $},_t=function(t,e,r,i,s,n,a,o,h){var l=1-h;return{x:L(l,3)*t+3*L(l,2)*h*r+3*l*h*h*s+L(h,3)*a,y:L(l,3)*e+3*L(l,2)*h*i+3*l*h*h*n+L(h,3)*o}},Bt=r(function(t,e,r,i,s,n,a,o){var h,l=s-2*r+t-(a-2*s+r),c=2*(r-t)-2*(s-r),u=t-r,f=(-c+G.sqrt(c*c-4*l*u))/2/l,p=(-c-G.sqrt(c*c-4*l*u))/2/l,d=[e,o],v=[t,a];return R(f)>"1e12"&&(f=.5),R(p)>"1e12"&&(p=.5),f>0&&1>f&&(h=_t(t,e,r,i,s,n,a,o,f),v[Y](h.x),d[Y](h.y)),p>0&&1>p&&(h=_t(t,e,r,i,s,n,a,o,p),v[Y](h.x),d[Y](h.y)),l=n-2*i+e-(o-2*n+i),c=2*(i-e)-2*(n-i),u=e-i,f=(-c+G.sqrt(c*c-4*l*u))/2/l,p=(-c-G.sqrt(c*c-4*l*u))/2/l,R(f)>"1e12"&&(f=.5),R(p)>"1e12"&&(p=.5),f>0&&1>f&&(h=_t(t,e,r,i,s,n,a,o,f),v[Y](h.x),d[Y](h.y)),p>0&&1>p&&(h=_t(t,e,r,i,s,n,a,o,p),v[Y](h.x),d[Y](h.y)),{min:{x:z[m](0,v),y:z[m](0,d)},max:{x:E[m](0,v),y:E[m](0,d)}}}),Ct=r(function(t,e){for(var r=mt(t),i=e&&mt(e),s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a=(function(t,e){var r,i;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"][b](wt[m](0,[e.x,e.y][b](t.slice(1))));break;case"S":r=e.x+(e.x-(e.bx||e.x)),i=e.y+(e.y-(e.by||e.y)),t=["C",r,i][b](t.slice(1));break;case"T":e.qx=e.x+(e.x-(e.qx||e.x)),e.qy=e.y+(e.y-(e.qy||e.y)),t=["C"][b](kt(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"][b](kt(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"][b](bt(e.x,e.y,t[1],t[2]));break;case"H":t=["C"][b](bt(e.x,e.y,t[1],e.y));break;case"V":t=["C"][b](bt(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"][b](bt(e.x,e.y,e.X,e.Y))}return t}),o=function(t,e){if(t[e][S]>7){t[e].shift();for(var s=t[e];s[S];)t.splice(e++,0,["C"][b](s.splice(0,6)));t.splice(e,1),c=E(r[S],i&&i[S]||0)}},h=function(t,e,s,n,a){t&&e&&"M"==t[a][0]&&"M"!=e[a][0]&&(e.splice(a,0,["M",n.x,n.y]),s.bx=0,s.by=0,s.x=t[a][1],s.y=t[a][2],c=E(r[S],i&&i[S]||0))},l=0,c=E(r[S],i&&i[S]||0);c>l;l++){r[l]=a(r[l],s),o(r,l),i&&(i[l]=a(i[l],n)),i&&o(i,l),h(r,i,s,n,l),h(i,r,n,s,l);var u=r[l],f=i&&i[l],p=u[S],d=i&&f[S];s.x=u[p-2],s.y=u[p-1],s.bx=U(u[p-4])||s.x,s.by=U(u[p-3])||s.y,n.bx=i&&(U(f[d-4])||n.x),n.by=i&&(U(f[d-3])||n.y),n.x=i&&f[d-2],n.y=i&&f[d-1]}return i?[r,i]:r},null,gt),At=r(function(e){for(var r=[],i=0,s=e[S];s>i;i++){var n={},a=e[i].match(/^([^:]*):?([\d\.]*)/);if(n.color=t.getRGB(a[1]),n.color.error)return null;n.color=n.color.hex,a[2]&&(n.offset=a[2]+"%"),r[Y](n)}for(i=1,s=r[S]-1;s>i;i++)if(!r[i].offset){for(var o=U(r[i-1].offset||0),h=0,l=i+1;s>l;l++)if(r[l].offset){h=r[l].offset;break}h||(h=100,l=s),h=U(h);for(var c=(h-o)/(l-i+1);l>i;i++)o+=c,r[i].offset=o+"%"}return r}),Nt=function(e,r,i,s){var n;return t.is(e,V)||t.is(e,"object")?(n=t.is(e,V)?d.getElementById(e):e,n.tagName?null==r?{container:n,width:n.style.pixelWidth||n.offsetWidth,height:n.style.pixelHeight||n.offsetHeight}:{container:n,width:r,height:i}:void 0):{container:1,x:e,y:r,width:i,height:s}},Tt=function(t,e){var r=this;for(var i in e)if(e[p](i)&&!(i in t))switch(typeof e[i]){case"function":!function(e){t[i]=t===r?e:function(){return e[m](r,arguments)}}(e[i]);break;case"object":t[i]=t[i]||{},Tt.call(this,t[i],e[i]);break;default:t[i]=e[i]}},St=function(t,e){t==e.top&&(e.top=t.prev),t==e.bottom&&(e.bottom=t.next),t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next)},Mt=function(t,e){e.top!==t&&(St(t,e),t.next=null,t.prev=e.top,e.top.next=t,e.top=t)},Gt=function(t,e){e.bottom!==t&&(St(t,e),t.next=e.bottom,t.prev=null,e.bottom.prev=t,e.bottom=t)},Et=function(t,e,r){St(t,r),e==r.top&&(r.top=t),e.next&&(e.next.prev=t),t.next=e.next,t.prev=e,e.next=t},zt=function(t,e,r){St(t,r),e==r.bottom&&(r.bottom=t),e.prev&&(e.prev.next=t),t.prev=e.prev,e.prev=t,t.next=e},Rt=function(t){return function(){throw new Error("Raphaël: you are calling to method “"+t+"” of removed object")}};if(t.pathToRelative=xt,t.svg){h.svgns="http://www.w3.org/2000/svg",h.xlink="http://www.w3.org/1999/xlink",$=function(t){return+t+.5*(~~t===t)};var Lt=function(t,e){if(!e)return t=d.createElementNS(h.svgns,t),t.style.webkitTapHighlightColor="rgba(0,0,0,0)",t;for(var r in e)e[p](r)&&o(t,r,B(e[r]))};t[W]=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var jt=function(t,e){var r=Lt("path");e.canvas&&e.canvas[x](r);var i=new Pt(r,e);return i.type="path",Ht(i,{fill:"none",stroke:"#000",path:t}),i},qt=function(t,r,i){var s="linear",n=.5,a=.5,o=t.style;if(r=B(r)[et](ht,function(t,e,r){if(s="radial",e&&r){n=U(e),a=U(r);var i=2*(a>.5)-1;L(n-.5,2)+L(a-.5,2)>.25&&(a=G.sqrt(.25-L(n-.5,2))*i+.5)&&.5!=a&&(a=a.toFixed(5)-1e-5*i)}return w}),r=r[C](/\s*\-\s*/),"linear"==s){var h=r.shift();if(h=-U(h),isNaN(h))return null;var l=[0,0,G.cos(h*j/180),G.sin(h*j/180)],c=1/(E(R(l[2]),R(l[3]))||1);l[2]*=c,l[3]*=c,l[2]<0&&(l[0]=-l[2],l[2]=0),l[3]<0&&(l[1]=-l[3],l[3]=0)}var u=At(r);if(!u)return null;var f=t.getAttribute(F);f=f.match(/^url\(#(.*)\)$/),f&&i.defs.removeChild(d.getElementById(f[1]));var p=Lt(s+"Gradient");p.id=e(),Lt(p,"radial"==s?{fx:n,fy:a}:{x1:l[0],y1:l[1],x2:l[2],y2:l[3]}),i.defs[x](p);for(var v=0,y=u[S];y>v;v++){var g=Lt("stop");Lt(g,{offset:u[v].offset?u[v].offset:v?"100%":"0%","stop-color":u[v].color||"#fff"}),p[x](g)}return Lt(t,{fill:"url(#"+p.id+")",opacity:1,"fill-opacity":1}),o.fill=w,o.opacity=1,o.fillOpacity=1,1},Vt=function(e){var r=e.getBBox();Lt(e.pattern,{patternTransform:t.format("translate({0},{1})",r.x,r.y)})},Ht=function(r,i){var s={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},n=r.node,a=r.attrs,h=r.rotate(),c=function(t,e){if(e=s[M.call(e)]){for(var r=t.attrs["stroke-width"]||"1",a={round:r,square:r,butt:0}[t.attrs["stroke-linecap"]||i["stroke-linecap"]]||0,o=[],h=e[S];h--;)o[h]=e[h]*r+(h%2?1:-1)*a;Lt(n,{"stroke-dasharray":o[T](",")})}};i[p]("rotation")&&(h=i.rotation);var u=B(h)[C](l);u.length-1?(u[1]=+u[1],u[2]=+u[2]):u=null,U(h)&&r.rotate(0,!0);for(var f in i)if(i[p](f)){if(!K[p](f))continue;var v=i[f];switch(a[f]=v,f){case"blur":r.blur(v);break;case"rotation":r.rotate(v,!0);break;case"href":case"title":case"target":var y=n.parentNode;if("a"!=M.call(y.tagName)){var g=Lt("a");y.insertBefore(g,n),g[x](n),y=g}"target"==f&&"blank"==v?y.setAttributeNS(r.paper.xlink,"show","new"):y.setAttributeNS(r.paper.xlink,f,v);break;case"cursor":n.style.cursor=v;break;case"clip-rect":var m=B(v)[C](l);if(4==m[S]){r.clip&&r.clip.parentNode.parentNode.removeChild(r.clip.parentNode);var b=Lt("clipPath"),k=Lt("rect");b.id=e(),Lt(k,{x:m[0],y:m[1],width:m[2],height:m[3]}),b[x](k),r.paper.defs[x](b),Lt(n,{"clip-path":"url(#"+b.id+")"}),r.clip=k}if(!v){var A=d.getElementById(n.getAttribute("clip-path")[et](/(^url\(#|\)$)/g,w));A&&A.parentNode.removeChild(A),Lt(n,{"clip-path":w}),delete r.clip}break;case"path":"path"==r.type&&Lt(n,{d:v?a.path=mt(v):"M0,0"});break;case"width":if(o(n,f,v),!a.fx)break;f="x",v=a.x;case"x":a.fx&&(v=-a.x-(a.width||0));case"rx":if("rx"==f&&"rect"==r.type)break;case"cx":u&&("x"==f||"cx"==f)&&(u[1]+=v-a[f]),o(n,f,v),r.pattern&&Vt(r);break;case"height":if(o(n,f,v),!a.fy)break;f="y",v=a.y;case"y":a.fy&&(v=-a.y-(a.height||0));case"ry":if("ry"==f&&"rect"==r.type)break;case"cy":u&&("y"==f||"cy"==f)&&(u[2]+=v-a[f]),o(n,f,v),r.pattern&&Vt(r);break;case"r":"rect"==r.type?Lt(n,{rx:v,ry:v}):o(n,f,v);break;case"src":"image"==r.type&&n.setAttributeNS(r.paper.xlink,"href",v);break;case"stroke-width":n.style.strokeWidth=v,o(n,f,v),a["stroke-dasharray"]&&c(r,a["stroke-dasharray"]);break;case"stroke-dasharray":c(r,v);break;case"translation":var N=B(v)[C](l);N[0]=+N[0]||0,N[1]=+N[1]||0,u&&(u[1]+=N[0],u[2]+=N[1]),Ne.call(r,N[0],N[1]);break;case"scale":N=B(v)[C](l),r.scale(+N[0]||1,+N[1]||+N[0]||1,isNaN(U(N[2]))?null:+N[2],isNaN(U(N[3]))?null:+N[3]);break;case F:var G=B(v).match(D);if(G){b=Lt("pattern");var E=Lt("image");b.id=e(),Lt(b,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),Lt(E,{x:0,y:0}),E.setAttributeNS(r.paper.xlink,"href",G[1]),b[x](E);var z=d.createElement("img");z.style.cssText="position:absolute;left:-9999em;top-9999em",z.onload=function(){Lt(b,{width:this.offsetWidth,height:this.offsetHeight}),Lt(E,{width:this.offsetWidth,height:this.offsetHeight}),d.body.removeChild(this),r.paper.safari()},d.body[x](z),z.src=G[1],r.paper.defs[x](b),n.style.fill="url(#"+b.id+")",Lt(n,{fill:"url(#"+b.id+")"}),r.pattern=b,r.pattern&&Vt(r);break}var R=t.getRGB(v);if(R.error){if(({circle:1,ellipse:1}[p](r.type)||"r"!=B(v).charAt())&&qt(n,v,r.paper)){a.gradient=v,a.fill="none";break}}else delete i.gradient,delete a.gradient,!t.is(a.opacity,"undefined")&&t.is(i.opacity,"undefined")&&Lt(n,{opacity:a.opacity}),!t.is(a["fill-opacity"],"undefined")&&t.is(i["fill-opacity"],"undefined")&&Lt(n,{"fill-opacity":a["fill-opacity"]});R[p]("opacity")&&Lt(n,{"fill-opacity":R.opacity>1?R.opacity/100:R.opacity});case"stroke":R=t.getRGB(v),o(n,f,R.hex),"stroke"==f&&R[p]("opacity")&&Lt(n,{"stroke-opacity":R.opacity>1?R.opacity/100:R.opacity});break;case"gradient":(({circle:1,ellipse:1})[p](r.type)||"r"!=B(v).charAt())&&qt(n,v,r.paper);break;case"opacity":a.gradient&&!a[p]("stroke-opacity")&&Lt(n,{"stroke-opacity":v>1?v/100:v});case"fill-opacity":if(a.gradient){var L=d.getElementById(n.getAttribute(F)[et](/^url\(#|\)$/g,w));if(L){var j=L.getElementsByTagName("stop");o(j[j[S]-1],"stop-opacity",v)}break}default:"font-size"==f&&(v=Z(v,10)+"px");var q=f[et](/(\-.)/g,function(t){return J.call(t.substring(1))});n.style[q]=v,o(n,f,v)}}Ft(r,i),u?r.rotate(u.join(_)):U(h)&&r.rotate(h,!0)},Wt=1.2,Ft=function(e,r){if("text"==e.type&&(r[p]("text")||r[p]("font")||r[p]("font-size")||r[p]("x")||r[p]("y"))){var i=e.attrs,s=e.node,n=s.firstChild?Z(d.defaultView.getComputedStyle(s.firstChild,w).getPropertyValue("font-size"),10):10;if(r[p]("text")){for(i.text=r.text;s.firstChild;)s.removeChild(s.firstChild);for(var a=B(r.text)[C]("\n"),o=0,h=a[S];h>o;o++)if(a[o]){var l=Lt("tspan");o&&Lt(l,{dy:n*Wt,x:i.x}),l[x](d.createTextNode(a[o])),s[x](l)}}else for(a=s.getElementsByTagName("tspan"),o=0,h=a[S];h>o;o++)o&&Lt(a[o],{dy:n*Wt,x:i.x});Lt(s,{y:i.y});var c=e.getBBox(),u=i.y-(c.y+c.height/2);u&&t.is(u,"finite")&&Lt(s,{y:i.y+u})}},Pt=function(e,r){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.paper=r,this.attrs=this.attrs||{},this.transformations=[],this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1},!r.bottom&&(r.bottom=this),this.prev=r.top,r.top&&(r.top.next=this),r.top=this,this.next=null},Yt=Pt[f];Pt[f].rotate=function(e,r,i){if(this.removed)return this;if(null==e)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][T](_):this._.rt.deg;var s=this.getBBox();return e=B(e)[C](l),e[S]-1&&(r=U(e[1]),i=U(e[2])),e=U(e[0]),null!=r&&r!==!1?this._.rt.deg=e:this._.rt.deg+=e,null==i&&(r=null),this._.rt.cx=r,this._.rt.cy=i,r=null==r?s.x+s.width/2:r,i=null==i?s.y+s.height/2:i,this._.rt.deg?(this.transformations[0]=t.format("rotate({0} {1} {2})",this._.rt.deg,r,i),this.clip&&Lt(this.clip,{transform:t.format("rotate({0} {1} {2})",-this._.rt.deg,r,i)})):(this.transformations[0]=w,this.clip&&Lt(this.clip,{transform:w})),Lt(this.node,{transform:this.transformations[T](_)}),this},Pt[f].hide=function(){return!this.removed&&(this.node.style.display="none"),this},Pt[f].show=function(){return!this.removed&&(this.node.style.display=""),this},Pt[f].remove=function(){if(!this.removed){St(this,this.paper),this.node.parentNode.removeChild(this.node);for(var t in this)delete this[t];this.removed=!0}},Pt[f].getBBox=function(){if(this.removed)return this;if("path"==this.type)return yt(this.attrs.path);if("none"==this.node.style.display){this.show();var t=!0}var e={};try{e=this.node.getBBox()}catch(r){}finally{e=e||{}}if("text"==this.type){e={x:e.x,y:1/0,width:0,height:0};for(var i=0,s=this.node.getNumberOfChars();s>i;i++){var n=this.node.getExtentOfChar(i);n.y<e.y&&(e.y=n.y),n.y+n.height-e.y>e.height&&(e.height=n.y+n.height-e.y),n.x+n.width-e.x>e.width&&(e.width=n.x+n.width-e.x)}}return t&&this.hide(),e},Pt[f].attr=function(e,r){if(this.removed)return this;if(null==e){var i={};for(var s in this.attrs)this.attrs[p](s)&&(i[s]=this.attrs[s]);return this._.rt.deg&&(i.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(i.scale=this.scale()),i.gradient&&"none"==i.fill&&(i.fill=i.gradient)&&delete i.gradient,i}if(null==r&&t.is(e,V))return"translation"==e?Ne.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==F&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(null==r&&t.is(e,H)){for(var n={},a=0,o=e.length;o>a;a++)n[e[a]]=this.attr(e[a]);return n}if(null!=r){var h={};h[e]=r}else null!=e&&t.is(e,"object")&&(h=e);for(var l in this.paper.customAttributes)if(this.paper.customAttributes[p](l)&&h[p](l)&&t.is(this.paper.customAttributes[l],"function")){var c=this.paper.customAttributes[l].apply(this,[][b](h[l]));this.attrs[l]=h[l];for(var u in c)c[p](u)&&(h[u]=c[u])}return Ht(this,h),this},Pt[f].toFront=function(){if(this.removed)return this;this.node.parentNode[x](this.node);var t=this.paper;return t.top!=this&&Mt(this,t),this},Pt[f].toBack=function(){if(this.removed)return this;if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),Gt(this,this.paper);this.paper}return this},Pt[f].insertAfter=function(t){if(this.removed)return this;var e=t.node||t[t.length-1].node;return e.nextSibling?e.parentNode.insertBefore(this.node,e.nextSibling):e.parentNode[x](this.node),Et(this,t,this.paper),this},Pt[f].insertBefore=function(t){if(this.removed)return this;var e=t.node||t[0].node;return e.parentNode.insertBefore(this.node,e),zt(this,t,this.paper),this},Pt[f].blur=function(t){var r=this;if(0!==+t){var i=Lt("filter"),s=Lt("feGaussianBlur");r.attrs.blur=t,i.id=e(),Lt(s,{stdDeviation:+t||1.5}),i.appendChild(s),r.paper.defs.appendChild(i),r._blur=i,Lt(r.node,{filter:"url(#"+i.id+")"})}else r._blur&&(r._blur.parentNode.removeChild(r._blur),delete r._blur,delete r.attrs.blur),r.node.removeAttribute("filter")};var Dt=function(t,e,r,i){var s=Lt("circle");t.canvas&&t.canvas[x](s);var n=new Pt(s,t);return n.attrs={cx:e,cy:r,r:i,fill:"none",stroke:"#000"},n.type="circle",Lt(s,n.attrs),n},Xt=function(t,e,r,i,s,n){var a=Lt("rect");t.canvas&&t.canvas[x](a);var o=new Pt(a,t);return o.attrs={x:e,y:r,width:i,height:s,r:n||0,rx:n||0,ry:n||0,fill:"none",stroke:"#000"},o.type="rect",Lt(a,o.attrs),o},Ot=function(t,e,r,i,s){var n=Lt("ellipse");t.canvas&&t.canvas[x](n);var a=new Pt(n,t);return a.attrs={cx:e,cy:r,rx:i,ry:s,fill:"none",stroke:"#000"},a.type="ellipse",Lt(n,a.attrs),a},It=function(t,e,r,i,s,n){var a=Lt("image");Lt(a,{x:r,y:i,width:s,height:n,preserveAspectRatio:"none"}),a.setAttributeNS(t.xlink,"href",e),t.canvas&&t.canvas[x](a);var o=new Pt(a,t);return o.attrs={x:r,y:i,width:s,height:n,src:e},o.type="image",o},$t=function(t,e,r,i){var s=Lt("text");Lt(s,{x:e,y:r,"text-anchor":"middle"}),t.canvas&&t.canvas[x](s);var n=new Pt(s,t);return n.attrs={x:e,y:r,"text-anchor":"middle",text:i,font:K.font,stroke:"none",fill:"#000"},n.type="text",Ht(n,n.attrs),n},Ut=function(t,e){return this.width=t||this.width,this.height=e||this.height,o(this.canvas,"width",this.width),o(this.canvas,"height",this.height),this},Zt=function(){var e=Nt[m](0,arguments),r=e&&e.container,i=e.x,s=e.y,n=e.width,a=e.height;if(!r)throw new Error("SVG container not found.");var o=Lt("svg");return i=i||0,s=s||0,n=n||512,a=a||342,Lt(o,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:n,height:a}),1==r?(o.style.cssText="position:absolute;left:"+i+"px;top:"+s+"px",d.body[x](o)):r.firstChild?r.insertBefore(o,r.firstChild):r[x](o),r=new g,r.width=n,r.height=a,r.canvas=o,Tt.call(r,r,t.fn),r.clear(),r};h.clear=function(){for(var t=this.canvas;t.firstChild;)t.removeChild(t.firstChild);this.bottom=this.top=null,(this.desc=Lt("desc"))[x](d.createTextNode("Created with Raphaël")),t[x](this.desc),t[x](this.defs=Lt("defs"))},h.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=Rt(t)}}if(t.vml){var Qt={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Jt=/([clmz]),?([^clmz]*)/gi,Kt=/ progid:\S+Blur\([^\)]+\)/g,te=/-?[^,\s-]+/g,ee=1e3+_+1e3,re=10,ie={path:1,rect:1},se=function(t){var e=/[ahqstv]/gi,r=mt;if(B(t).match(e)&&(r=Ct),e=/[clmz]/g,r==mt&&!B(t).match(e)){var i=B(t)[et](Jt,function(t,e,r){var i=[],s="m"==M.call(e),n=Qt[e];return r[et](te,function(t){s&&2==i[S]&&(n+=i+Qt["m"==e?"l":"L"],i=[]),i[Y]($(t*re))}),n+i});return i}var s,n,a=r(t);i=[];for(var o=0,h=a[S];h>o;o++){s=a[o],n=M.call(a[o][0]),"z"==n&&(n="x");for(var l=1,c=s[S];c>l;l++)n+=$(s[l]*re)+(l!=c-1?",":w);i[Y](n)}return i[T](_)};t[W]=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version},jt=function(t,e){var r=ne("group");r.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",r.coordsize=e.coordsize,r.coordorigin=e.coordorigin;var i=ne("shape"),s=i.style;s.width=e.width+"px",s.height=e.height+"px",i.coordsize=ee,i.coordorigin=e.coordorigin,r[x](i);var n=new Pt(i,r,e),a={fill:"none",stroke:"#000"};return t&&(a.path=t),n.type="path",n.path=[],n.Path=w,Ht(n,a),e.canvas[x](r),n},Ht=function(e,r){e.attrs=e.attrs||{};var s,n=e.node,a=e.attrs,o=n.style,h=(r.x!=a.x||r.y!=a.y||r.width!=a.width||r.height!=a.height||r.r!=a.r)&&"rect"==e.type,c=e;for(var u in r)r[p](u)&&(a[u]=r[u]);if(h&&(a.path=i(a.x,a.y,a.width,a.height,a.r),e.X=a.x,e.Y=a.y,e.W=a.width,e.H=a.height),r.href&&(n.href=r.href),r.title&&(n.title=r.title),r.target&&(n.target=r.target),r.cursor&&(o.cursor=r.cursor),"blur"in r&&e.blur(r.blur),(r.path&&"path"==e.type||h)&&(n.path=se(a.path)),null!=r.rotation&&e.rotate(r.rotation,!0),r.translation&&(s=B(r.translation)[C](l),Ne.call(e,s[0],s[1]),null!=e._.rt.cx&&(e._.rt.cx+=+s[0],e._.rt.cy+=+s[1],e.setBox(e.attrs,s[0],s[1]))),r.scale&&(s=B(r.scale)[C](l),e.scale(+s[0]||1,+s[1]||+s[0]||1,+s[2]||null,+s[3]||null)),"clip-rect"in r){var f=B(r["clip-rect"])[C](l);if(4==f[S]){f[2]=+f[2]+ +f[0],f[3]=+f[3]+ +f[1];var v=n.clipRect||d.createElement("div"),y=v.style,g=n.parentNode;y.clip=t.format("rect({1}px {2}px {3}px {0}px)",f),n.clipRect||(y.position="absolute",y.top=0,y.left=0,y.width=e.paper.width+"px",y.height=e.paper.height+"px",g.parentNode.insertBefore(v,g),v[x](g),n.clipRect=v)}r["clip-rect"]||n.clipRect&&(n.clipRect.style.clip=w)}if("image"==e.type&&r.src&&(n.src=r.src),"image"==e.type&&r.opacity&&(n.filterOpacity=Q+".Alpha(opacity="+100*r.opacity+")",o.filter=(n.filterMatrix||w)+(n.filterOpacity||w)),r.font&&(o.font=r.font),r["font-family"]&&(o.fontFamily='"'+r["font-family"][C](",")[0][et](/^['"]+|['"]+$/g,w)+'"'),r["font-size"]&&(o.fontSize=r["font-size"]),r["font-weight"]&&(o.fontWeight=r["font-weight"]),r["font-style"]&&(o.fontStyle=r["font-style"]),null!=r.opacity||null!=r["stroke-width"]||null!=r.fill||null!=r.stroke||null!=r["stroke-width"]||null!=r["stroke-opacity"]||null!=r["fill-opacity"]||null!=r["stroke-dasharray"]||null!=r["stroke-miterlimit"]||null!=r["stroke-linejoin"]||null!=r["stroke-linecap"]){
n=e.shape||n;var m=n.getElementsByTagName(F)&&n.getElementsByTagName(F)[0],b=!1;if(!m&&(b=m=ne(F)),"fill-opacity"in r||"opacity"in r){var k=((+a["fill-opacity"]+1||2)-1)*((+a.opacity+1||2)-1)*((+t.getRGB(r.fill).o+1||2)-1);k=z(E(k,0),1),m.opacity=k}if(r.fill&&(m.on=!0),(null==m.on||"none"==r.fill)&&(m.on=!1),m.on&&r.fill){var _=r.fill.match(D);_?(m.src=_[1],m.type="tile"):(m.color=t.getRGB(r.fill).hex,m.src=w,m.type="solid",t.getRGB(r.fill).error&&(c.type in{circle:1,ellipse:1}||"r"!=B(r.fill).charAt())&&qt(c,r.fill)&&(a.fill="none",a.gradient=r.fill))}b&&n[x](m);var A=n.getElementsByTagName("stroke")&&n.getElementsByTagName("stroke")[0],N=!1;!A&&(N=A=ne("stroke")),(r.stroke&&"none"!=r.stroke||r["stroke-width"]||null!=r["stroke-opacity"]||r["stroke-dasharray"]||r["stroke-miterlimit"]||r["stroke-linejoin"]||r["stroke-linecap"])&&(A.on=!0),("none"==r.stroke||null==A.on||0==r.stroke||0==r["stroke-width"])&&(A.on=!1);var T=t.getRGB(r.stroke);A.on&&r.stroke&&(A.color=T.hex),k=((+a["stroke-opacity"]+1||2)-1)*((+a.opacity+1||2)-1)*((+T.o+1||2)-1);var M=.75*(U(r["stroke-width"])||1);if(k=z(E(k,0),1),null==r["stroke-width"]&&(M=a["stroke-width"]),r["stroke-width"]&&(A.weight=M),M&&1>M&&(k*=M)&&(A.weight=1),A.opacity=k,r["stroke-linejoin"]&&(A.joinstyle=r["stroke-linejoin"]||"miter"),A.miterlimit=r["stroke-miterlimit"]||8,r["stroke-linecap"]&&(A.endcap="butt"==r["stroke-linecap"]?"flat":"square"==r["stroke-linecap"]?"square":"round"),r["stroke-dasharray"]){var G={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};A.dashstyle=G[p](r["stroke-dasharray"])?G[r["stroke-dasharray"]]:w}N&&n[x](A)}if("text"==c.type)switch(o=c.paper.span.style,a.font&&(o.font=a.font),a["font-family"]&&(o.fontFamily=a["font-family"]),a["font-size"]&&(o.fontSize=a["font-size"]),a["font-weight"]&&(o.fontWeight=a["font-weight"]),a["font-style"]&&(o.fontStyle=a["font-style"]),c.node.string&&(c.paper.span.innerHTML=B(c.node.string)[et](/</g,"&#60;")[et](/&/g,"&#38;")[et](/\n/g,"<br>")),c.W=a.w=c.paper.span.offsetWidth,c.H=a.h=c.paper.span.offsetHeight,c.X=a.x,c.Y=a.y+$(c.H/2),a["text-anchor"]){case"start":c.node.style["v-text-align"]="left",c.bbx=$(c.W/2);break;case"end":c.node.style["v-text-align"]="right",c.bbx=-$(c.W/2);break;default:c.node.style["v-text-align"]="center"}},qt=function(t,e){t.attrs=t.attrs||{};var r,i=(t.attrs,"linear"),s=".5 .5";if(t.attrs.gradient=e,e=B(e)[et](ht,function(t,e,r){return i="radial",e&&r&&(e=U(e),r=U(r),L(e-.5,2)+L(r-.5,2)>.25&&(r=G.sqrt(.25-L(e-.5,2))*(2*(r>.5)-1)+.5),s=e+_+r),w}),e=e[C](/\s*\-\s*/),"linear"==i){var n=e.shift();if(n=-U(n),isNaN(n))return null}var a=At(e);if(!a)return null;if(t=t.shape||t.node,r=t.getElementsByTagName(F)[0]||ne(F),!r.parentNode&&t.appendChild(r),a[S]){r.on=!0,r.method="none",r.color=a[0].color,r.color2=a[a[S]-1].color;for(var o=[],h=0,l=a[S];l>h;h++)a[h].offset&&o[Y](a[h].offset+_+a[h].color);r.colors&&(r.colors.value=o[S]?o[T]():"0% "+r.color),"radial"==i?(r.type="gradientradial",r.focus="100%",r.focussize=s,r.focusposition=s):(r.type="gradient",r.angle=(270-n)%360)}return 1},Pt=function(e,r,i){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.X=0,this.Y=0,this.attrs={},this.Group=r,this.paper=i,this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1},!i.bottom&&(i.bottom=this),this.prev=i.top,i.top&&(i.top.next=this),i.top=this,this.next=null},Yt=Pt[f],Yt.rotate=function(t,e,r){return this.removed?this:null==t?this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][T](_):this._.rt.deg:(t=B(t)[C](l),t[S]-1&&(e=U(t[1]),r=U(t[2])),t=U(t[0]),null!=e?this._.rt.deg=t:this._.rt.deg+=t,null==r&&(e=null),this._.rt.cx=e,this._.rt.cy=r,this.setBox(this.attrs,e,r),this.Group.style.rotation=this._.rt.deg,this)},Yt.setBox=function(t,e,r){if(this.removed)return this;var i=this.Group.style,s=this.shape&&this.shape.style||this.node.style;t=t||{};for(var n in t)t[p](n)&&(this.attrs[n]=t[n]);e=e||this._.rt.cx,r=r||this._.rt.cy;var a,o,h,l,c=this.attrs;switch(this.type){case"circle":a=c.cx-c.r,o=c.cy-c.r,h=l=2*c.r;break;case"ellipse":a=c.cx-c.rx,o=c.cy-c.ry,h=2*c.rx,l=2*c.ry;break;case"image":a=+c.x,o=+c.y,h=c.width||0,l=c.height||0;break;case"text":this.textpath.v=["m",$(c.x),", ",$(c.y-2),"l",$(c.x)+1,", ",$(c.y-2)][T](w),a=c.x-$(this.W/2),o=c.y-this.H/2,h=this.W,l=this.H;break;case"rect":case"path":if(this.attrs.path){var u=yt(this.attrs.path);a=u.x,o=u.y,h=u.width,l=u.height}else a=0,o=0,h=this.paper.width,l=this.paper.height;break;default:a=0,o=0,h=this.paper.width,l=this.paper.height}e=null==e?a+h/2:e,r=null==r?o+l/2:r;var f,d=e-this.paper.width/2,v=r-this.paper.height/2;i.left!=(f=d+"px")&&(i.left=f),i.top!=(f=v+"px")&&(i.top=f),this.X=ie[p](this.type)?-d:a,this.Y=ie[p](this.type)?-v:o,this.W=h,this.H=l,ie[p](this.type)?(s.left!=(f=-d*re+"px")&&(s.left=f),s.top!=(f=-v*re+"px")&&(s.top=f)):"text"==this.type?(s.left!=(f=-d+"px")&&(s.left=f),s.top!=(f=-v+"px")&&(s.top=f)):(i.width!=(f=this.paper.width+"px")&&(i.width=f),i.height!=(f=this.paper.height+"px")&&(i.height=f),s.left!=(f=a-d+"px")&&(s.left=f),s.top!=(f=o-v+"px")&&(s.top=f),s.width!=(f=h+"px")&&(s.width=f),s.height!=(f=l+"px")&&(s.height=f))},Yt.hide=function(){return!this.removed&&(this.Group.style.display="none"),this},Yt.show=function(){return!this.removed&&(this.Group.style.display="block"),this},Yt.getBBox=function(){return this.removed?this:ie[p](this.type)?yt(this.attrs.path):{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}},Yt.remove=function(){if(!this.removed){St(this,this.paper),this.node.parentNode.removeChild(this.node),this.Group.parentNode.removeChild(this.Group),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var t in this)delete this[t];this.removed=!0}},Yt.attr=function(e,r){if(this.removed)return this;if(null==e){var i={};for(var s in this.attrs)this.attrs[p](s)&&(i[s]=this.attrs[s]);return this._.rt.deg&&(i.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(i.scale=this.scale()),i.gradient&&"none"==i.fill&&(i.fill=i.gradient)&&delete i.gradient,i}if(null==r&&t.is(e,"string"))return"translation"==e?Ne.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==F&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(this.attrs&&null==r&&t.is(e,H)){var n,a={};for(s=0,n=e[S];n>s;s++)a[e[s]]=this.attr(e[s]);return a}var o;if(null!=r&&(o={},o[e]=r),null==r&&t.is(e,"object")&&(o=e),o){for(var h in this.paper.customAttributes)if(this.paper.customAttributes[p](h)&&o[p](h)&&t.is(this.paper.customAttributes[h],"function")){var l=this.paper.customAttributes[h].apply(this,[][b](o[h]));this.attrs[h]=o[h];for(var c in l)l[p](c)&&(o[c]=l[c])}o.text&&"text"==this.type&&(this.node.string=o.text),Ht(this,o),o.gradient&&({circle:1,ellipse:1}[p](this.type)||"r"!=B(o.gradient).charAt())&&qt(this,o.gradient),(!ie[p](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this},Yt.toFront=function(){return!this.removed&&this.Group.parentNode[x](this.Group),this.paper.top!=this&&Mt(this,this.paper),this},Yt.toBack=function(){return this.removed?this:(this.Group.parentNode.firstChild!=this.Group&&(this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild),Gt(this,this.paper)),this)},Yt.insertAfter=function(t){return this.removed?this:(t.constructor==Te&&(t=t[t.length-1]),t.Group.nextSibling?t.Group.parentNode.insertBefore(this.Group,t.Group.nextSibling):t.Group.parentNode[x](this.Group),Et(this,t,this.paper),this)},Yt.insertBefore=function(t){return this.removed?this:(t.constructor==Te&&(t=t[0]),t.Group.parentNode.insertBefore(this.Group,t.Group),zt(this,t,this.paper),this)},Yt.blur=function(e){var r=this.node.runtimeStyle,i=r.filter;i=i.replace(Kt,w),0!==+e?(this.attrs.blur=e,r.filter=i+_+Q+".Blur(pixelradius="+(+e||1.5)+")",r.margin=t.format("-{0}px 0 0 -{0}px",$(+e||1.5))):(r.filter=i,r.margin=0,delete this.attrs.blur)},Dt=function(t,e,r,i){var s=ne("group"),n=ne("oval");n.style;s.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",s.coordsize=ee,s.coordorigin=t.coordorigin,s[x](n);var a=new Pt(n,s,t);return a.type="circle",Ht(a,{stroke:"#000",fill:"none"}),a.attrs.cx=e,a.attrs.cy=r,a.attrs.r=i,a.setBox({x:e-i,y:r-i,width:2*i,height:2*i}),t.canvas[x](s),a},Xt=function(t,e,r,s,n,a){var o=i(e,r,s,n,a),h=t.path(o),l=h.attrs;return h.X=l.x=e,h.Y=l.y=r,h.W=l.width=s,h.H=l.height=n,l.r=a,l.path=o,h.type="rect",h},Ot=function(t,e,r,i,s){var n=ne("group"),a=ne("oval");a.style;n.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",n.coordsize=ee,n.coordorigin=t.coordorigin,n[x](a);var o=new Pt(a,n,t);return o.type="ellipse",Ht(o,{stroke:"#000"}),o.attrs.cx=e,o.attrs.cy=r,o.attrs.rx=i,o.attrs.ry=s,o.setBox({x:e-i,y:r-s,width:2*i,height:2*s}),t.canvas[x](n),o},It=function(t,e,r,i,s,n){var a=ne("group"),o=ne("image");a.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",a.coordsize=ee,a.coordorigin=t.coordorigin,o.src=e,a[x](o);var h=new Pt(o,a,t);return h.type="image",h.attrs.src=e,h.attrs.x=r,h.attrs.y=i,h.attrs.w=s,h.attrs.h=n,h.setBox({x:r,y:i,width:s,height:n}),t.canvas[x](a),h},$t=function(e,r,i,s){var n=ne("group"),a=ne("shape"),o=a.style,h=ne("path"),l=(h.style,ne("textpath"));n.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",n.coordsize=ee,n.coordorigin=e.coordorigin,h.v=t.format("m{0},{1}l{2},{1}",$(10*r),$(10*i),$(10*r)+1),h.textpathok=!0,o.width=e.width,o.height=e.height,l.string=B(s),l.on=!0,a[x](l),a[x](h),n[x](a);var c=new Pt(l,n,e);return c.shape=a,c.textpath=h,c.type="text",c.attrs.text=s,c.attrs.x=r,c.attrs.y=i,c.attrs.w=1,c.attrs.h=1,Ht(c,{font:K.font,stroke:"none",fill:"#000"}),c.setBox(),e.canvas[x](n),c},Ut=function(t,e){var r=this.canvas.style;return t==+t&&(t+="px"),e==+e&&(e+="px"),r.width=t,r.height=e,r.clip="rect(0 "+t+" "+e+" 0)",this};var ne;d.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!d.namespaces.rvml&&d.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),ne=function(t){return d.createElement("<rvml:"+t+' class="rvml">')}}catch(ae){ne=function(t){return d.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}Zt=function(){var e=Nt[m](0,arguments),r=e.container,i=e.height,s=e.width,n=e.x,a=e.y;if(!r)throw new Error("VML container not found.");var o=new g,h=o.canvas=d.createElement("div"),l=h.style;return n=n||0,a=a||0,s=s||512,i=i||342,s==+s&&(s+="px"),i==+i&&(i+="px"),o.width=1e3,o.height=1e3,o.coordsize=1e3*re+_+1e3*re,o.coordorigin="0 0",o.span=d.createElement("span"),o.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",h[x](o.span),l.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",s,i),1==r?(d.body[x](h),l.left=n+"px",l.top=a+"px",l.position="absolute"):r.firstChild?r.insertBefore(h,r.firstChild):r[x](h),Tt.call(o,o,t.fn),o},h.clear=function(){this.canvas.innerHTML=w,this.span=d.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas[x](this.span),this.bottom=this.top=null},h.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=Rt(t);return!0}}var oe=navigator.userAgent.match(/Version\/(.*?)\s/);"Apple Computer, Inc."==navigator.vendor&&(oe&&oe[1]<4||"iP"==navigator.platform.slice(0,2))?h.safari=function(){var t=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});v.setTimeout(function(){t.remove()})}:h.safari=function(){};for(var he=function(){this.returnValue=!1},le=function(){return this.originalEvent.preventDefault()},ce=function(){this.cancelBubble=!0},ue=function(){return this.originalEvent.stopPropagation()},fe=function(){return d.addEventListener?function(t,e,r,i){var s=k&&N[e]?N[e]:e,n=function(s){if(k&&N[p](e))for(var n=0,a=s.targetTouches&&s.targetTouches.length;a>n;n++)if(s.targetTouches[n].target==t){var o=s;s=s.targetTouches[n],s.originalEvent=o,s.preventDefault=le,s.stopPropagation=ue;break}return r.call(i,s)};return t.addEventListener(s,n,!1),function(){return t.removeEventListener(s,n,!1),!0}}:d.attachEvent?function(t,e,r,i){var s=function(t){return t=t||v.event,t.preventDefault=t.preventDefault||he,t.stopPropagation=t.stopPropagation||ce,r.call(i,t)};t.attachEvent("on"+e,s);var n=function(){return t.detachEvent("on"+e,s),!0};return n}:void 0}(),pe=[],de=function(t){for(var e,r=t.clientX,i=t.clientY,s=d.documentElement.scrollTop||d.body.scrollTop,n=d.documentElement.scrollLeft||d.body.scrollLeft,a=pe.length;a--;){if(e=pe[a],k){for(var o,h=t.touches.length;h--;)if(o=t.touches[h],o.identifier==e.el._drag.id){r=o.clientX,i=o.clientY,(t.originalEvent?t.originalEvent:t).preventDefault();break}}else t.preventDefault();r+=n,i+=s,e.move&&e.move.call(e.move_scope||e.el,r-e.el._drag.x,i-e.el._drag.y,r,i,t)}},ve=function(e){t.unmousemove(de).unmouseup(ve);for(var r,i=pe.length;i--;)r=pe[i],r.el._drag={},r.end&&r.end.call(r.end_scope||r.start_scope||r.move_scope||r.el,e);pe=[]},ye=A[S];ye--;)!function(e){t[e]=Pt[f][e]=function(r,i){return t.is(r,"function")&&(this.events=this.events||[],this.events.push({name:e,f:r,unbind:fe(this.shape||this.node||d,e,r,i||this)})),this},t["un"+e]=Pt[f]["un"+e]=function(t){for(var r=this.events,i=r[S];i--;)if(r[i].name==e&&r[i].f==t)return r[i].unbind(),r.splice(i,1),!r.length&&delete this.events,this;return this}}(A[ye]);Yt.hover=function(t,e,r,i){return this.mouseover(t,r).mouseout(e,i||r)},Yt.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)},Yt.drag=function(e,r,i,s,n,a){return this._drag={},this.mousedown(function(o){(o.originalEvent||o).preventDefault();var h=d.documentElement.scrollTop||d.body.scrollTop,l=d.documentElement.scrollLeft||d.body.scrollLeft;this._drag.x=o.clientX+l,this._drag.y=o.clientY+h,this._drag.id=o.identifier,r&&r.call(n||s||this,o.clientX+l,o.clientY+h,o),!pe.length&&t.mousemove(de).mouseup(ve),pe.push({el:this,move:e,end:i,move_scope:s,start_scope:n,end_scope:a})}),this},Yt.undrag=function(e,r,i){for(var s=pe.length;s--;)pe[s].el==this&&pe[s].move==e&&pe[s].end==i&&pe.splice(s++,1);!pe.length&&t.unmousemove(de).unmouseup(ve)},h.circle=function(t,e,r){return Dt(this,t||0,e||0,r||0)},h.rect=function(t,e,r,i,s){return Xt(this,t||0,e||0,r||0,i||0,s||0)},h.ellipse=function(t,e,r,i){return Ot(this,t||0,e||0,r||0,i||0)},h.path=function(e){return e&&!t.is(e,V)&&!t.is(e[0],H)&&(e+=w),jt(t.format[m](t,arguments),this)},h.image=function(t,e,r,i,s){return It(this,t||"about:blank",e||0,r||0,i||0,s||0)},h.text=function(t,e,r){return $t(this,t||0,e||0,B(r))},h.set=function(t){return arguments[S]>1&&(t=Array[f].splice.call(arguments,0,arguments[S])),new Te(t)},h.setSize=Ut,h.top=h.bottom=null,h.raphael=t,Yt.resetScale=function(){return this.removed?this:(this._.sx=1,this._.sy=1,void(this.attrs.scale="1 1"))},Yt.scale=function(t,e,r,i){if(this.removed)return this;if(null==t&&null==e)return{x:this._.sx,y:this._.sy,toString:s};e=e||t,!+e&&(e=t);var n,a,h=this.attrs;if(0!=t){var l=this.getBBox(),c=l.x+l.width/2,u=l.y+l.height/2,f=R(t/this._.sx),p=R(e/this._.sy);r=+r||0==r?r:c,i=+i||0==i?i:u;var d=this._.sx>0,v=this._.sy>0,y=~~(t/R(t)),g=~~(e/R(e)),x=f*y,m=p*g,k=this.node.style,B=r+R(c-r)*x*(c>r==d?1:-1),C=i+R(u-i)*m*(u>i==v?1:-1),A=t*y>e*g?p:f;switch(this.type){case"rect":case"image":var N=h.width*f,M=h.height*p;this.attr({height:M,r:h.r*A,width:N,x:B-N/2,y:C-M/2});break;case"circle":case"ellipse":this.attr({rx:h.rx*f,ry:h.ry*p,r:h.r*A,cx:B,cy:C});break;case"text":this.attr({x:B,y:C});break;case"path":for(var G=xt(h.path),E=!0,z=d?x:f,L=v?m:p,j=0,q=G[S];q>j;j++){var V=G[j],H=J.call(V[0]);if("M"!=H||!E)if(E=!1,"A"==H)V[G[j][S]-2]*=z,V[G[j][S]-1]*=L,V[1]*=f,V[2]*=p,V[5]=+(y+g?!!+V[5]:!+V[5]);else if("H"==H)for(var W=1,F=V[S];F>W;W++)V[W]*=z;else if("V"==H)for(W=1,F=V[S];F>W;W++)V[W]*=L;else for(W=1,F=V[S];F>W;W++)V[W]*=W%2?z:L}var P=yt(G);n=B-P.x-P.width/2,a=C-P.y-P.height/2,G[0][1]+=n,G[0][2]+=a,this.attr({path:G})}this.type in{text:1,image:1}&&(1!=y||1!=g)?this.transformations?(this.transformations[2]="scale("[b](y,",",g,")"),o(this.node,"transform",this.transformations[T](_)),n=-1==y?-h.x-(N||0):h.x,a=-1==g?-h.y-(M||0):h.y,this.attr({x:n,y:a}),h.fx=y-1,h.fy=g-1):(this.node.filterMatrix=Q+".Matrix(M11="[b](y,", M12=0, M21=0, M22=",g,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')"),k.filter=(this.node.filterMatrix||w)+(this.node.filterOpacity||w)):this.transformations?(this.transformations[2]=w,o(this.node,"transform",this.transformations[T](_)),h.fx=0,h.fy=0):(this.node.filterMatrix=w,k.filter=(this.node.filterMatrix||w)+(this.node.filterOpacity||w)),h.scale=[t,e,r,i][T](_),this._.sx=t,this._.sy=e}return this},Yt.clone=function(){if(this.removed)return null;var t=this.attr();return delete t.scale,delete t.translation,this.paper[this.type]().attr(t)};var ge={},xe=function(e,r,i,s,n,a,o,h,l){if(e===i&&r===s&&n===o&&a==h){var c=o-e,u=h-r,f=Math.sqrt(c*c+u*u);if(null==l)return f;var p=l/f;return{start:{x:e,y:r},m:{x:e,y:r},n:{x:o,y:h},end:{x:o,y:h},x:e+p*c,y:r+p*u,alpha:90-180*G.atan(c/u)/j}}var d,v,y=0,g=100,x=[e,r,i,s,n,a,o,h].join(),m=ge[x];if(!m&&(ge[x]=m={data:[]}),m.timer&&clearTimeout(m.timer),m.timer=setTimeout(function(){delete ge[x]},2e3),null!=l){var b=xe(e,r,i,s,n,a,o,h);g=10*~~b}for(var k=0;g+1>k;k++){if(m.data[l]>k?v=m.data[k*g]:(v=t.findDotsAtSegment(e,r,i,s,n,a,o,h,k/g),m.data[k]=v),k&&(y+=L(L(d.x-v.x,2)+L(d.y-v.y,2),.5)),null!=l&&y>=l)return v;d=v}return null==l?y:void 0},me=function(e,r){return function(i,s,n){i=Ct(i);for(var a,o,h,l,c,u="",f={},p=0,d=0,v=i.length;v>d;d++){if(h=i[d],"M"==h[0])a=+h[1],o=+h[2];else{if(l=xe(a,o,h[1],h[2],h[3],h[4],h[5],h[6]),p+l>s){if(r&&!f.start){if(c=xe(a,o,h[1],h[2],h[3],h[4],h[5],h[6],s-p),u+=["C",c.start.x,c.start.y,c.m.x,c.m.y,c.x,c.y],n)return u;f.start=u,u=["M",c.x,c.y+"C",c.n.x,c.n.y,c.end.x,c.end.y,h[5],h[6]][T](),p+=l,a=+h[5],o=+h[6];continue}if(!e&&!r)return c=xe(a,o,h[1],h[2],h[3],h[4],h[5],h[6],s-p),{x:c.x,y:c.y,alpha:c.alpha}}p+=l,a=+h[5],o=+h[6]}u+=h}return f.end=u,c=e?p:r?f:t.findDotsAtSegment(a,o,h[1],h[2],h[3],h[4],h[5],h[6],1),c.alpha&&(c={x:c.x,y:c.y,alpha:c.alpha}),c}},be=me(1),ke=me(),we=me(0,1);Yt.getTotalLength=function(){return"path"==this.type?this.node.getTotalLength?this.node.getTotalLength():be(this.attrs.path):void 0},Yt.getPointAtLength=function(t){return"path"==this.type?ke(this.attrs.path,t):void 0},Yt.getSubpath=function(t,e){if("path"==this.type){if(R(this.getTotalLength()-e)<"1e-6")return we(this.attrs.path,t).end;var r=we(this.attrs.path,e,1);return t?we(r,t).end:r}},t.easing_formulas={linear:function(t){return t},"<":function(t){return L(t,3)},">":function(t){return L(t-1,3)+1},"<>":function(t){return t=2*t,1>t?L(t,3)/2:(t-=2,(L(t,3)+2)/2)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){t-=1;var e=1.70158;return t*t*((e+1)*t+e)+1},elastic:function(t){if(0==t||1==t)return t;var e=.3,r=e/4;return L(2,-10*t)*G.sin(2*(t-r)*j/e)+1},bounce:function(t){var e,r=7.5625,i=2.75;return 1/i>t?e=r*t*t:2/i>t?(t-=1.5/i,e=r*t*t+.75):2.5/i>t?(t-=2.25/i,e=r*t*t+.9375):(t-=2.625/i,e=r*t*t+.984375),e}};var _e=[],Be=function(){for(var e=+new Date,r=0;r<_e[S];r++){var i=_e[r];if(!i.stop&&!i.el.removed){var s,n=e-i.start,a=i.ms,o=i.easing,h=i.from,l=i.diff,c=i.to,u=i.t,f=i.el,d={};if(a>n){var v=o(n/a);for(var y in h)if(h[p](y)){switch(tt[y]){case"along":s=v*a*l[y],c.back&&(s=c.len-s);var g=ke(c[y],s);f.translate(l.sx-l.x||0,l.sy-l.y||0),l.x=g.x,l.y=g.y,f.translate(g.x-l.sx,g.y-l.sy),c.rot&&f.rotate(l.r+g.alpha,g.x,g.y);break;case q:s=+h[y]+v*a*l[y];break;case"colour":s="rgb("+[Ae($(h[y].r+v*a*l[y].r)),Ae($(h[y].g+v*a*l[y].g)),Ae($(h[y].b+v*a*l[y].b))][T](",")+")";break;case"path":s=[];for(var x=0,m=h[y][S];m>x;x++){s[x]=[h[y][x][0]];for(var b=1,k=h[y][x][S];k>b;b++)s[x][b]=+h[y][x][b]+v*a*l[y][x][b];s[x]=s[x][T](_)}s=s[T](_);break;case"csv":switch(y){case"translation":var B=v*a*l[y][0]-u.x,C=v*a*l[y][1]-u.y;u.x+=B,u.y+=C,s=B+_+C;break;case"rotation":s=+h[y][0]+v*a*l[y][0],h[y][1]&&(s+=","+h[y][1]+","+h[y][2]);break;case"scale":s=[+h[y][0]+v*a*l[y][0],+h[y][1]+v*a*l[y][1],2 in c[y]?c[y][2]:w,3 in c[y]?c[y][3]:w][T](_);break;case"clip-rect":for(s=[],x=4;x--;)s[x]=+h[y][x]+v*a*l[y][x]}break;default:var A=[].concat(h[y]);for(s=[],x=f.paper.customAttributes[y].length;x--;)s[x]=+A[x]+v*a*l[y][x]}d[y]=s}f.attr(d),f._run&&f._run.call(f)}else c.along&&(g=ke(c.along,c.len*!c.back),f.translate(l.sx-(l.x||0)+g.x-l.sx,l.sy-(l.y||0)+g.y-l.sy),c.rot&&f.rotate(l.r+g.alpha,g.x,g.y)),(u.x||u.y)&&f.translate(-u.x,-u.y),c.scale&&(c.scale+=w),f.attr(c),_e.splice(r--,1)}}t.svg&&f&&f.paper&&f.paper.safari(),_e[S]&&setTimeout(Be)},Ce=function(e,r,i,s,n){var a=i-s;r.timeouts.push(setTimeout(function(){t.is(n,"function")&&n.call(r),r.animate(e,a,e.easing)},s))},Ae=function(t){return E(z(t,255),0)},Ne=function(t,e){if(null==t)return{x:this._.tx,y:this._.ty,toString:s};switch(this._.tx+=+t,this._.ty+=+e,this.type){case"circle":case"ellipse":this.attr({cx:+t+this.attrs.cx,cy:+e+this.attrs.cy});break;case"rect":case"image":case"text":this.attr({x:+t+this.attrs.x,y:+e+this.attrs.y});break;case"path":var r=xt(this.attrs.path);r[0][1]+=+t,r[0][2]+=+e,this.attr({path:r})}return this};Yt.animateWith=function(t,e,r,i,s){for(var n=0,a=_e.length;a>n;n++)_e[n].el.id==t.id&&(e.start=_e[n].start);return this.animate(e,r,i,s)},Yt.animateAlong=n(),Yt.animateAlongBack=n(1),Yt.onAnimation=function(t){return this._run=t||0,this},Yt.animate=function(e,r,i,s){var n=this;if(n.timeouts=n.timeouts||[],(t.is(i,"function")||!i)&&(s=i||null),n.removed)return s&&s.call(n),n;var o={},h={},c=!1,u={};for(var f in e)if(e[p](f)&&(tt[p](f)||n.paper.customAttributes[p](f)))switch(c=!0,o[f]=n.attr(f),null==o[f]&&(o[f]=K[f]),h[f]=e[f],tt[f]){case"along":var d=be(e[f]),v=ke(e[f],d*!!e.back),y=n.getBBox();u[f]=d/r,u.tx=y.x,u.ty=y.y,u.sx=v.x,u.sy=v.y,h.rot=e.rot,h.back=e.back,h.len=d,e.rot&&(u.r=U(n.rotate())||0);break;case q:u[f]=(h[f]-o[f])/r;break;case"colour":o[f]=t.getRGB(o[f]);var g=t.getRGB(h[f]);u[f]={r:(g.r-o[f].r)/r,g:(g.g-o[f].g)/r,b:(g.b-o[f].b)/r};break;case"path":var x=Ct(o[f],h[f]);o[f]=x[0];var m=x[1];u[f]=[];for(var b=0,k=o[f][S];k>b;b++){u[f][b]=[0];for(var w=1,_=o[f][b][S];_>w;w++)u[f][b][w]=(m[b][w]-o[f][b][w])/r}break;case"csv":var A=B(e[f])[C](l),N=B(o[f])[C](l);switch(f){case"translation":o[f]=[0,0],u[f]=[A[0]/r,A[1]/r];break;case"rotation":o[f]=N[1]==A[1]&&N[2]==A[2]?N:[0,A[1],A[2]],u[f]=[(A[0]-o[f][0])/r,0,0];break;case"scale":e[f]=A,o[f]=B(o[f])[C](l),u[f]=[(A[0]-o[f][0])/r,(A[1]-o[f][1])/r,0,0];break;case"clip-rect":for(o[f]=B(o[f])[C](l),u[f]=[],b=4;b--;)u[f][b]=(A[b]-o[f][b])/r}h[f]=A;break;default:for(A=[].concat(e[f]),N=[].concat(o[f]),u[f]=[],b=n.paper.customAttributes[f][S];b--;)u[f][b]=((A[b]||0)-(N[b]||0))/r}if(c){var T=t.easing_formulas[i];if(!T)if(T=B(i).match(I),T&&5==T[S]){var M=T;T=function(t){return a(t,+M[1],+M[2],+M[3],+M[4],r)}}else T=function(t){return t};_e.push({start:e.start||+new Date,ms:r,easing:T,from:o,diff:u,to:h,el:n,t:{x:0,y:0}}),t.is(s,"function")&&(n._ac=setTimeout(function(){s.call(n)},r)),1==_e[S]&&setTimeout(Be)}else{var G,E=[];for(var z in e)e[p](z)&&rt.test(z)&&(f={value:e[z]},"from"==z&&(z=0),"to"==z&&(z=100),f.key=Z(z,10),E.push(f));for(E.sort(lt),E[0].key&&E.unshift({key:0,value:n.attrs}),b=0,k=E[S];k>b;b++)Ce(E[b].value,n,r/100*E[b].key,r/100*(E[b-1]&&E[b-1].key||0),E[b-1]&&E[b-1].value.callback);G=E[E[S]-1].value.callback,G&&n.timeouts.push(setTimeout(function(){G.call(n)},r))}return this},Yt.stop=function(){for(var t=0;t<_e.length;t++)_e[t].el.id==this.id&&_e.splice(t--,1);for(t=0,ii=this.timeouts&&this.timeouts.length;t<ii;t++)clearTimeout(this.timeouts[t]);return this.timeouts=[],clearTimeout(this._ac),delete this._ac,this},Yt.translate=function(t,e){return this.attr({translation:t+" "+e})},Yt[W]=function(){return"Raphaël’s object"},t.ae=_e;var Te=function(t){if(this.items=[],this[S]=0,this.type="set",t)for(var e=0,r=t[S];r>e;e++)!t[e]||t[e].constructor!=Pt&&t[e].constructor!=Te||(this[this.items[S]]=this.items[this.items[S]]=t[e],this[S]++)};Te[f][Y]=function(){for(var t,e,r=0,i=arguments[S];i>r;r++)t=arguments[r],!t||t.constructor!=Pt&&t.constructor!=Te||(e=this.items[S],this[e]=this.items[e]=t,this[S]++);return this},Te[f].pop=function(){return delete this[this[S]--],this.items.pop()};for(var Se in Yt)Yt[p](Se)&&(Te[f][Se]=function(t){return function(){for(var e=0,r=this.items[S];r>e;e++)this.items[e][t][m](this.items[e],arguments);return this}}(Se));Te[f].attr=function(e,r){if(e&&t.is(e,H)&&t.is(e[0],"object"))for(var i=0,s=e[S];s>i;i++)this.items[i].attr(e[i]);else for(var n=0,a=this.items[S];a>n;n++)this.items[n].attr(e,r);return this},Te[f].animate=function(e,r,i,s){(t.is(i,"function")||!i)&&(s=i||null);var n,a,o=this.items[S],h=o,l=this;for(s&&(a=function(){!--o&&s.call(l)}),i=t.is(i,V)?i:a,n=this.items[--h].animate(e,r,i,a);h--;)this.items[h]&&!this.items[h].removed&&this.items[h].animateWith(n,e,r,i,a);return this},Te[f].insertAfter=function(t){for(var e=this.items[S];e--;)this.items[e].insertAfter(t);return this},Te[f].getBBox=function(){for(var t=[],e=[],r=[],i=[],s=this.items[S];s--;){var n=this.items[s].getBBox();t[Y](n.x),e[Y](n.y),r[Y](n.x+n.width),i[Y](n.y+n.height)}return t=z[m](0,t),e=z[m](0,e),{x:t,y:e,width:E[m](0,r)-t,height:E[m](0,i)-e}},Te[f].clone=function(t){t=new Te;for(var e=0,r=this.items[S];r>e;e++)t[Y](this.items[e].clone());return t},t.registerFont=function(t){if(!t.face)return t;this.fonts=this.fonts||{};var e={w:t.w,face:{},glyphs:{}},r=t.face["font-family"];for(var i in t.face)t.face[p](i)&&(e.face[i]=t.face[i]);if(this.fonts[r]?this.fonts[r][Y](e):this.fonts[r]=[e],!t.svg){e.face["units-per-em"]=Z(t.face["units-per-em"],10);for(var s in t.glyphs)if(t.glyphs[p](s)){var n=t.glyphs[s];if(e.glyphs[s]={w:n.w,k:{},d:n.d&&"M"+n.d[et](/[mlcxtrv]/g,function(t){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[t]||"M"})+"z"},n.k)for(var a in n.k)n[p](a)&&(e.glyphs[s].k[a]=n.k[a])}}return t},h.getFont=function(e,r,i,s){if(s=s||"normal",i=i||"normal",r=+r||{normal:400,bold:700,lighter:300,bolder:800}[r]||400,t.fonts){var n=t.fonts[e];if(!n){var a=new RegExp("(^|\\s)"+e[et](/[^\w\d\s+!~.:_-]/g,w)+"(\\s|$)","i");for(var o in t.fonts)if(t.fonts[p](o)&&a.test(o)){n=t.fonts[o];break}}var h;if(n)for(var l=0,c=n[S];c>l&&(h=n[l],h.face["font-weight"]!=r||h.face["font-style"]!=i&&h.face["font-style"]||h.face["font-stretch"]!=s);l++);return h}},h.print=function(e,r,i,s,n,a,o){a=a||"middle",o=E(z(o||0,1),-1);var h,c=this.set(),u=B(i)[C](w),f=0;if(t.is(s,i)&&(s=this.getFont(s)),s){h=(n||16)/s.face["units-per-em"];for(var p=s.face.bbox.split(l),d=+p[0],v=+p[1]+("baseline"==a?p[3]-p[1]+ +s.face.descent:(p[3]-p[1])/2),y=0,g=u[S];g>y;y++){var x=y&&s.glyphs[u[y-1]]||{},m=s.glyphs[u[y]];f+=y?(x.w||s.w)+(x.k&&x.k[u[y]]||0)+s.w*o:0,m&&m.d&&c[Y](this.path(m.d).attr({fill:"#000",stroke:"none",translation:[f,0]}))}c.scale(h,h,d,v).translate(e-d,r-v)}return c},t.format=function(e,r){var i=t.is(r,H)?[0][b](r):arguments;return e&&t.is(e,V)&&i[S]-1&&(e=e[et](u,function(t,e){return null==i[++e]?w:i[e]})),e||w},t.ninja=function(){return y.was?v.Raphael=y.is:delete Raphael,t},t.el=Yt,t.st=Te[f],y.was?v.Raphael=t:Raphael=t}();
},{}]},{},[2]);
