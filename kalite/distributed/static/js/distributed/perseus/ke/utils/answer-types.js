(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function getTextSquish(e){return $(e).text().replace(/\s+/g,"")}function checkIfAnswerEmpty(e){return""===$.trim(e)||e instanceof Array&&""===$.trim(e.join("").replace(/,/g,""))}function addExamplesToInput(e,t){e.data("qtip")&&e.qtip("destroy",!0);var n=$('<ul class="examples" style="display: none"></ul>');_.each(t,function(e){n.append("<li>"+e+"</li>")}),e.qtip({content:{text:n.remove(),prerender:!0},style:{classes:"qtip-light leaf-tooltip"},position:{my:"top left",at:"bottom left"},show:{delay:0,effect:{length:0},event:"focus"},hide:{delay:0,event:"blur"},events:{render:function(){n.children().runModules()}}})}function numberAnswerType(e){return{setupFunctional:function(t,n,r){return Khan.answerTypes.number.setupFunctional(t,n,$.extend({},r,{forms:e}))},createValidatorFunctional:function(t,n){return Khan.answerTypes.number.createValidatorFunctional(t,$.extend({},n,{forms:e}))}}}var MAXERROR_EPSILON=Math.pow(2,-42),extractRawCode=function(e){var t=$(e).clone(!0),n=t.find("code");return n.length&&$.each(n,function(e,t){$(t).replaceWith('<code><script type="math/tex">'+KhanUtil.retrieveMathFormula(t)+"</script></code>")}),t.html()};Khan.answerTypes=$.extend(Khan.answerTypes,{text:{setupFunctional:function(e,t,n){var r;return r=window.Modernizr&&Modernizr.touchevents?$('<input type="text" autocapitalize="off">'):$('<input type="text">'),$(e).append(r),{validator:Khan.answerTypes.text.createValidatorFunctional(t,n),answer:function(){return r.val()},solution:$.trim(t),showGuess:function(e){r.val(void 0===e?"":e)}}},createValidatorFunctional:function(e,t){return t=$.extend({correctCase:"required"},t),e=$.trim(e),function(n){var r=null!=t.fallback?""+t.fallback:"";n=$.trim(n)||r;var a={empty:!1,correct:!1,message:null,guess:n};return n.toLowerCase()===e.toLowerCase()&&(e===n||"optional"===t.correctCase?a.correct=!0:n===n.toLowerCase()?a.message=$._("Your answer is almost correct, but must be in capital letters."):n===n.toUpperCase()?a.message=$._("Your answer is almost correct, but must not be in capital letters."):a.message=$._("Your answer is almost correct, but must be in the correct case.")),a}}},predicate:{defaultForms:"integer, proper, improper, mixed, decimal",setupFunctional:function(e,t,n){var r=$.extend({simplify:"required",ratio:!1,forms:Khan.answerTypes.predicate.defaultForms},n),a=r.forms.split(/\s*,\s*/);void 0===r.inexact&&(r.maxError=0),r.maxError=+r.maxError+MAXERROR_EPSILON;var i=$('<input type="text" autocapitalize="off">');$(e).append(i);var o={integer:$._("an integer, like <code>6</code>"),proper:function(){return"optional"===r.simplify?$._("a <em>proper</em> fraction, like <code>1/2</code> or <code>6/10</code>"):$._("a <em>simplified proper</em> fraction, like <code>3/5</code>")}(),improper:function(){return"optional"===r.simplify?$._("an <em>improper</em> fraction, like <code>10/7</code> or <code>14/8</code>"):$._("a <em>simplified improper</em> fraction, like <code>7/4</code>")}(),pi:$._("a multiple of pi, like <code>12\\ \\text{pi}</code> or <code>2/3\\ \\text{pi}</code>"),log:$._("an expression, like <code>\\log(100)</code>"),percent:$._("a percent, like <code>%(NUM)s\\%</code>",{NUM:KhanUtil.localeToFixed(12.34,2)}),mixed:$._("a mixed number, like <code>1\\ 3/4</code>"),decimal:function(){return void 0===r.inexact?$._("an <em>exact</em> decimal, like <code>%(NUM)s</code>",{NUM:KhanUtil.localeToFixed(.75,2)}):$._("a decimal, like <code>%(NUM)s</code>",{NUM:KhanUtil.localeToFixed(.75,2)})}()},s=[];return $.each(a,function(e,t){null!=o[t]&&s.push(o[t])}),r.forms!==Khan.answerTypes.predicate.defaultForms&&addExamplesToInput(i,s),{validator:Khan.answerTypes.predicate.createValidatorFunctional(t,n),answer:function(){return i.val()},solution:$.trim(t),showGuess:function(e){i.val(void 0===e?"":e)}}},createValidatorFunctional:function(e,t){t=$.extend({simplify:"required",ratio:!1,forms:Khan.answerTypes.predicate.defaultForms},t);var n;n=_.isArray(t.forms)?t.forms:t.forms.split(/\s*,\s*/),void 0===t.inexact&&(t.maxError=0),t.maxError=+t.maxError+MAXERROR_EPSILON,_.contains(n,"percent")&&(n=_.without(n,"percent"),n.push("percent")),e=_.isFunction(e)?e:KhanUtil.tmpl.getVAR(e);var r=function(e){e=e.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").replace(/(^\s*)|(\s*$)/gi,"");var n=e.match(/^([+-]?\d+)\s*\/\s*([+-]?\d+)$/),r=parseInt(e,10);if(n){var a=parseFloat(n[1]),i=parseFloat(n[2]),o=i>0&&(t.ratio||"1"!==n[2])&&1===KhanUtil.getGCD(a,i);return[{value:a/i,exact:o}]}return isNaN(r)||""+r!==e?[]:[{value:r,exact:!0}]},a={integer:function(e){var t=a.decimal(e),n=a.decimal(e,1);return null!=t[0].value&&t[0].value===n[0].value||null!=t[1].value&&t[1].value===n[1].value?t:[]},proper:function(e){return $.map(r(e),function(e){return Math.abs(e.value)<1?[e]:[]})},improper:function(e){return $.map(r(e),function(e){return Math.abs(e.value)>=1?[e]:[]})},pi:function(e){var t,n=[];if(e=e.replace(/\u2212/,"-"),t=e.match(/^([+-]?)\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))n=[{value:parseFloat(t[1]+"1"),exact:!0}];else if(t=e.match(/^([+-]?\s*\d+\s*(?:\/\s*[+-]?\s*\d+)?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i))n=r(t[1]);else if(t=e.match(/^([+-]?)\s*(\d+)\s*([+-]?\d+)\s*\/\s*([+-]?\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i)){var i=parseFloat(t[1]+"1"),o=parseFloat(t[2]),s=parseFloat(t[3]),c=parseFloat(t[4]),u=c>s&&1===KhanUtil.getGCD(s,c);n=[{value:i*(o+s/c),exact:u}]}else if(t=e.match(/^([+-]?\s*\d+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\s*\d+))?$/i))n=r(t[1]+"/"+t[3]);else if(t=e.match(/^([+-]?)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)\s*(?:\/\s*([+-]?\d+))?$/i))n=r(t[1]+"1/"+t[3]);else if("0"===e)n=[{value:0,exact:!0}];else{if(!(t=e.match(/^(.+)\s*\*?\s*(\\?pi|p|\u03c0|\\?tau|t|\u03c4|pau)$/i)))return n=_.reduce(Khan.answerTypes.predicate.defaultForms.split(/\s*,\s*/),function(t,n){return t.concat(a[n](e))},[]),$.each(n,function(e,t){t.piApprox=!0}),n;n=a.decimal(t[1])}var l=Math.PI;return e.match(/\\?tau|t|\u03c4/)&&(l=2*Math.PI),e.match(/pau/)&&(l=1.5*Math.PI),$.each(n,function(e,t){t.value*=l}),n},coefficient:function(e){var t=[];return e=e.replace(/\u2212/,"-"),""===e?t=[{value:1,exact:!0}]:"-"===e&&(t=[{value:-1,exact:!0}]),t},log:function(e){var t,n=[];return e=e.replace(/\u2212/,"-"),e=e.replace(/[ \(\)]/g,""),(t=e.match(/^log\s*(\S+)\s*$/i))?n=a.decimal(t[1]):"0"===e&&(n=[{value:0,exact:!0}]),n},percent:function(e){e=$.trim(e);var t=!1;e.indexOf("%")===e.length-1&&(e=$.trim(e.substring(0,e.length-1)),t=!0);var n=a.decimal(e);return $.each(n,function(e,n){n.exact=t,n.value=n.value/100}),n},mixed:function(e){var t=e.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?)(\d+)\s+(\d+)\s*\/\s*(\d+)$/);if(t){var n=parseFloat(t[1]+"1"),r=parseFloat(t[2]),a=parseFloat(t[3]),i=parseFloat(t[4]),o=i>a&&1===KhanUtil.getGCD(a,i);return[{value:n*(r+a/i),exact:o}]}return[]},decimal:function(e,n){null==n&&(n=1e10);var r=function(e){e=$.trim(e);var r=e.replace(/\u2212/,"-").replace(/([+-])\s+/g,"$1").match(/^([+-]?(?:\d{1,3}(?:[, ]?\d{3})*\.?|\d{0,3}(?:[, ]?\d{3})*\.(?:\d{3}[, ]?)*\d{1,3}))$/),a=e.match(/^0[0,]*,/);if(r&&!a){var i=parseFloat(r[1].replace(/[, ]/g,""));return void 0===t.inexact&&(i=Math.round(i*n)/n),i}},a=function(e){return e=e.replace(/([\.,])/g,function(e,t){return"."===t?",":"."}),r(e)};return[{value:r(e),exact:!0},{value:a(e),exact:!0}]}};return function(r){var i=null!=t.fallback?""+t.fallback:"";r=$.trim(r)||i;var o={empty:""===r,correct:!1,message:null,guess:r};if($.each(n,function(n,i){for(var s=a[i](r),c=0,u=s.length;u>c;c++){var l=s[c].value,p=s[c].exact,d=s[c].piApprox;if(e(l,t.maxError))return p||"optional"===t.simplify?(o.correct=!0,o.message=t.message||null,o.empty=!1):"percent"===i?(o.empty=!0,o.message=$._("Your answer is almost correct, but it is missing a <code>\\%</code> at the end.")):("enforced"!==t.simplify&&(o.empty=!0),o.message=$._("Your answer is almost correct, but it needs to be simplified.")),!1;d&&e(l,Math.abs(.001*l))&&(o.empty=!0,o.message=$._("Your answer is close, but you may have approximated pi. Enter your answer as a multiple of pi, like <code>12\\ \\text{pi}</code> or <code>2/3\\ \\text{pi}</code>"))}}),o.correct===!1){var s=!1;if(_.each(a,function(e){_.any(e(r),function(e){return null!=e.value&&!_.isNaN(e.value)})&&(s=!0)}),!s)return o.empty=!0,o.message=$._("We could not understand your answer. Please check your answer for extra text or symbols."),o}return o}}},number:{convertToPredicate:function(e,t){var n=parseFloat($.trim(e));return[function(e,t){return Math.abs(e-n)<t},$.extend({},t,{type:"predicate"})]},setupFunctional:function(e,t,n){var r=Khan.answerTypes.number.convertToPredicate(t,n);return Khan.answerTypes.predicate.setupFunctional(e,r[0],r[1])},createValidatorFunctional:function(e,t){return Khan.answerTypes.predicate.createValidatorFunctional.apply(Khan.answerTypes.predicate,Khan.answerTypes.number.convertToPredicate(e,t))}},decimal:numberAnswerType("decimal"),rational:numberAnswerType("integer, proper, improper, mixed"),improper:numberAnswerType("integer, proper, improper"),mixed:numberAnswerType("integer, proper, mixed"),regex:{setupFunctional:function(e,t,n){var r;return r=window.Modernizr&&Modernizr.touchevents?$('<input type="text" autocapitalize="off">'):$('<input type="text">'),$(e).append(r),{validator:Khan.answerTypes.regex.createValidatorFunctional(t,n),answer:function(){return r.val()},solution:$.trim(t),showGuess:function(e){r.val(void 0===e?"":e)}}},createValidatorFunctional:function(e,t){var n="";return null!=t.caseInsensitive&&(n+="i"),e=new RegExp($.trim(e),n),function(n){var r=null!=t.fallback?""+t.fallback:"";return n=$.trim(n)||r,{empty:!1,correct:null!=n.match(e),message:null,guess:n}}}},radical:{setupFunctional:function(e,t,n){var r=$.extend({simplify:"required"},n),a=$('<input type="text" autocapitalize="off">'),i=$('<input type="text" autocapitalize="off">'),o="required"===r.simplify?[$._("a simplified radical, like <code>\\sqrt{2}</code> or <code>3\\sqrt{5}</code>")]:[$._("a radical, like <code>\\sqrt{8}</code> or <code>2\\sqrt{2}</code>")];addExamplesToInput(a,o),addExamplesToInput(i,o),$("<div class='radical'>").append($("<span>").append(a)).append('<span class="surd">&radic;</span>').append($("<span>").append(i).addClass("overline")).appendTo(e);var s=parseFloat(t),c=KhanUtil.splitRadical(s);return{validator:Khan.answerTypes.radical.createValidatorFunctional(t,n),answer:function(){return[$.trim(a.val()),$.trim(i.val())]},solution:c,showGuess:function(e){a.val(e?e[0]:""),i.val(e?e[1]:"")}}},createValidatorFunctional:function(e,t){t=$.extend({simplify:"required"},t),e=parseFloat(e);var n=KhanUtil.splitRadical(e);return function(r){if(0===r[0].length&&0===r[1].length)return{empty:!0,correct:!1,message:null,guess:r};r[0]=r[0].length>0?r[0]:"1",r[1]=r[1].length>0?r[1]:"1";var a=parseFloat(r[0]),i=parseFloat(r[1]),o=Math.abs(a)*a*i===e,s=a===n[0]&&i===n[1],c={empty:!1,correct:!1,message:null,guess:r};return o&&(s||"optional"===t.simplify?c.correct=!0:c.message=$._("Your answer is almost correct, but it needs to be simplified.")),c}}},cuberoot:{setupFunctional:function(e,t,n){var r=$.extend({simplify:"required"},n),a=$('<input type="text" autocapitalize="off">'),i=$('<input type="text" autocapitalize="off">'),o="required"===r.simplify?[$._("a simplified radical, like <code>\\sqrt[3]{2}</code> or <code>3\\sqrt[3]{5}</code>")]:[$._("a radical, like <code>\\sqrt[3]{8}</code> or <code>2\\sqrt[3]{2}</code>")];addExamplesToInput(a,o),addExamplesToInput(i,o),$("<div class='radical'>").append($("<span>").append(a)).append('<span class="surd" style="vertical-align: 6px;"><code>\\sqrt[3]{}</code></span>').append($("<span>").append(i).addClass("overline")).appendTo(e).tex();var s=parseFloat(t),c=KhanUtil.splitCube(s);return{validator:Khan.answerTypes.cuberoot.createValidatorFunctional(t,n),answer:function(){return[a.val(),i.val()]},solution:c,showGuess:function(e){a.val(e?e[0]:""),i.val(e?e[1]:"")}}},createValidatorFunctional:function(e,t){t=$.extend({simplify:"required"},t),e=parseFloat(e);var n=KhanUtil.splitCube(e);return function(r){if(0===r[0].length&&0===r[1].length)return{empty:!0,correct:!1,message:null,guess:r};r[0]=r[0].length>0?r[0]:"1",r[1]=r[1].length>0?r[1]:"1";var a=parseFloat(r[0]),i=parseFloat(r[1]),o=Math.abs(a)*a*a*i===e,s=a===n[0]&&i===n[1],c={empty:!1,correct:!1,message:null,guess:r};return o&&(s||"optional"===t.simplify?c.correct=!0:c.message=$._("Your answer is almost correct, but it needs to be simplified.")),c}}},multiple:{setup:function(e,t){$(e).append($(t).clone(!0).texCleanup().contents().runModules());var n=[];return $(e).find(".sol").each(function(e){var r=$(this).data("type");r=null!=r?r:"number";var a=$(t).find(".sol").eq(e),i=$(this).empty(),o=Khan.answerTypes[r].setup(i,a);n.push(o)}),{validator:Khan.answerTypes.multiple.createValidator(t),answer:function(){var e=[];return $.each(n,function(t,n){e.push(n.answer())}),e},solution:function(){$.map(n,function(e){return e.solution})}(),showGuess:function(e){$.each(n,function(t,n){void 0!==e?n.showGuess(e[t]):n.showGuess()})},showCustomGuess:function(e){$.each(n,function(t,n){_.isFunction(n.showCustomGuess)&&(void 0!==e?n.showCustomGuess(e[t]):n.showCustomGuess())})}}},createValidator:function(e){var t=[];return $(e).find(".sol").each(function(){var e=$(this),n=e.data("type");n=null!=n?n:"number";var r=Khan.answerTypes[n].createValidator(e);t.push(r)}),function(e){var n={empty:!0,correct:!0,message:null,guess:e},r=null;return checkIfAnswerEmpty(e)?(n.empty=!0,n.correct=!1,n):($.each(e,function(e,a){var i=t[e](a);i.message&&i.empty?r=i.message:(n.empty=n.empty&&i.empty,n.correct=n.correct&&i.correct,n.message=n.message||i.message)}),n.correct&&null!=r?{empty:!0,correct:!1,message:r,guess:e}:(n.empty=!1,n))}}},set:{setup:function(e,t){$(e).append($(t).find(".input-format").clone(!0).texCleanup().contents().runModules());var n=[],r=[];$(e).find(".entry").each(function(){var e=$(this),t=$(this).data("type");t=null!=t?t:"number";var a=e.clone(!0),i=e.empty(),o=Khan.answerTypes[t].setup(i,a);n.push(o.answer),r.push(o.showGuess)});var a=[];return $(t).find(".set-sol").clone(!0).each(function(){var e=$(this).data("type");e=null!=e?e:"number";var t=$("<div>"),n=Khan.answerTypes[e].setup(t,$(this));a.push(n.solution)}),{validator:Khan.answerTypes.set.createValidator(t),answer:function(){var e=[];return $.each(n,function(t,n){e.push(n())}),e},solution:t,showGuess:function(e){$.each(r,function(t,n){void 0===e?n():n(e[t])})}}},createValidator:function(e){var t=[];return $(e).find(".set-sol").clone(!0).each(function(){var e=$(this).data("type");e=null!=e?e:"number";var n=Khan.answerTypes[e].createValidator($(this));t.push(n)}),function(e){var n={empty:0===t.length?!1:!0,correct:!0,message:null,guess:e},r=null,a=t.slice(0);return $.each(e,function(e,t){var i=!1;return $.each(a,function(e,n){var o=n(t);return o.empty&&o.message?(a.splice(e,1),r=o.message,i=!0,!1):o.correct?(i=o.correct,a.splice(e,1),!1):void(!o.correct&&o.message&&(i=o.message))}),checkIfAnswerEmpty(t)||checkIfAnswerEmpty(i)||(n.empty=!1),i||""===$.trim([t].join(""))?void("string"==typeof i&&(n.message=i,n.correct=!1)):(n.correct=!1,!1)}),t.length>e.length?a.length>t.length-e.length&&(n.correct=!1):a.length>0&&(n.correct=!1),n.correct&&null!=r?{empty:!0,correct:!1,message:r,guess:e}:n}}},radio:{setup:function(e,t){var n=$("<ul></ul>");$(e).append(n);var r,a=$(t).siblings(".choices"),i=a.clone(!0).texCleanup(),o=$(t).clone(!0).texCleanup(),s=o.text(),c=!!a.data("category");if(c){var u=getTextSquish(o);r=_.map(i.children().get(),function(e){return getTextSquish(e)===u?o[0]:e})}else r=o.get().concat(KhanUtil.shuffle(i.children().get()));var l=+a.data("show")||r.length,p=!!a.data("none"),d=_.uniq(r,!1,function(e){return getTextSquish(e)}),f=p&&d.length===l-1;if(d.length<l&&!f)return!1;d.length>l&&(d=d.slice(0,l)),c||(d=KhanUtil.shuffle(d));var m;_.each(d,function(e,t){e===o[0]&&(m=t)});var h=p&&m===l-1;if(p){var v=$("<span>").html($._("None of the above"));v.data("noneOfTheAbove",!0),h&&n.data("realAnswer",$("<span>").addClass("value").append(o.clone(!0).contents()));var g=d.length-1;f&&(g=d.length),d.splice(g,1,$("<span>").append(v))}var y=_.map(d,function(e,t){return $("<li><label></label></li>").find("label").append([$('<input type="radio" name="solution">').val(t),$('<span class="value"></span>').append($(e).contents())]).end()});return n.append(y).runModules(),{validator:Khan.answerTypes.radio.createValidator({solution:t,index:m,noneIsCorrect:h}),answer:function(){var e=n.find("input:checked");if(0===e.length)return null;var t=e.siblings(".value"),r=t.children().eq(0);return{isNone:r.data("noneOfTheAbove"),value:extractRawCode(t),index:+e.val()}},solution:s,showGuess:function(t){null==t?$(e).find("input:checked").attr("checked",!1):n.children().filter(function(){return t.index===$(this).find("input").val()}).find("input").attr("checked",!0)}}},createValidator:function(e){function t(){var e=$("#solutionarea").find("ul"),t=e.children().filter(function(){return $(this).find("span.value > span").data("noneOfTheAbove")}).find("input");t.next().fadeOut("fast",function(){var t=e.data("realAnswer");$(this).replaceWith(t),t.tex().fadeIn("fast")})}var n=extractRawCode(e.solution||e);return function(r){var a={empty:!1,correct:!1,message:null,guess:r};return null==r?(a.empty=!0,a):(r.index?r.isNone&&e.noneIsCorrect?(t(),a.correct=!0):a.correct=r.index===e.index:r.isNone&&null!=$("#solutionarea").find("ul").data("real-answer")?(t(),a.correct=!0):$.trim(r.value).replace(/\r\n?|\n/g,"")===$.trim(n.replace(/\r\n?|\n/g,""))?a.correct=!0:a.correct=!1,a)}}},list:{setupFunctional:function(e,t,n){var r=$("<select></select>");$(e).append(r);var a=$.tmpl.getVAR(n.choices);return $.each(a,function(e,t){r.append('<option value="'+t+'">'+t+"</option>")}),{validator:Khan.answerTypes.list.createValidatorFunctional(t,n),answer:function(){return r.val()},solution:$.trim(t),showGuess:function(e){r.val(void 0===e?"":e)}}},createValidatorFunctional:function(e,t){return e=$.trim(e),function(t){return t=$.trim(t),{empty:!1,correct:e===t,message:null,guess:t}}}},custom:{setup:function(e,t){t.find(".instruction").appendTo(e).runModules();var n=t.find(".guess").text(),r=t.find(".show-guess").text(),a=t.find(".show-guess-solutionarea").text();return{validator:Khan.answerTypes.custom.createValidator(t),answer:function(){return KhanUtil.tmpl.getVAR(n,KhanUtil.currentGraph)},solution:$.trim($(t).text()),showCustomGuess:function(e){var t="(function() { var guess = "+JSON.stringify(e)+";"+r+"})()";KhanUtil.tmpl.getVAR(t,KhanUtil.currentGraph)},showGuess:function(e){var t="(function() { var guess = "+JSON.stringify(e)+";"+a+"})()";KhanUtil.tmpl.getVAR(t,KhanUtil.currentGraph)}}},createValidator:function(e){var t=$(e).find(".validator-function").text(),n=function(e){var n="(function() { var guess = "+JSON.stringify(e)+";"+t+"})()";return KhanUtil.tmpl.getVAR(n,KhanUtil.currentGraph)};return function(e){var t=n(e);return"object"==typeof t?t:{empty:""===t,correct:t===!0,message:"string"==typeof t?t:null,guess:e}}}},primeFactorization:{setupFunctional:function(e,t,n){var r;r=window.Modernizr&&Modernizr.touchevents?$('<input type="text" autocapitalize="off">'):$('<input type="text">'),r.addClass("prime-factorization"),$(e).append(r);var a=[$._("a product of prime factors, like <code>2 \\times 3</code>"),$._("a single prime number, like <code>5</code>")];return addExamplesToInput(r,a),{validator:Khan.answerTypes.primeFactorization.createValidatorFunctional(t,n),answer:function(){return r.val()},solution:$.trim(t),showGuess:function(e){r.val(void 0===e?"":e)}}},createValidatorFunctional:function(e,t){return e=$.trim(e),function(t){t=t.split(" ").join("").toLowerCase(),t=t.replace(/{|}/g,""),t=t.split(/x|\*|\u00d7|\\times|\\cdot/);for(var n=[],r=0;r<t.length;r++){var a=t[r].split("^");if(a.length>1)for(var i=0;i<a[1];i++)n.push(a[0]);else n.push(t[r])}return t=KhanUtil.sortNumbers(n).join("x"),{empty:""===t,correct:t===e,message:null,guess:t}}}},checkbox:{setupFunctional:function(e,t,n){var r=$('<input type="checkbox">');return $(e).append(r),{validator:Khan.answerTypes.checkbox.createValidatorFunctional(t,n),answer:function(){return r.is(":checked")||""},solution:$.trim(t),showGuess:function(e){r.attr("checked",void 0===e?!1:e)}}},createValidatorFunctional:function(e,t){return e="true"===$.trim(e),function(t){var n={empty:!1,correct:!1,message:null,guess:t};return!!e==!!t?n.correct=!0:t?n.correct=!1:n.empty=!0,n}}},expression:{setup:function(e,t){var n=this._parseOptions($(t).data()),r=$('<span class="tex"/>'),a=$('<input type="text">'),i=$('<div class="error-div" style="display: none;"/>');$(e).append($('<span class="expression"/>').append($('<span class="output"/>').append(r),$('<span class="input"/>').append(a,i.append($('<i class="icon-exclamation-sign error-icon"/>')))));var o=null,s="",c=function(){clearTimeout(o);var e=KAS.parse(a.val(),n);if(e.parsed){l(),r.css({opacity:1});var t=e.expr.asTex(n);t!==s&&(r.empty().append($("<code>").text(t)).tex(),s=t)}else o=setTimeout(u,2e3),r.css({opacity:.5})},u=function(){i.is(":visible")||(i.show(),a.addClass("error"))},l=function(){i.is(":visible")&&(i.hide(),a.removeClass("error"))};a.on("input propertychange",c),a.on("keydown",function(e){var t=a[0],n=t.selectionStart,r=t.selectionEnd,i=void 0!==n;if(i&&8===e.which){var o=t.value;n===r&&"()"===o.slice(n-1,n+1)&&(e.preventDefault(),t.value=o.slice(0,n-1)+o.slice(n+1),t.selectionStart=n-1,t.selectionEnd=r-1,c())}}),a.on("keypress",function(e){var t=a[0],n=t.selectionStart,r=t.selectionEnd,i=void 0!==n;if(i&&40===e.which){var o=t.value;if(e.preventDefault(),n===r){var s=_.any([" ",")",""],function(e){return o.charAt(n)===e});t.value=o.slice(0,n)+(s?"()":"(")+o.slice(r)}else t.value=o.slice(0,n)+"("+o.slice(n,r)+")"+o.slice(r);t.selectionStart=n+1,t.selectionEnd=r+1,c()}else if(i&&41===e.which){var o=t.value;n===r&&")"===o.charAt(n)&&(e.preventDefault(),t.selectionStart=n+1,t.selectionEnd=r+1,c())}});var p=$._("For <code>2\\cdot2</code>, enter <strong>2*2</strong>");n.times&&(p=p.replace(/\\cdot/g,"\\times"));var d=[p,$._("For <code>3y</code>, enter <strong>3y</strong> or <strong>3*y</strong>"),$._("For <code>\\dfrac{1}{x}</code>, enter <strong>1/x</strong>"),$._("For <code>x^{y}</code>, enter <strong>x^y</strong>"),$._("For <code>\\sqrt{x}</code>, enter <strong>sqrt(x)</strong>"),$._("For <code>\\pi</code>, enter <strong>pi</strong>"),$._("For <code>\\sin \\theta</code>, enter <strong>sin(theta)</strong>"),$._("For <code>\\le</code> or <code>\\ge</code>, enter <strong><=</strong> or <strong>>=</strong>"),$._("For <code>\\neq</code>, enter <strong>=/=</strong>")];return addExamplesToInput(a,d),{validator:Khan.answerTypes.expression.createValidator(t),answer:function(){return a.val()},solution:t,showGuess:function(e){a.val(void 0===e?"":e)}}},parseSolution:function(e,t){var n=KAS.parse(e,t);if(!n.parsed)throw new Error("The provided solution ("+e+") didn't parse.");if(t.simplified&&!n.expr.isSimplified())throw new Error("The provided solution ("+e+") isn't fully expanded and simplified.");return n=n.expr},_parseOptions:function(e){var t=void 0!==e.form?e.form:e.sameForm,n=function(e){return null!=e&&e!==!1},r={form:n(t),simplify:n(e.simplify),times:n(e.times)};return _.isString(e.functions)?r.functions=_.compact(e.functions.split(/[ ,]+/)):_.isArray(e.functions)&&(r.functions=_.compact(e.functions)),r},createValidator:function(e){var t=$(e),n=[],r=this.createValidatorFunctional,a=this._parseOptions;if($(e).find(".set-sol").each(function(){var e=a($(this).data());n.push(r($(this).text(),e))}),0===n.length){var i=a(t.data());n.push(r(t.text(),i))}return function(e){var t={empty:!1,correct:!1,message:null,guess:e};return $.each(n,function(n,r){var a=r(e);return a.correct?(t.correct=!0,t.message=null,!1):(a.message&&(t.message=a.message),void(a.empty&&(t.empty=!0)))}),t}},createValidatorFunctional:function(e,t){return function(n){var r={empty:!1,correct:!1,message:null,guess:n};if(!n)return r.empty=!0,r;var a=KAS.parse(n,t);if(!a.parsed)return r.empty=!0,r;"string"==typeof e&&(e=Khan.answerTypes.expression.parseSolution(e,t));var i=KAS.compare(a.expr,e,t);if(i.equal)r.correct=!0;else if(i.message)r.message=i.message;else{var o=KAS.parse(n.replace(/[xX]/g,"*"),t);if(o.parsed){var s=KAS.compare(o.expr,e,t);s.equal?(r.empty=!0,r.message="I'm a computer. I only understand multiplication if you use an asterisk (*) as the multiplication sign."):s.message&&(r.message=s.message+" Also, I'm a computer. I only understand multiplication if you use an asterisk (*) as the multiplication sign.")}}return r}}}}),_.each(Khan.answerTypes,function(e,t){"setup"in e||(e.setup=function(t,n){var r=$(n);return e.setupFunctional(t,r.text(),r.data())}),"createValidator"in e||(e.createValidator=function(t){var n=$(t);return e.createValidatorFunctional(n.text(),n.data())})});
},{}]},{},[1]);
