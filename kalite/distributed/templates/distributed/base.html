<!DOCTYPE HTML>
{% load kalite_staticfiles %}
{% load i18n %}
{% load i18n_filters %}
<html>
    <head>
        <!--[if lt IE 9]>
              <script src="{% static "js/html5shiv.js" %}"></script>
        <![endif]-->

        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="wot-verification" content="075abe861486e6bb3ab9"/>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        {% block titletag %}
        <title>{% block title %}{% trans title %}{% endblock title %} | KA Lite</title>
        {% endblock %}

        <link rel="stylesheet" type="text/css" href="{% static 'css/jquery-ui/jquery-ui.min.css' True %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.min.css' True %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap-alerts.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/distributed/bootstrap-overrides.css' True %}">
        <!-- <link rel="stylesheet/less" type="text/css" href="{% static 'css/distributed/bootstrap-overrides.less' True %}"> -->
        <link rel="stylesheet" type="text/css" href="{% static 'css/distributed/khan-site.css' True %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/distributed/khan-lite.css' True %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/distributed/search_autocomplete.css' True %}">

        {% block headcss %}{% endblock headcss %}
        <link rel="shortcut icon" href="{% static "images/distributed/favicon.ico" %}">
        {# In some versions of IE, console isn't defined, which can lead to JS errors #}
        <script type="text/javascript">
            window.console = window.console || {log: function() {}};
        </script>


        {# Older versions of IE didn't have a JSON object, so this library adds it back in if needed #}
        <script type="text/javascript" src="{% static 'js/json2.js' %}"></script>
        <!-- JS translation file statically included as a back-up, so that if the saved file below isn't available, we don't choke. -->
        {% if current_language != "en" %}
        <script type="text/javascript" src="{% static 'js/i18n/en.js' %}"></script>
        {% endif %}
        <!-- JS translation files dynamically generated by django, then saved to the static file below -->
        <script type="text/javascript" src="{% static 'js/i18n/'|add:request.language|add:'.js' %}"></script>

        {# Use JS to help IE5.5-IE8 support modern browser features, especially for CSS and PNGs #}
        <!--[if lt IE 8]>
        {# <script src="{% static "js/IE8.js" %}"></script> #}
        <![endif]-->

        <script type="text/javascript">
            window.onerror=function(msg){
                window.js_errors = window.js_errors || [];
                window.js_errors.push(msg);
            }
        </script>
        {% block jqueryjs %}
        <script type="text/javascript" src="{% static 'js/jquery-1.9.1.min.js' %}"></script>
        <script type="text/javascript">
            jQuery.migrateMute = {% if settings.DEBUG %}false{% else %}true{% endif %};
        </script>
        {% endblock jqueryjs %}
        <script type="text/javascript" src="{% static 'js/underscore-min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/backbone-min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/jquery-ui/jquery-ui.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/bootstrap.min.js' %}"></script>

        <script>
         // the following variables are used by functions in distributed-server.js,
         //    khan-lite.js, and search_autocomplete.js.
         // TODO(jamalex): include these in some Backbone Model state instead, synced via AJAX
         var DELETE_USERS_URL            = "{% url 'delete_users' %}";
         var DELETE_GROUPS_URL           = "{% url 'group_delete' %}";
         var FORCE_SYNC_URL              = "{% url 'api_force_sync' %}";
         var GET_EXERCISE_LOGS_URL       = "{% url 'get_exercise_logs' %}";
         var GET_VIDEO_LOGS_URL          = "{% url 'get_video_logs' %}";
         var INSTALLED_LANGUAGES_URL     = "{% url 'installed_language_packs' %}";
         var LOCAL_DEVICE_MANAGEMENT_URL = "{% url 'device_redirect' %}";
         var MOVE_TO_GROUP_URL           = "{% url 'move_to_group' %}";
         var SAVE_EXERCISE_LOG_URL       = "{% url 'save_exercise_log' %}";
         var SAVE_VIDEO_LOG_URL          = "{% url 'save_video_log' %}";
         var SEARCH_TOPICS_URL           = "{% url 'flat_topic_tree' lang_code=current_language %}";
         var SET_DEFAULT_LANGUAGE_URL    = "{% url 'set_default_language' %}"
         var STATUS_URL                  = "{% url 'status' %}";
         var USER_LOGIN_URL              = "{% url 'login' %}";

         var SERVER_INFO_PATH    = "{% url 'get_server_info' %}";
         var CENTRAL_SERVER_HOST = "{{ central_server_host }}";
         var SECURESYNC_PROTOCOL = "{{ securesync_protocol }}";
         var CURRENT_LANGUAGE = "{{ current_language }}";
        </script>
        <script type="text/javascript" src="{% static 'js/less.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/sprintf.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/purl.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/modernizr.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/jquery.ui.autocomplete.html.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/khan-lite.js' True %}"></script>
        <script type="text/javascript" src="{% static 'js/distributed/distributed-server.js' True %}"></script>
        <script type="text/javascript" src="{% static 'js/distributed/search_autocomplete.js' True %}"></script>

        {% block headjs %}{% endblock headjs %}
        {% block analytics %}{% endblock analytics %}
    </head>

    <body class="{% block bodyclass %}{% endblock %}">

        <div class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>

                    <a class="navbar-brand" href="/" title="{% trans 'KA Lite Home' %}">
                        <img src="{% static "images/distributed/horizontal-logo-small.png" %}" alt="{% trans 'KA Lite logo' %}">
                        <div class="pull-right visible-xs" id="sitepoints-xs"></div>
                    </a>
                </div>
                <div class="collapse navbar-collapse">
                    <ul class="nav navbar-nav navbar-right">
                        {% block sitewide_navigation %}

                        <li>
                            <form action="{% url 'search' %}" method="GET" id="search-box">
                            {% comment %}Translators: this will appear in the navigation bar. Please try to keep it as short as possible.{% endcomment %}
                                <input type="text" name="query" class="search-js" id="search" placeholder="{% trans 'video, topic, or exercise...' %}" />
                                <a class="btn btn-success btn-xs search-js" id="search-button" href="#" />{% trans 'Search' %}</a>
                                <span class="glyphicon glyphicon-search" id="glyphicon-search-js" title="{% trans 'Search by keyword' %}"></span>
                            </form>
                        </li>

                        {% comment %}Translators: this will appear in the navigation bar. Please try to keep it as short as possible.{% endcomment %}
                        <li><a href="{% url 'homepage' %}" id="nav_home" class="home-navlink not-admin-only {% block home_active %}{% endblock home_active %}" title="{% trans 'KA Lite Homepage' %}">{% trans "Home" %}</a></li>

                        {% comment %}Translators: this will appear in the navigation bar. Please try to keep it as short as possible.{% endcomment %}
                        <li><a href="{% url 'watch_home' %}" id="nav_watch" class="watch-navlink not-admin-only {% block watch_active %}{% endblock watch_active %}" title="{% trans 'Watch Videos' %}">{% trans "Watch" %}</a></li>

                        {% comment %}Translators: this will appear in the navigation bar. Please try to keep it as short as possible.{% endcomment %}
                        <li><a href="{% url 'exercise_dashboard' %}" id="nav_practice" class="practice-navlink not-admin-only {% block practice_active %}{% endblock practice_active %}" title="{% trans 'Practice Lessons' %}">{% trans "Practice" %}</a></li>

                        {% comment %}Translators: this will appear in the navigation bar. Please try to keep it as short as possible.{% endcomment %}
                        <li><a href="{% url 'zone_redirect' %}" id="nav_manage_zone" class="admin-only {% block control_panel_active %}{% endblock control_panel_active %}" title="{% trans 'Manage KA Lite' %}">{% trans "Overview" %}</a></li>

                        {% comment %}Translators: this will appear in the navigation bar. Please try to keep it as short as possible.{% endcomment %}
                        <li><a href="{% url 'facility_management' zone_id='None' facility_id='None' %}" id="nav_manage_zone" class="admin-only {% block users_active %}{% endblock users_active %}" title="{% trans 'Manage Users' %}">{% trans "Users" %}</a></li>

                        {% comment %}Translators: this will appear in the navigation bar. Please try to keep it as short as possible.{% endcomment %}
                        <li><a href="{% url 'update_videos' %}" id="nav_update" class="admin-only {% block update_active %}{% endblock update_active %}" title="{% trans 'Update this server with new videos and languages' %}">{% trans "Videos" %}</a></li>

                        {% comment %}Translators: this will appear in the navigation bar. Please try to keep it as short as possible.{% endcomment %}
                        <li><a href="{% url 'update_languages' %}" id="nav_languages" class="admin-only {% block languages_active %}{% endblock languages_active %}" title="{% trans 'Update this server with new languages' %}">{% trans "Languages" %}</a></li>

                        {% comment %}Translators: this will appear in the navigation bar. Please try to keep it as short as possible.{% endcomment %}
                        <li><a href="{% url 'coach_reports' %}" id="nav_coachreports" class="teacher-only {% block coachreports_active %}{% endblock coachreports_active %}" title="{% trans 'Track the progress of your students' %}">{% trans "Coach" %}</a></li>

                        {% comment %}Translators: this will appear in the navigation bar. Please try to keep it as short as possible.{% endcomment %}
                        <li><a href="{% url 'help' %}" id="nav_help" class="{% block help_active %}{% endblock help_active %}">{% trans "Help" %}</a></li>

                        {% if not restricted %}
                            {% comment %}Translators: this will appear in the navigation bar. Please try to keep it as short as possible.{% endcomment %}
                            <li><a href="{% url 'add_facility_student' %}" id="nav_signup" class="not-logged-in-only {% block signup_active %}{% endblock signup_active %}" title="{% trans 'Register to start tracking your progress' %}">{% trans "Sign Up" %}</a></li>
                        {% endif %}

                        {% comment %}Translators: this will appear in the navigation bar. Please try to keep it as short as possible.{% endcomment %}
                        <li><a href="{% url 'login' %}" id="nav_login" class="not-logged-in-only {% block login_active %}{% endblock login_active %}" title="{% trans 'Login' %}">{% trans "Login" %}</a></li>

                        {% comment %}Translators: this will appear in the navigation bar. Please try to keep it as short as possible.{% endcomment %}
                        <li><a href="{% url 'account_management' %}" id="logged-in-name" class="student-only {% block account_management_active %}{% endblock account_management_active %}">{% trans "My Progress" %}</a></li>

                        {% comment %}Translators: this will appear in the navigation bar. Please try to keep it as short as possible.{% endcomment %}
                        <li><a href="{% url 'logout' %}" id="nav_logout" class="logged-in-only" title="{% trans 'Logout'%}">{% trans "Logout" %}</a></li>

                        {% block lang_choices %}
                        <li><span class="not-logged-in-only">
                        {% if num_language_choices > 1 %}
                        <select id="language_selector">
                        {% for lang_code, lang_meta in language_choices.iteritems %}
                            <option value="{{ lang_code }}" {% if lang_code == current_language %}selected{% endif %}>
                                {{ lang_code|get_language_name }}
                            </option>
                        {% endfor %}
                        </select>
                        {% endif %}
                        </span></li>
                        {% endblock lang_choices %}

                        {% endblock sitewide_navigation %}
                        </span>

                        <div class="hidden-xs" id="sitepoints"></div>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container" id="wrapper">
            {% block outer_content %}
                    {% block precontent %}
                    <div id="message_container"><!--Ajax messages from central server get inserted here--></div>
                    {% if messages %}
                        <!--Normal messages loaded from the view get inserted here-->
                        <div id="messages">
                        </div>
                    {% endif %}
                    {% endblock precontent %}
                    {% block content %}{% endblock content %}
            {% endblock outer_content %}
            <div class="footer-clearfix"></div>
        </div>

        <footer class="navbar-default">
            <div class="container">
                <a class="navbar-brand tiny">
                    <img id="fle-logo" src="{% static 'images/distributed/FLE.png' %}" alt="{% trans 'Foundation for Learning Equality logo' %}"/>
                    <p>{% trans "Creators of KA Lite" %} &copy; 2014</p>
                    <p class="visible-xs">{% trans "Videos and Exercises" %} &copy; 2014 Khan Academy</p>
                    <p class="visible-xs"><img id="creative-commons-icon" src="{% static 'images/distributed/creative-commons.png' %}"></p>
                </a>
                <ul class="nav navbar-nav navbar-right tiny">
                    <li class="pull-right hidden-xs"><img id="creative-commons-icon" src="{% static 'images/distributed/creative-commons.png' %}"></li>
                    <li class="pull-right hidden-xs">{% trans "Videos and Exercises" %} &copy; 2014 Khan Academy</li>
                </ul>
            </div>
        </footer>

    </body>
</html>
